function setCookie(e, t, a) {
    var o = new Date;
    o.setTime(o.getTime() + a), document.cookie = e + "=" + t + ";expires=" + o.toGMTString()
}

function getCookie(e) {
    var t, a = new RegExp("(^| )" + e + "=([^;]*)(;|$)");
    return (t = document.cookie.match(a)) ? unescape(t[2]) : null
}

function slideExposureFn(e, t, a) {
    var o = 0;
    e && e.length && "none" != e.css("display") && $(window).on("scroll", function () {
        "top" == t ? $(window).scrollTop() + $(window).height() > e.offset().top && 0 == o && (a(), o++) : "all" == t && $(window).scrollTop() + $(window).height() > e.offset().top + e.height() && 0 == o && (a(), o++)
    })
}

function switchDetailTab() {
    for (var e = document.querySelectorAll(".tab-lst-a"), t = 0; t < e.length; t++) !function (a) {
        e[t].removeEventListener("click", headerslider.clickBtmDetailTab, !1), e[t].addEventListener("click", clickRightDetailTab, !1)
    }()
}

function clickRightDetailTab(e) {
    headerslider.HeightTimer(e), window.scrollTo(0, 0)
}

function loadInfo(e, t) {
    e == t && productInfoLoad({
        containerID: "goodDetail",
        wareId: $("#currentWareId").val(),
        url: "/ware/detail.json?wareId=" + $("#currentWareId").val(),
        cbfn: function () {
            var e = document.getElementById("scale-parent2");
            scale("scale-parent", "scale-cont"), e && scale("scale-parent2", "scale-cont2")
        },
        switchTabCbFn: function () {
            switchDetailTab()
        },
        goProdBtnCbFn: function () {
            goProdBtnFn()
        }
    })
}

function loadAssess(e, t, a) {
    var o = window.sessionStorage,
        i = 0;
    if (o) {
        try {
            i = parseInt(o.getItem("tabIndex")), i || (i = 0)
        } catch (e) {
            i = 0
        }
        a = i
    }
    e == t && (assessListInit({
        containerID: "tab-wrapper",
        wareId: $("#currentWareId").val(),
        url: "/newComments/newCommentsDetail.json",
        tabIndex: a,
        maxCount: 10,
        cbList: useful
    }), itemPingjiaFlag = !0)
}

function useful() {
    for (var e = document.querySelectorAll(".assess-like-btn"), t = document.querySelectorAll(".btn-like-icon"), a = document.querySelectorAll(".like"), o = document.querySelector(".useful-window"), i = 0, r = 0; r < e.length; r++) !function (r) {
        e[r].onclick = function () {
            if (t[r].classList.add("like-red"), ++i > 1) {
                o.style.display = "block", clearTimeout(e);
                var e = setTimeout(function () {
                    o.style.display = "none"
                }, 2e3)
            } else o.style.display = "none";
            a[r].classList.add("like_ani")
        }
    }(r)
}

function dowloadAPP(e, t, a, o) {
    try {
        var i = "Item",
            r = "view-ware",
            n = $("#resourceType").val(),
            s = $("#resourceValue").val();
        "" != n && null != n && (i = n), "" != s && null != s && (r = s);
        var l = $("#computControul").val();
        "" != l && "true" == l && "M_APP_SAOMA" != n && (r = "MWEIXIN_PRODUCTFLOAT_VALUE", i = "MWEIXIN_PRODUCTFLOAT_TYPE");
        var c = "";
        try {
            if ($("#dist") && "jd" == $("#dist").val()) {
                c = $("#dist").val()
            }
        } catch (e) {
        }
        var d = "openApp.jdMobile://virtual",
            u = {
                category: "jump",
                des: "productDetail",
                skuId: e,
                sourceType: i,
                sourceValue: r,
                M_sourceFrom: guideTrafficConfig.bruiedPoits.topBottonOpenBruiedPoit.sourceFrom,
                dist: c
            },
            p = "http://h5.m.jd.com/active/download/download.html?channel=" + guideTrafficConfig.bruiedPoits.topBottonOpenBruiedPoit.channel,
            m = "http://h5.m.jd.com/active/download/download.html?channel=" + guideTrafficConfig.bruiedPoits.topBottonOpenBruiedPoit.channel,
            v = !1;
        "" != e && null != e && e >= 1e7 && e <= 19999999 && (d = 'openapp.jdebook://communication?params={"type":"1"}', u = "", m = "http://e.m.jd.com/jdread.html", p = "http://e.m.jd.com/jdread.html", "下载京东阅读客户端<br>精彩好书免费看", v = !0);
        var g = "_" + Math.floor(10 * Math.random()) + Math.floor(10 * Math.random());
        $("#content_trynow").attr("id", "content" + g + "_trynow"), $("#content_x").attr("id", "content" + g + "_x"), $("#content_div").attr("id", "content" + g + "_div"), window.sessionStorage && window.sessionStorage.removeItem("isPanelClose");
        var h = function () {
                try {
                    var e = window.sessionStorage;
                    e && (e.removeItem("isPanelClose"), e.setItem("isPanelClose", "true")), setTimeout(function () {
                        headerslider.setHoldTopHeight()
                    }, 200)
                } catch (e) {
                    console.log("closeCallbackFunc top" + e)
                }
            },
            f = {
                openAppBtnId: "content" + g + "_trynow",
                closePanelBtnId: "content" + g + "_x",
                closePanelId: "content" + g + "_div",
                downAppURl: p,
                downWeixin: m,
                inteneUrl: d,
                inteneUrlParams: u,
                noRecord: !1,
                openAppEventId: guideTrafficConfig.bruiedPoits.topBottonOpenBruiedPoit.eventId,
                closePanelEventId: guideTrafficConfig.bruiedPoits.topBottonCloseBruiedPoit.eventId,
                closeCallblack: h,
                M_sourceFrom: guideTrafficConfig.bruiedPoits.topBottonOpenBruiedPoit.sourceFrom,
                noJdApp: v
            };
        "function" == typeof jQuery.downloadAppPlugIn && jQuery.downloadAppPlugIn(f)
    } catch (e) {
    }
}

function dowloadAPPOfFloor(e, t, a, o) {
    try {
        var i = "Item",
            r = "view-ware",
            n = $("#resourceType").val(),
            s = $("#resourceValue").val();
        "" != n && null != n && (i = n), "" != s && null != s && (r = s);
        var l = $("#computControul").val();
        "" != l && "true" == l && "M_APP_SAOMA" != n && (r = "MWEIXIN_PRODUCTFLOAT_VALUE", i = "MWEIXIN_PRODUCTFLOAT_TYPE");
        var c = "";
        try {
            if ($("#dist") && "jd" == $("#dist").val()) {
                c = $("#dist").val()
            }
        } catch (e) {
        }
        var d = {category: "jump", des: "productDetail", skuId: e, sourceType: i, sourceValue: r, dist: c},
            u = "http://h5.m.jd.com/active/download/download.html?channel=" + guideTrafficConfig.bruiedPoits.bannerBottonBruiedPoit.channel,
            p = "http://h5.m.jd.com/active/download/download.html?channel=" + guideTrafficConfig.bruiedPoits.bannerBottonBruiedPoit.channel,
            m = {
                openAppBtnId: "download-floor",
                downAppURl: u,
                downWeixin: p,
                inteneUrl: "openApp.jdMobile://virtual",
                inteneUrlParams: d,
                noRecord: !0,
                openAppEventId: guideTrafficConfig.bruiedPoits.bannerBottonBruiedPoit.eventId,
                openAppEventParam: guideTrafficConfig.bruiedPoits.bannerBottonBruiedPoit.eventParam,
                M_sourceFrom: guideTrafficConfig.bruiedPoits.bannerBottonBruiedPoit.sourceFrom,
                noJdApp: !1
            };
        "function" == typeof jQuery.downloadAppPlugIn && jQuery.downloadAppPlugIn(m)
    } catch (e) {
    }
}

function dowloadAPPFlagA(e, t, a, o) {
    try {
        var i = "Item",
            r = "view-ware",
            n = $("#resourceType").val(),
            s = $("#resourceValue").val();
        "" != n && null != n && (i = n), "" != s && null != s && (r = s);
        var l = $("#computControul").val();
        "" != l && "true" == l && "M_APP_SAOMA" != n && (r = "MWEIXIN_PRODUCTFLOAT_VALUE", i = "MWEIXIN_PRODUCTFLOAT_TYPE");
        var c = "";
        try {
            if ($("#dist") && "jd" == $("#dist").val()) {
                c = $("#dist").val()
            }
        } catch (e) {
        }
        var d = {category: "jump", des: "productDetail", skuId: e, sourceType: i, sourceValue: r, dist: c},
            u = "http://h5.m.jd.com/active/download/download.html?channel=" + guideTrafficConfig.bruiedPoits.mainCommentsBottonBruiedPoit.channel,
            p = "http://h5.m.jd.com/active/download/download.html?channel=" + guideTrafficConfig.bruiedPoits.mainCommentsBottonBruiedPoit.channel,
            m = {
                openAppBtnId: "downloadFlagA",
                downAppURl: u,
                downWeixin: p,
                inteneUrl: "openApp.jdMobile://virtual",
                inteneUrlParams: d,
                noRecord: !0,
                openAppEventId: guideTrafficConfig.bruiedPoits.mainCommentsBottonBruiedPoit.eventId,
                openAppEventParam: guideTrafficConfig.bruiedPoits.mainCommentsBottonBruiedPoit.eventParam,
                M_sourceFrom: guideTrafficConfig.bruiedPoits.mainCommentsBottonBruiedPoit.sourceFrom,
                noJdApp: !1
            };
        "function" == typeof jQuery.downloadAppPlugIn && jQuery.downloadAppPlugIn(m)
    } catch (e) {
    }
}

function dowloadAPPFlagAP(e, t, a, o) {
    try {
        var i = "Item",
            r = "view-ware",
            n = $("#resourceType").val(),
            s = $("#resourceValue").val();
        "" != n && null != n && (i = n), "" != s && null != s && (r = s);
        var l = $("#computControul").val();
        "" != l && "true" == l && "M_APP_SAOMA" != n && (r = "MWEIXIN_PRODUCTFLOAT_VALUE", i = "MWEIXIN_PRODUCTFLOAT_TYPE");
        var c = "";
        try {
            if ($("#dist") && "jd" == $("#dist").val()) {
                c = $("#dist").val()
            }
        } catch (e) {
        }
        var d = {category: "jump", des: "productDetail", skuId: e, sourceType: i, sourceValue: r, dist: c},
            u = "http://h5.m.jd.com/active/download/download.html?channel=" + guideTrafficConfig.bruiedPoits.tableCommentsBottonBruiedPoit.channel,
            p = "http://h5.m.jd.com/active/download/download.html?channel=" + guideTrafficConfig.bruiedPoits.tableCommentsBottonBruiedPoit.channel,
            m = {
                openAppBtnId: "downloadFlagAP",
                downAppURl: u,
                downWeixin: p,
                inteneUrl: "openApp.jdMobile://virtual",
                inteneUrlParams: d,
                noRecord: !0,
                openAppEventId: guideTrafficConfig.bruiedPoits.tableCommentsBottonBruiedPoit.eventId,
                openAppEventParam: guideTrafficConfig.bruiedPoits.tableCommentsBottonBruiedPoit.eventParam,
                M_sourceFrom: guideTrafficConfig.bruiedPoits.tableCommentsBottonBruiedPoit.sourceFrom,
                noJdApp: !1
            };
        "function" == typeof jQuery.downloadAppPlugIn && jQuery.downloadAppPlugIn(m)
    } catch (e) {
    }
}

function goProdBtnFn() {
    var e = document.querySelectorAll(".pro-button-box");
    if (e.length > 0)
        for (var t = 0; t < e.length; t++) e[t].removeEventListener("click", headerslider.btmDetailBackToTop, !1), e[t].addEventListener("click", goViewDetail, !1)
}

function goViewDetail() {
    if ($("#detailView").length > 0) $("#detailView").click();
    else {
        var e = window.location.href;
        e && (e = e.split("#")[0]), window.location.href = e
    }
}

function addCookie(e, t, a, o, i) {
    var r = e + "=" + escape(t);
    if ("" != a) {
        var n = new Date;
        n.setTime(n.getTime() + 24 * a * 3600 * 1e3), r += ";expires=" + n.toGMTString()
    }
    "" != o && (r += ";path=" + o), "" != i && (r += ";domain=" + i), document.cookie = r
}

function creatShareGift() {
    var e = $("#js-share-gift"),
        t = document.createElement("i"),
        a = document.createElement("iframe");
    $(e).addClass("share-gift-wrap").append(t).append(a).css("overflow", "auto"), $(t).addClass("share-gift-btn"), $(a).addClass("share-gift-content").attr("scrolling", "no").attr("src", $("#itemShareShowUrl").val()).css("width", document.body.clientWidth + "px"), a.onload = function () {
        var t = $("#mainLayout");
        $(e).addClass("share-gift-show"), t.addClass("overflowHidden").css("height", window.screen.height * (2 / 3) + "px"), bindEvent(e, t)
    }
}

function bindEvent(e, t) {
    $(document).on("touchstart", ".share-gift-btn", function () {
        pingClickWithLevel("MProductdetail_AppShareClose", "", "", $("#currentWareId").val(), ""), e.removeClass("share-gift-show"), setTimeout(function () {
            t.removeClass("overflowHidden").css("height", "100%"), e.remove()
        }, 500)
    }), window.addEventListener("message", function (e) {
        switch (e.data) {
            case "tologin":
                window.location.href = $("#itemLoginUrl").val();
                break;
            case "toBean":
                window.location.href = "//home.m.jd.com/wallet/wallet.action";
                break;
            case "toCoupon":
                window.location.href = "//home.m.jd.com/wallet/coupons.action";
                break;
            case "toIndex":
                window.location.href = "//m.jd.com"
        }
    }, !1)
}

function jumpPost(e, t) {
    var a, o = ($(document.body), $("<form method='post'></form>"));
    o.attr({action: e}), t && $.each(t, function (e, t) {
        a = $("<input type='hidden'>"), a.attr({name: e}), a.val(t), o.append(a)
    }), o.appendTo(document.body), o.submit(), document.body.removeChild(o[0])
}

function getCoupon(e, t, a, o, i) {
    if ("" == a || null == a || void 0 == a || "" == e || null == e || void 0 == e) {
        var r = {cls: "error-icon", duration: 1e3, message: "系统繁忙，请稍后再试", height: 88, width: 180};
        return void showMessage(r)
    }
    var n = $("#couponDivShow").attr("pop-data"),
        s = $("#couponDivShow").attr("pop-conf");
    if (n && "true" == n && s && "true" != s) getPopActiveCoupon(e, t, a, o);
    else {
        var l = "https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html?couponId=" + t;
        jQuery.ajax({
            type: "POST",
            url: "/coupon/couponDetail.json",
            data: {wareId: $("#currentWareId").val(), isPop: $("#couponDivShow").attr("pop-data")},
            dataType: "json",
            success: function (r) {
                if (r && r.codeKey) $("#codeKey").val(r.codeKey), poptip({
                    codeKeyShow: r.codeKeyShow,
                    couponId: t,
                    roleId: a,
                    discount: o,
                    codeKey: r.codeKey,
                    encryptedKey: e,
                    limitPlatform: !0,
                    limitMsg: i
                });
                else {
                    var n = {cls: "error-icon", duration: 1e3, message: "系统繁忙，请稍后再试", height: 88, width: 180};
                    showMessage(n)
                }
            },
            error: function (e, t, a, o) {
                window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=" + l
            }
        })
    }
}

function goCouponSearch(e) {
    window.location.href = "https://so.m.jd.com/list/couponSearch.action?couponbatch=" + e
}

function getPopActiveCoupon(e, t, a, o) {
    jQuery.ajax({
        type: "POST",
        url: "/coupon/getActiveCoupon.json",
        data: {
            sku: $("#currentWareId").val(),
            discount: o,
            encryptedKey: e,
            roleId: a,
            isPop: $("#couponDivShow").attr("pop-data")
        },
        dataType: "json",
        success: function (e) {
            if (e && e.couponResult) {
                $("#" + t).attr("onclick", "");
                $("#" + t).append('<i class="x-already"></i>');
                var a = {cls: "succee-icon", duration: 3e3, message: "领取成功（5~10分钟到账）", height: 88, width: 220};
                showMessage(a)
            } else if (e && e.code && 34 == e.code) try {
                var o = document.querySelector(".certification-floor");
                o.style.display = "block", $(".one-btn-tip-box-tip").css({marginTop: -$(".one-btn-tip-box-tip").height() / 2}), $(".one-btn-tip-info").html("<span>" + e.msg + "</span>")
            } catch (t) {
                var i = "系统繁忙，请稍后再试";
                e && e.msg && (i = e.msg);
                var a = {cls: "error-icon", duration: 3e3, message: i, height: 120, width: 260};
                showMessage(a)
            } else {
                var i = "貌似有点小问题，您可以30秒后再试一下哟";
                e && e.msg && (i = e.msg);
                var a = {cls: "error-icon", duration: 3e3, message: i, width: 260};
                showMessage(a)
            }
        },
        error: function (e, t, a, o) {
            var i = "https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html";
            window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=" + i
        }
    })
}

function couponDetailShow() {
    var wareId = $("#currentWareId").val();
    try {
        jQuery.ajax({
            type: "POST",
            url: "/coupon/coupon.json",
            data: {wareId: wareId},
            dataType: "json",
            success: function (data) {
                if (data && data.coupon) {
                    var couponList = eval(data.coupon),
                        couponArray = [],
                        couponApplicability = couponList.filter(function (e) {
                            if (e.applicability) return e
                        }),
                        couponNotApplicability = couponList.filter(function (e) {
                            if (!e.applicability) return e
                        });
                    couponArray = couponApplicability.concat(couponNotApplicability);
                    var listHtml = "";
                    if ($(couponArray).each(function (e) {
                            var t = "",
                                a = "",
                                o = "";
                            couponList[e] && 0 == couponList[e].couponType ? t += getCouponHtml(couponList[e], wareId, couponList[e].roleId, couponList[e].applicability) : couponList[e] && 1 == couponList[e].couponType ? a += getCouponHtml(couponList[e], wareId, couponList[e].roleId, couponList[e].applicability) : o += getCouponHtml(couponList[e], wareId, couponList[e].roleId, couponList[e].applicability), listHtml += t + a + o
                        }), listHtml) {
                        $("#couponlist").empty().append(listHtml), $(".coupon-total-nums").html("共" + couponList.length + "张"), $("#couponDivShow").show(), $("#couponActivity").show(), $(".coupon-slider").length > 0 && slideshow(".coupon-slider").init({
                            lineNum: 1,
                            marginValue: 11,
                            multiMove: !0,
                            mpingEvent: "MProductdetail_CouponSlide"
                        });
                        var couponDetailShow = $("#couponDetailShow").val();
                        couponDetailShow && $("#" + couponDetailShow).length > 0 && !$("#" + couponDetailShow).hasClass("grep") && $("#" + couponDetailShow).click(), $("#whiteBarInfo").attr("class", "prod-whitebar whitebar-flick bdr-b")
                    }
                }
            },
            error: function (e, t, a) {
            }
        })
    } catch (e) {
    }
}

function getCouponHtml(e, t, a, o) {
    var i, r, n, s, l = "";
    try {
        if (null == e || null == e.discount || void 0 == e.discount || 0 == e.discount) return "";
        if (i = 0 == e.couponType ? "red J_ping" : 1 == e.couponType ? "blue J_ping" : "green J_ping", o) n = "领", s = "取", r = 'report-eventid="MProductdetail_Coupon" report-eventlevel="5" report-pageparam="' + t + '" onclick="getCoupon(\'' + e.encryptedKey + "','" + t + "_" + a + "','" + e.roleId + "','" + e.discount + "','" + e.name + "')\">";
        else {
            if (VirtualAvailableCouponFlag) {
                var c = new MPing.inputs.Click("MProductdetail_VirtualAvailableCoupon");
                c.page_param = $("#currentWareId").val();
                (new MPing).send(c), VirtualAvailableCouponFlag = !1
            }
            n = "可", s = "用", r = 1 === e.couponKind ? 'report-eventid="MProductdetail_AvailableCoupon" report-eventparam="' + e.discount + '" report-eventlevel="4" report-pageparam="' + t + '" onclick="goCouponSearch(' + e.batchId + ')">' : 'report-eventid="MProductdetail_AvailableCoupon" report-eventparam="' + e.discount + '" report-eventlevel="4" report-pageparam="' + t + '">'
        }
        l += '<li  class="jd-slider-item coupon_unit ' + i + ' J_ping"  id="' + t + "_" + a + '" ' + r + '><div class="expe_disc">    <div class="expeNum">        <span class="rmb">&yen</span>        <span class="actual-number">' + e.discount + '</span>    </div>    <div class="condi_msg">满' + e.quota + '可用</div></div><div class="coupon_icon"></div><div class="oper_msg"><div class="up" id="' + t + "_" + a + '_up">' + n + '</div><div class="down" id="' + t + "_" + a + '_down">' + s + '</div></div> <em class="left_m"></em></li>'
    } catch (e) {
    }
    return l
}

function initDetail(e) {
    var t = {
            seckillContainer: "seckill_time", isStart: !1, timer: null, seckillCallback: function () {
            }, argObj: null
        },
        a = $.extend(t, e) || $.fn.extend(t, e),
        o = {
            seckillContainer: a.seckillContainer,
            isStart: a.isStart,
            timer: a.timer,
            callback: a.seckillCallback,
            drawSeckill: function () {
                var e = document.getElementById(this.seckillContainer);
                if (null != e) {
                    var t = '<span class="seckill-time-num">00</span>';
                    t += '<span class="seckill-time-colon">:</span>', t += '<span class="seckill-time-num">00</span>', t += '<span class="seckill-time-colon">:</span>', t += '<span class="seckill-time-num">00</span>', e.innerHTML = t
                }
            },
            seckillInit: function (e) {
                var t = this;
                t.drawSeckill(), e.seckill && (e.seckill.seckillTime && e.seckill.timeRemain ? (t.endTime = e.seckill.seckillTime, t.timeRemain = e.seckill.timeRemain, t.seckillTime = 1e3, t.seckillTimer()) : $("#seckill_time").hide())
            },
            seckillTimer: function () {
                var e = this,
                    t = jdM.localstorage.get("index_seckill"),
                    a = 0;
                if (t) {
                    t = t.split("_");
                    var o = t[0],
                        i = parseInt(t[1], 10),
                        r = jdM.date.toDate(t[2]),
                        n = parseInt(t[3], 10);
                    if (e.endTime == o && e.timeRemain == i) {
                        var s = new Date;
                        a = n - parseInt((s.getTime() - r.getTime()) / 1e3, 10), jdM.localstorage.set("index_seckill", e.endTime + "_" + e.timeRemain + "_" + jdM.date.toString(s, "yyyy-MM-dd HH:mm:ss") + "_" + a)
                    } else {
                        var s = new Date;
                        a = e.timeRemain, jdM.localstorage.set("index_seckill", e.endTime + "_" + e.timeRemain + "_" + jdM.date.toString(s, "yyyy-MM-dd HH:mm:ss") + "_" + a)
                    }
                } else {
                    var s = new Date;
                    a = e.timeRemain = e.timeRemain - 1, jdM.localstorage.set("index_seckill", e.endTime + "_" + e.timeRemain + "_" + jdM.date.toString(s, "yyyy-MM-dd HH:mm:ss") + "_" + a)
                }
                if (a > 0) {
                    var l = a % 60,
                        c = parseInt(a / 60, 10),
                        d = c % 60,
                        u = parseInt(c / 60, 10);
                    if (u <= 0) $("#" + e.seckillContainer).find("span").eq(0).text("00");
                    else if (u > 99) $("#" + e.seckillContainer).find("span").eq(0).text("99");
                    else if (u > 9 && u < 99) {
                        var u = u + "";
                        $("#" + e.seckillContainer).find("span").eq(0).text(u)
                    } else {
                        var u = u + "";
                        $("#" + e.seckillContainer).find("span").eq(0).text("0" + u)
                    }
                    d <= 0 ? $("#" + e.seckillContainer).find("span").eq(2).text("00") : d > 9 ? (d += "", $("#" + e.seckillContainer).find("span").eq(2).text(d)) : $("#" + e.seckillContainer).find("span").eq(2).text("0" + d), l <= 0 ? $("#" + e.seckillContainer).find("span").eq(4).text("00") : l > 9 ? (l += "", $("#" + e.seckillContainer).find("span").eq(4).text(l)) : $("#" + e.seckillContainer).find("span").eq(4).text("0" + l)
                } else $("#" + e.seckillContainer).find("span").eq(0).text("00"), $("#" + e.seckillContainer).find("span").eq(2).text("00"), $("#" + e.seckillContainer).find("span").eq(4).text("00"), e.seckillStop(), e.callback()
            },
            seckillRun: function (e) {
                var t = this;
                t.seckillTime = t.seckillTime - e, 0 == t.seckillTime && (t.seckillTime = 1e3, t.seckillTimer())
            },
            seckillStart: function () {
                var e = this;
                e.isStart || (e.timer = setInterval(function () {
                    e.seckillRun(1e3), e.isStart = !0
                }, 1e3))
            },
            seckillStop: function () {
                var e = this;
                e.isStart && (clearInterval(e.timer), jdM.localstorage.remove("index_seckill"))
            }
        };
    return function () {
        null != a.argObj && (o.seckillInit(a.argObj), o.seckillStart())
    }()
}

function init618PriceCountDown(e) {
    var t = {
            seckillContainer: "js-618price-wait-countdown", isStart: !1, timer: null, seckillCallback: function () {
            }, argObj: null
        },
        a = $.extend(t, e) || $.fn.extend(t, e),
        o = {
            seckillContainer: a.seckillContainer,
            isStart: a.isStart,
            timer: a.timer,
            callback: a.seckillCallback,
            drawSeckill: function () {
                var e = document.getElementById(this.seckillContainer);
                if (null != e) {
                    e.innerHTML = '<span class="x-618price-black">0天</span>&nbsp;<span class="x-618price-timeborder x-618price-black" id="js-618price-hour">00</span>&nbsp;:&nbsp<span class="x-618price-timeborder x-618price-black" id="js-618price-minute">00</span>&nbsp;:&nbsp<span class="x-618price-timeborder x-618price-black" id="js-618price-second">00</span>'
                }
            },
            seckillInit: function (e) {
                var t = this;
                t.drawSeckill(), e.seckill && (e.seckill.seckillTime && e.seckill.timeRemain ? (t.endTime = e.seckill.seckillTime, t.timeRemain = e.seckill.timeRemain, t.seckillTime = 1e3, t.seckillTimer()) : $("#seckill_time").hide())
            },
            seckillTimer: function () {
                var e = this,
                    t = 0;
                new Date;
                if ((t = e.timeRemain = e.timeRemain - 1) > 0) {
                    var a = t % 60,
                        o = parseInt(t / 60, 10),
                        i = o % 60,
                        r = parseInt(o / 60, 10),
                        n = r % 24,
                        s = parseInt(r / 24, 10);
                    if (s <= 0 ? $("#" + e.seckillContainer).find("span").eq(0).hide() : $("#" + e.seckillContainer).find("span").eq(0).text(s + "天").show(), n <= 0) $("#" + e.seckillContainer).find("span").eq(1).text("00");
                    else if (n > 9) {
                        var n = n + "";
                        $("#" + e.seckillContainer).find("span").eq(1).text(n)
                    } else {
                        var n = n + "";
                        $("#" + e.seckillContainer).find("span").eq(1).text("0" + n)
                    }
                    i <= 0 ? $("#" + e.seckillContainer).find("span").eq(2).text("00") : i > 9 ? (i += "", $("#" + e.seckillContainer).find("span").eq(2).text(i)) : $("#" + e.seckillContainer).find("span").eq(2).text("0" + i), a <= 0 ? $("#" + e.seckillContainer).find("span").eq(3).text("00") : a > 9 ? (a += "", $("#" + e.seckillContainer).find("span").eq(3).text(a)) : $("#" + e.seckillContainer).find("span").eq(3).text("0" + a)
                } else $("#" + e.seckillContainer).find("span").eq(0).text("0天"), $("#" + e.seckillContainer).find("span").eq(1).text("00"), $("#" + e.seckillContainer).find("span").eq(2).text("00"), $("#" + e.seckillContainer).find("span").eq(3).text("00"), e.isStart = !0, e.seckillStop(), e.callback()
            },
            seckillRun: function (e) {
                var t = this;
                t.seckillTime = t.seckillTime - e, 0 == t.seckillTime && (t.seckillTime = 1e3, t.seckillTimer())
            },
            seckillStart: function () {
                var e = this;
                e.isStart || (e.timer = setInterval(function () {
                    e.seckillRun(1e3), e.isStart = !0
                }, 1e3))
            },
            seckillStop: function () {
                var e = this;
                e.isStart && clearInterval(e.timer)
            }
        };
    return function () {
        null != a.argObj && (o.seckillInit(a.argObj), o.seckillStart())
    }()
}

function getBigPriceEndSecKill() {
    return Math.floor((parseInt($("#bigSaleEndTime").val()) - (new Date).getTime()) / 1e3)
}

function hideBigPrice() {
    $("#js-bigsale-wait").remove(), $("#js-bigsale-begin").remove(), $("#js-normalPrice").show();
    var e = $("#js-bottom-618-prompt-text");
    e.length && e.parent().remove(), $("#js-bigsale-banner").remove(), $(".x-bottom-glass-wrap").remove()
}

function promotionSwitch(e) {
    var t = $("#prodPromotion"),
        a = e || event,
        o = (a.srcElement || a.target, this);
    -1 != o.className.indexOf("down") ? (a.preventDefault(), a.stopPropagation(), t[0].removeEventListener("click", promotionSwitch, !0), t[0].addEventListener("click", promotionSwitch, !1), $("#suitContainer").css("display", "block"), o.className = o.className.replace("down", "up"), t.attr("report-eventparam", "open"), $("#suitContainer").length > 0 && slideshow("#suitContainer").init({
        lineNum: 1,
        marginValue: 40,
        fullScreen: !0,
        mpingEvent: "MProductdetail_SlideDiscount"
    })) : (t[0].removeEventListener("click", promotionSwitch, !1), t[0].addEventListener("click", promotionSwitch, !0), $("#suitContainer").css("display", "none"), o.className = o.className.replace("up", "down"), t.attr("report-eventparam", "close"))
}

function commentListInit(e) {
    var t = {containerID: "commentListID", maxCount: 5, fontSize: 14, spaceWidth: 60, url: "", filters: {}};
    String.prototype.getWidth = function (e) {
        var t = document.getElementById("_getwidthID");
        null == t ? (t = document.createElement("span"), t.id = "_getwidthID", document.getElementById("mainLayout").appendChild(t), t.style.visibility = "hidden", t.style.whiteSpace = "nowrap") : t.style.display = "inline-block", t.innerText = this, t.style.fontSize = e + "px";
        var a = t.offsetWidth;
        return t.style.display = "none", a
    };
    var a = $.extend(t, e),
        o = document.getElementById(a.containerID),
        i = "onorientationchange" in window,
        r = i ? "orientationchange" : "resize",
        n = window.navigator.userAgent,
        s = {
            measureWidth: function () {
                return document.documentElement.clientWidth
            },
            getAdjustW: function () {
                var e = document.documentElement.clientWidth,
                    t = e - 20 - 39,
                    a = t / 4;
                return a > 120 && (a = 120), a
            },
            liAdjustWidth: function () {
                var e = s.getAdjustW();
                $(".comment-img-item").width(e).height(e)
            },
            imgAdjustWidth: function () {
                var e = s.getAdjustW();
                $(".comment-img-item").find("img").each(function (t) {
                    var a, o, i, r = $(this),
                        n = new Image;
                    n.src = $(r).attr("src"), n.onload = function () {
                        a = this.width, o = this.height, i = a / o, o > a ? (r.width(e), r.css("marginTop", (e - e / i) / 2 + "px")) : (r.height(e), r.css("marginLeft", (e - e * i) / 2 + "px"))
                    }, n.onerror = function () {
                        r.attr("src", "../../../images/5.4/occupy-img320.gif?v="), r.width(e).height(e)
                    }
                })
            },
            imgLoadCb: function (e, t) {
                var a = s.getAdjustW(),
                    o = e.width,
                    i = e.height,
                    r = o / i;
                "comment-img-item" == t.parent().attr("class") && (i > o ? (t.width(a), t.css("marginTop", (a - a / r) / 2 + "px")) : (t.height(a), t.css("marginLeft", (a - a * r) / 2 + "px")))
            },
            adjustWidth: function () {
                var e = s.measureWidth(),
                    t = e - 20 - 260 - 39,
                    a = 65 + t / 4,
                    o = document.getElementById("picLasyLoad").value;
                a > 120 && (a = 120), $(".comment-img-item").width(a).height(a), $(".comment-img-item").find("img").each(function (e) {
                    var t, i, r = $(this),
                        n = new Image;
                    r.width(a).height(a), n.src = "true" == o ? $(r).attr("_src") : $(r).attr("src"), n.onload = function () {
                        t = this.width, i = this.height, picProportion = t / i, i > t ? (r.width(a), r.height(""), r.css("marginTop", (a - a / picProportion) / 2 + "px")) : (r.width(""), r.height(a), r.css("marginLeft", (a - a * picProportion) / 2 + "px"))
                    }
                })
            },
            hasIcon: function (e) {
                return 2 * (this.measureWidth() - a.spaceWidth) <= e.getWidth(a.fontSize)
            },
            downClass: function (e) {
                e.onclick = function () {
                    this.className = this.className.replace("down", "up"), this.onclick = null, s.upClass(this)
                }
            },
            upClass: function (e) {
                e.onclick = function () {
                    this.className = this.className.replace("up", "down"), this.onclick = null, s.downClass(this)
                }
            },
            toggleClass: function () {
                for (var e = $(".down-icon"), t = 0; t < e.length; t++) e[t].onclick = function (e) {
                    this.onclick = null, s.upClass(this)
                }
            },
            addHtml: function (e) {
                for (var t = "", a = 0; a < e.length; a++) {
                    if (t += '<div class="comment-list-item"><div class="comment-item-info"><span class="comment-item-author">', t += e[a].userNickName, "true" == $("#isJx").val() ? t += '</span><span class="product-item-star jx-product-item-star"><span class="real-star comment-stars-width' : t += '</span><span class="product-item-star"><span class="real-star comment-stars-width', t += e[a].commentScore, t += '"></span>', t += '</div><div class="comment-item-content down-icon', t += '"><span class="content">', t += e[a].commentData, t += "</span></div>", void 0 != e[a].pictureInfoList && e[a].pictureInfoList.length > 0) {
                        t += '<div class="comment-img-container"> <ul class="img-container J_ping"  report-eventid="MProductdetail_CommentPhoto" report-pageparam="' + $("#currentWareId").val() + '" report-eventlevel="5">';
                        for (var o = 0; o < e[a].pictureInfoList.length && 4 != o; o++) t += '<li class="comment-img-item">', $("#picLasyLoad") && "true" == $("#picLasyLoad").val() ? (t += '<img src="../../../images/5.4/occupy-img320.gif" _src="', e[a].pictureInfoList[o].picURL && $("#httpsConfig") && "true" == $("#httpsConfig").val() ? t += e[a].pictureInfoList[o].picURL.replace("http://", "//") : t += e[a].pictureInfoList[o].picURL) : (t += '<img src="', e[a].pictureInfoList[o].picURL && $("#httpsConfig") && "true" == $("#httpsConfig").val() ? t += e[a].pictureInfoList[o].picURL.replace("http://", "//") : t += e[a].pictureInfoList[o].picURL), t += '" onerror="accessImgErr(this)"></li>', o < 3 && (t += '<li class="comment-img-space"></li>');
                        t += "</div> </ul></a>"
                    }
                    t += '<div class="comment-item-date">', t += e[a].orderDate.split(" ")[0], t += "</div></div>"
                }
                return t
            },
            limitedComments: function (e) {
                "true" === guideTrafficConfig.commentsShowFlag && e > 3 ? ($("#downloadFlagA").show(), $("#js-consultation").parent().show(), "false" === $("#isPop").val() && $("#js-consultation").show()) : $(".share-quest").show()
            }
        },
        l = function (e) {
            var t = a.maxCount,
                i = e.commentInfoList.length;
            if (0 == i) return $(".text-fr")[0].innerHTML = "<span>暂无评价，等你抢沙发</span>", $("#goods").parent().text(""), $("#plus-goods").parent().text(""), void(document.getElementById("showDetail").style.display = "none");
            var r = i <= t ? i : t,
                n = s.addHtml(e.commentInfoList.slice(0, r));
            o.innerHTML = n, s.toggleClass(), s.liAdjustWidth(), "true" != document.getElementById("picLasyLoad").value && s.imgAdjustWidth(), s.limitedComments(e.allCnt)
        },
        c = function () {
            jQuery.ajax({
                url: "/ware/getDetailCommentList.json",
                data: {wareId: $("#currentWareId").val()},
                dataType: "json",
                success: function (e) {
                    try {
                        if (window.addEventListener(r, function () {
                                if (-1 != n.indexOf("MQQBrowser") || -1 != n.indexOf("baidubrowser") || -1 != n.indexOf("Chrome") && -1 != n.indexOf("Android")) {
                                    clearTimeout(e);
                                    var e = setTimeout(function () {
                                        s.liAdjustWidth(), s.imgAdjustWidth()
                                    }, 200)
                                } else s.liAdjustWidth(), s.imgAdjustWidth()
                            }, !1), "string" == typeof e) var t = JSON.parse(e);
                        else if ("object" == typeof e) var t = e;
                        var a = parseInt(t.wareDetailComment.goodCnt),
                            o = parseInt(t.wareDetailComment.allCnt);
                        o > 0 ? ($("#comments").text(o), a > 0 && ($("#goods").text(Math.round(100 * a / o) + "%"), $("#plus-goods").text(Math.round(100 * a / o) + "%")), t && t.wareDetailComment && t.wareDetailComment.pictureCnt && $("#orderComment").append("(" + t.wareDetailComment.pictureCnt + ")")) : ($("#comments").text("0"), $("#goods").text("0%"), $("#plus-goods").text("0%"), $("#orderComment").append("(0)")), t && t.wareDetailComment && t.wareDetailComment.consultationCount ? ($("#consultations").length > 0 && $("#consultations").append("(" + t.wareDetailComment.consultationCount + ")"), $("#consultOpenApp").length > 0 && $("#consultOpenApp").append("(" + t.wareDetailComment.consultationCount + ")")) : $("#consultations").append("(0)"), l(t.wareDetailComment)
                    } catch (e) {
                        $("#showDetail").attr("style", "display:none;")
                    }
                },
                error: function (e) {
                    $(".text-fr")[0].innerHTML = "<span>暂无评价，等你抢沙发</span>", $("#showDetail").attr("style", "display:none;")
                }
            }), s.toggleClass()
        };
    return function () {
        c(), "true" == document.querySelector("#picLasyLoad").value && jQuery.loadImg.lazyLoad({
            rangeH: 30,
            container: "",
            imgcb: s.imgLoadCb,
            isChangeSize: "false"
        })
    }()
}

function makeAppointment() {
    try {
        if (colorSizeSpecValidate()) {
            var e = "https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html",
                t = (new Date).getTime();
            jQuery.ajax({
                type: "POST",
                url: "/ware/isAppoint.json?t=" + t,
                data: {wareId: $("#currentWareId").val(), sid: $("#sid").val()},
                dataType: "json",
                success: function (a) {
                    if (a && 1 == a.isAppoint) {
                        var o = {cls: "error-icon", duration: 2e3, message: "您已经成功预约，无需重复预约", height: 100, width: 250};
                        showMessage(o)
                    } else jQuery.ajax({
                        type: "POST",
                        url: "/ware/yuYue.json?t=" + t,
                        data: {wareId: $("#currentWareId").val(), sid: $("#sid").val()},
                        dataType: "json",
                        success: function (e) {
                            if (e && e.codeKey) $("#codeKey").val(e.codeKey), appointmentTip({codeKey: e.codeKey});
                            else {
                                var t = {
                                    cls: "error-icon",
                                    duration: 1e3,
                                    message: "系统繁忙，请稍后再试",
                                    height: 88,
                                    width: 180
                                };
                                showMessage(t)
                            }
                        },
                        error: function (t, a, o) {
                            window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=" + e
                        }
                    })
                },
                error: function (t) {
                    window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=" + e
                }
            })
        }
    } catch (t) {
        window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=" + e
    }
}

function com_jd_passport_m_validateCode(e, t, a) {
    validateCode.getValidateCode(e, t, a)
}

function activityTrailer(e, t) {
    var a = JSON.parse(t),
        o = window.event || window.e,
        i = o.target || o.srcElement,
        r = $(i).parent();
    o.stopPropagation(), "MProductdetail_Promotion" == r.attr("report-eventid") && pingClickWithLevel(r.attr("report-eventid"), r.attr("report-eventparam"), "", r.attr("report-pageparam"), "5"), "MProductdetail_PromotionBuy" == r.attr("report-eventid") && pingClickWithLevel(r.attr("report-eventid"), "", "", r.attr("report-pageparam"), ""), jumpPost(e, a)
}

function changeSchemel() {
    var e = $("#pLowFlag").val();
    e && "" != e && "null" != e && "true" == e && (carAndOrderschemel = "http:")
}

function changeSkuShowOrHide(e) {
    var t = $("#changeSkuFlag").val();
    e ? "3" == t ? ($(".looksimilara").hide(), $(".looksimilarb").show()) : ($(".looksimilara").show(), $(".looksimilarb").hide()) : $(".looksimilar").hide()
}

function toastShow() {
    var e = $("#changeSkuFlag").val(),
        t = $("#currentWareId").val();
    if ("4" == e) {
        var a = $("#areaToast").val();
        setCookie("item_areaToast", a, 0), $("#changeSkuFlag").val(0), $("#areaToast").val("")
    }
    var a = getCookieBy("item_areaToast");
    if (a && "null" != a) {
        var o = '<div class="area-price">' + a + "</div>";
        $(".area-price-toast-wrap").append(o);
        var i = parseInt($(".area-price").width());
        $(".area-price").css("marginLeft", -i / 2 + "px"), setTimeout(function () {
            $(".area-price-toast-wrap").html("")
        }, 2e3), clearCookie("item_areaToast");
        var r = $("#isSam").val(),
            n = 0;
        r && "true" == r && (n = 1), setTimeout(function () {
            sendDataToService("MProductdetail_PartitionToast", n, t, "")
        }, 200)
    } else if ("3" == e) {
        var s = $("#areaReasonTips").val(),
            l = $("#areaSkuId").val();
        $.toast({
            message: s,
            styleType: 3,
            autoClose: !1,
            isMaskClose: !0,
            btns: {cancelTxt: "取消", okTxt: "查看同款"},
            okCallback: function () {
                sendDataToService("MProductdetail_SameToastCheck", "", t, "4"), location.href = "/product/" + l + ".html"
            },
            closeCallback: function () {
                sendDataToService("MProductdetail_SameToastCancel", "", t, "")
            }
        })
    }
}

function sendDataToService(e, t, a, o) {
    try {
        var i = new MPing.inputs.Click(e);
        t && "null" != t && "" != t && (i.event_param = t), a && "null" != a && "" != a && (i.page_param = a), o && "null" != o && "" != o && (i.event_level = o);
        (new MPing).send(i)
    } catch (e) {
    }
}

function initParam() {
    commonConfigJson && (commonConfig = eval("(" + commonConfigJson + ")")), isXnzt = commonConfig && commonConfig.isXnztEnable && commonConfig.isXnzt ? commonConfig.isXnzt : "0", isSamSku = !(!commonConfig || !commonConfig.isSamSku) && commonConfig.isSamSku, isSamCard = !(!commonConfig || !commonConfig.isSamCard) && commonConfig.isSamCard, isSamMember = !(!commonConfig || !commonConfig.isSamMember) && commonConfig.isSamMember, isSamMemberAddcart = !(!commonConfig || !commonConfig.isSamMemberAddcart) && commonConfig.isSamMemberAddcart, commonConfig && commonConfig.isSamMemberBName ? (isSamMemberBName = commonConfig.isSamMemberBName, addCartBizName = isSamMemberBName) : (isSamMemberBName = "", addCartBizName = ""), isOilCard = !(!commonConfig || !commonConfig.isOilCard) && commonConfig.isOilCard, addCartBizName = commonConfig && commonConfig.addCartBizName ? commonConfig.addCartBizName : "",
        isCustomize = !(!commonConfig || !commonConfig.isCustomize) && commonConfig.isCustomize, addCartURL = commonConfig && commonConfig.addCartUrl ? commonConfig.addCartUrl : "", isGameCharge = !(!commonConfig || !commonConfig.isGameCharge) && commonConfig.isGameCharge, isPrescribedDrug = !(!commonConfig || !commonConfig.isPrescribedDrug) && commonConfig.isPrescribedDrug, isYuyue = !(!commonConfig || !commonConfig.isYuyue) && commonConfig.isYuyue, isYushou = !(!commonConfig || !commonConfig.isYushou) && commonConfig.isYushou, hasAddCartNode = !(!commonConfig || !commonConfig.hasAddCartNode) && commonConfig.hasAddCartNode, isJdEcard = !(!commonConfig || !commonConfig.isJdEcard) && commonConfig.isJdEcard, isFqyProduct = !(!commonConfig || "staging" != commonConfig.addCartBizName), orderEvent = commonConfig && commonConfig.orderEvent ? commonConfig.orderEvent : "", buttonDisabledWhenNoStock = !(!commonConfig || !commonConfig.buttonDisabledWhenNoStock) && commonConfig.buttonDisabledWhenNoStock, notCallLvBizNames = commonConfig && commonConfig.notCallLvBizNames ? commonConfig.notCallLvBizNames : [], isMiaosha = !(!commonConfig || !commonConfig.isMiaosha), isSoldOversea = commonConfig && "true" == commonConfig.isSoldOversea ? "true" : "false", isHk = $("#isHk") && $("#isHk").val() ? $("#isHk").val() : "false", isJdOtc = $("#isJdOtc") && $("#isJdOtc").val() ? $("#isJdOtc").val() : "false", isOtc = $("#isOtc") && $("#isOtc").val() ? $("#isOtc").val() : "false", wareType = isHk && "true" == isHk ? "1" : isOtc && "true" == isOtc ? "2" : isSamSku || isSamCard ? "3" : isMiaosha ? "4" : "0", eventParam = $("#currentWareId").val() + "_" + wareType;
    var easyType = "0";
    isMiaosha && (easyType = "1"), easyByEventparam = $("#currentWareId").val() + "_" + easyType
}

function popupsOpenTrigger(e, t, a, o, i, r, n) {
    e && a && $(e).bind("click", function () {
        isSingleBuyBtn && "addCartBtm" == e.getAttribute("id") || (t && (t.style.display = "block"), a.style.display = "block", a.classList.add(o), a.classList.contains(i) && a.classList.remove(i), r && "function" == typeof r && r(), n && "function" == typeof n && n())
    })
}

function popupsClose(e, t, a, o, i, r) {
    t.classList.remove(a), t.classList.add(o), setTimeout(function () {
        e && (e.style.display = "none"), t.style.display = "none"
    }, 500), i && "function" == typeof i && i(), r && "function" == typeof r && r()
}

function popupsCloseTrigger(e, t, a, o, i, r, n) {
    e && a && e.addEventListener("click", popupsClose.bind(null, t, a, o, i, r, n), !1)
}

function specPopupsCloseExtendCb(e) {
    jdM.sessionstorage.set("ybId", oYbId.value), jdM.sessionstorage.set("ybSku", $("#currentWareId").val()), pingIndex = 0;
    try {
        jdM.sessionstorage.set("skuIdNum", $("#currentWareId").val() + "-" + $("#number").val())
    } catch (e) {
    }
    var t = "";
    try {
        var a = $("#dist").val();
        a && "jd" == a && (t = "?dist=jd")
    } catch (e) {
    }
    if ($("#currentWareId").val() != $("#preWareId").val()) {
        if (e) {
            "16" == e.code && setCookie("addCartToastMsg", e.msg);
            var o = "/product/" + $("#currentWareId").val() + ".html" + t + "?addCartToast=" + e.code
        } else var o = "/product/" + $("#currentWareId").val() + ".html" + t;
        location.href = o
    } else if (e) {
        var i = {};
        i = "16" == e.code ? $.extend(i, oldToastConfig._16, {message: e.msg}) : $.extend(i, oldToastConfig["_" + e.code]), showMessage(i)
    }
}

function buyBtnBindHandle() {
    var e = document.getElementById("isPopupsCheck").value,
        t = document.getElementById("isHaveSpec").value,
        a = document.getElementById("addCartBtm"),
        o = document.getElementById("directorderBtm");
    "true" == e && a && "true" == t ? popupsOpenTrigger(a, oFlickMenuMask, oSpecMenuCon, "spec-menu-show", "spec-menu-hide", function () {
        pingClickWithLevel("MProductdetail_SpecificationsVirtual", "A", "", $("#currentWareId").val(), "")
    }, function () {
        updateSpecBottomButton(), "true" == isHasWarrantyCheck ? $(".warranty-wrap").css("display", "block") : $(".warranty-wrap").css("display", "none"), $("#directorder_spec").hasClass("ok_spec_btn") && $("#directorder_spec").removeClass("ok_spec_btn")
    }) : $(".add_cart").bind("click", addWareToCart), $("#ybId").val() || directorder(e, o, t)
}

function directorder(e, t, a) {
    "true" == e && t && "true" == a ? popupsOpenTrigger(t, oFlickMenuMask, oSpecMenuCon, "spec-menu-show", "spec-menu-hide", function () {
        pingClickWithLevel("MProductdetail_SpecificationsVirtual", "B", "", $("#currentWareId").val(), "")
    }, function () {
        updateSpecBottomButton(), $(".warranty-wrap").css("display", "none"), $("#add_cart_spec").hide(), $("#directorder_spec").html("确定"), $("#directorder_spec").addClass("ok_spec_btn"), $("#directorder_spec").show()
    }) : ($("#directorder_spec").hasClass("ok_spec_btn") && $("#directorder_spec").removeClass("ok_spec_btn"), $(".directorder").bind("click", addWareToCartAndNoJump))
}

function buyImmediatelyClickFunction() {
    colorSizeSpecValidate() && ("1" == $("#type").val() ? addWareToCart() : (pingClickWithLevel("MProductdetail_ImmediatelyBuy", "", "", $("#currentWareId").val(), "5"), jQuery.ajax({
        url: urlEncode("/ware/isAppoint.json", $("#sid").val()),
        data: {wareId: $("#currentWareId").val()},
        dataType: "json",
        success: function (e) {
            try {
                if (e && 1 == e.isAppoint) addWareToCart();
                else {
                    var t = "";
                    t = e && e.text ? e.text : "系统繁忙,请稍后再试!";
                    var a = {cls: "succee-icon", duration: 2e3, message: t, height: 88, width: 180};
                    showMessage(a)
                }
            } catch (e) {
                var a = {cls: "error-icon", duration: 2e3, message: "系统繁忙,请稍后再试!", height: 88, width: 180};
                showMessage(a)
            }
        },
        error: function (e) {
            window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html"
        }
    })))
}

function newDetailInit() {
    try {
        slide("#slide").init({
            startIndex: 0,
            number: !0,
            laseMoveFn: jump,
            lastImgSlider: sliderJump,
            preDef: "lnr",
            location: !0,
            autoPlay: !1,
            autoHeight: !1,
            mpingEvent: "MProductdetail_SlideFocusPic",
            wareId: $("#currentWareId").val(),
            isBanOneImg: !1,
            numberWrapId: "#slidePageNub"
        })
    } catch (e) {
    }
    $("#miaoshaRemainTime").val() && initDetail({
        argObj: {
            seckill: {
                seckillTime: "2015-08-03 20:00:02",
                timeRemain: $("#miaoshaRemainTime").val()
            }
        }, seckillCallback: function () {
            try {
                var e = parseInt($("#refresh").val());
                if (e > 0 && e < 3) return location.href = "/product/" + $("#currentWareId").val() + ".html?refresh=" + $("#refresh").val(), !1
            } catch (e) {
            }
            return !1
        }
    }), serviceExpand(), serviceAndExtendWarranty("true" == isHasWarrantyCheck ? !0 : !1), "false" != $("#isShowDetail").val() && "" != $("#currentWareId").val() ? commentListInit({
        containerID: "comment-listID",
        url: "data.json",
        maxCount: 3,
        fontSize: 14,
        filters: {}
    }) : ($("#comments").parent().text(""), $("#goods").parent().text(""));
    var e = document.querySelector(".spec-first-pic"),
        t = document.querySelector(".big-pic-popups"),
        a = document.querySelector("#bigPicPageNub .btn-arrow-left"),
        o = document.documentElement.clientWidth;
    document.querySelector(".scroll-big-imgs").style.marginTop = -o / 2 + "px", e.addEventListener("click", function () {
        pingClickWithLevel("MProductdetail_SpecificationPic", "", "", "", ""), specBigPicRequest()
    }, !1), t.addEventListener("click", function () {
        var e = document.querySelector('#bigPicPageNub [data-slide-num="slideNub"]').innerHTML;
        pingClickWithLevel("MProductdetail_SpecBigPicClick", e, "", $("#currentWareId").val(), ""), $(".big-pic-popups").fadeOut()
    }, !1), a.addEventListener("click", function (e) {
        e.stopPropagation();
        var t = document.querySelector('#bigPicPageNub [data-slide-num="slideNub"]').innerHTML;
        pingClickWithLevel("MProductdetail_SpecBigPicBack", t, "", $("#currentWareId").val(), ""), $(".big-pic-popups").fadeOut()
    }, !1), warDesClickFn()
}

function warDesClickFn() {
    $(".warranty-des-href").on("click", function () {
        pingClickWithLevel("MProductdetail_SpecInsuranceExplain", "", "", $("#currentWareId").val(), ""), jdM.sessionstorage.set("ybId", $("#ybId").val()), jdM.sessionstorage.set("ybSku", $("#currentWareId").val()), window.location.href = $(this).attr("data-href")
    })
}

function specBigPicRequest() {
    $.ajax({
        type: "get",
        url: "/ware/newWarePicShow.json?wareId=" + $("#currentWareId").val() + "&picInitNum=1",
        dataType: "json",
        beforeSend: function () {
        },
        success: function (e) {
            var t = "";
            if (e && e.ware && e.ware.images && e.ware.images.length > 0) {
                t += '<ul data-slide-ul="firstUl">';
                for (var a = 0; a < e.ware.images.length; a++) t += '<li data-ul-child="child">', t += '    <img alt="' + e.ware.wname + '" src="' + e.ware.images[a].newpath.replace("/n4/", "/n12/").replace("http://", "//") + '" onerror="imgError();">', t += "</li>";
                t += "</ul>", $("#bigPicSlide").html(t), slide("#bigPicSlide").init({
                    startIndex: 0,
                    number: !0,
                    loop: !0,
                    preDef: "lnr",
                    autoPlay: !1,
                    autoHeight: !1,
                    mpingEvent: "MProductdetail_SpecSlideBigPic",
                    wareId: $("#currentWareId").val(),
                    isBanOneImg: !0,
                    numberWrapId: "#bigPicPageNub"
                }), $(".big-pic-popups").fadeIn()
            }
        },
        error: function (e, t) {
        }
    })
}

function jump(e) {
    var t = document.getElementById("tittup"),
        a = document.getElementById("slide"),
        o = a.offsetWidth;
    e < -o / 5 && (t.children[0].classList.add("rotate"), t.children[1].innerHTML = "释放查看详情"), e > -o / 5 && (t.children[0].classList.remove("rotate"), t.children[1].innerHTML = "滑动查看详情"), t.style.WebkitTransform = "translateX(" + e + "px)", t.style.transform = "translateX(" + e + "px)"
}

function sliderJump() {
    headerslider.sliderJump()
}

function getCookie(e) {
    for (var t = document.cookie.split(";"), a = 0; a < t.length; a++)
        if (t[a].indexOf(e) >= 0) {
            var o = t[a].split("=");
            return o && o.length > 1 && "" != o[1] ? unescape(o[1]) : ""
        }
    return ""
}

function getCookieBy(e) {
    for (var t = document.cookie.split(";"), a = 0; a < t.length; a++)
        if (t[a].indexOf(e) >= 0) {
            var o = t[a].split("=");
            return o && o.length > 1 && "" != o[1] ? decodeURI(o[1]) : ""
        }
    return ""
}

function setCookie(e, t, a) {
    try {
        var o = e + "=" + encodeURI(t);
        if (0 != a) {
            var i = new Date,
                r = 3600 * a * 1e3;
            i.setTime(i.getTime() + r), o += "; expires=" + i.toGMTString()
        }
        o += ";path=/;domain=.m.jd.com", document.cookie = o
    } catch (e) {
    }
}

function clearCookie(e) {
    setCookie(e, "", -1)
}

function addWareToCart() {
    if (beforeAddCart("1"), modify(), colorSizeSpecValidate())
        if ($("#addCartLoading").length > 0 && $("#addCartLoading").val() && "true" == $("#addCartLoading").val() && $(".cart-loading-icon").css("display", "inline-block"), isPrescribedDrug) addDrugToCart();
        else if (isJdEcard) addJdEcardToCart();
        else if ("1" == $("#type").val() || "true" == $("#isBuyCode").val() || isSamCard || isOilCard || isCustomize || isGameCharge || hasAddCartNode || "true" == isFreshCard) "1" == $("#type").val() ? isSpecWindowOpen() ? pingAddClickWithLevel("MProductdetail_PurchaseImmediately", "W", "", $("#currentWareId").val(), "5") : pingAddClickWithLevel("MProductdetail_PurchaseImmediately", "N", "", $("#currentWareId").val(), "5") : "true" == $("#isBuyCode").val() && pingAddClickWithLevel("MProductdetail_ShoppingCodeBuy", "", "", $("#currentWareId").val(), "5"), isSamCard && pingClickWithLevel("MProductdetail_SamCardBuy", "", "", "", ""), isOilCard && (isSpecWindowOpen() ? pingClickWithLevel("MProductdetail_OilCardOrder", "W", "", $("#currentWareId").val(), "5") : pingClickWithLevel("MProductdetail_OilCardOrder", "N", "", $("#currentWareId").val(), "5")), isCustomize && (isSpecWindowOpen() ? pingClickWithLevel("MProductdetail_Customization", $("#currentWareId").val() + "_W", "", $("#currentWareId").val(), "3") : pingClickWithLevel("MProductdetail_Customization", $("#currentWareId").val() + "_N", "", $("#currentWareId").val(), "3")), isGameCharge && pingClickWithLevel("MProductdetail_GameCardOrder", "", "", "", "5"), hasAddCartNode && sendAddCartNodeEvent(orderEvent), addCartBizName && "staging" == addCartBizName ? fqyJump(addCartBizName) : judgeKO($("#currentWareId").val(), $("#sid").val(), addCartBizName);
        else {
            try {
                isSpecWindowOpen() ? pingAddClickWithEventParam("MProductdetail_SpecificationAddtocart", eventParam, "", $("#currentWareId").val(), "5") : pingAddClickWithEventParam("MProductdetail_Addtocart", eventParam, "", $("#currentWareId").val(), "5")
            } catch (e) {
                pingAddClickWithEventParam("MProductdetail_Addtocart", eventParam, "", $("#currentWareId").val(), "5")
            }
            newAddWare($("#currentWareId").val(), $("#number").val(), !1, $("#ybId").val(), $("#resourceType").val(), $("#resourceValue").val(), $("#sid").val())
        }
}

function addWareToCartAndNoJump() {
    beforeAddCart("2"), modify(), colorSizeSpecValidate() && "0" == isXnzt && (isSpecWindowOpen() ? $("#directorder_spec").hasClass("ok_spec_btn") ? pingAddClickWithEventParam("MProductdetail_SpecificationsConfirm", $("#currentWareId").val(), "", $("#currentWareId").val(), "5") : pingAddClickWithEventParam("MProductdetail_SpecificationEasybuy", easyByEventparam, "", $("#currentWareId").val(), "5") : pingAddClickWithEventParam("MProductdetail_Easybuy", easyByEventparam, "", $("#currentWareId").val(), "5"), isJdEcard ? tojdEcartPage($("#currentWareId").val(), $("#number").val()) : newAddWare($("#currentWareId").val(), $("#number").val(), !0, $("#ybId").val(), $("#resourceType").val(), $("#resourceValue").val(), $("#sid").val()))
}

function infoRender(e) {
    if (e && e.ware && e.ware.wareId && $("#wareInfo").attr("href", urlEncode("/detail/" + e.ware.wareId + ".html", $("#sid").val())), e && e.stock) {
        var t = "";
        e.stock.jdPrice && "" != e.stock.jdPrice && "null" != e.stock.jdPrice.toLowerCase() && parseFloat(e.stock.jdPrice) > 0 ? t = e.stock.jdPrice : (t = "暂无报价", $(".depreciate-arrival-inform-box").attr("style", "display:none;")), $("#price").html(t), $("#currentWareId").val(e.stock.wareId), $("#jdPrice").val(e.stock.jdPrice), $("#changeSkuFlag").val(e.stock.changeSkuFlag), $("#areaSkuId").val(e.stock.newSku), "1" == e.stock.changeSkuFlag ? $("#areaToast").val(e.stock.changeSkuToast) : "3" == e.stock.changeSkuFlag && $("#areaReasonTips").val(e.stock.changeSkuToast)
    } else {
        var t = "";
        e && e.ware && e.ware.jdPrice && "" != e.ware.jdPrice && "null" != e.ware.jdPrice.toLowerCase() && parseFloat(e.ware.jdPrice) > 0 ? t = e.ware.jdPrice : (t = "暂无报价", $(".depreciate-arrival-inform-box").attr("style", "display:none;")), $("#price").html(t), e && e.ware && e.ware.jdPrice && $("#jdPrice").val(e.ware.jdPrice)
    }
    if (e && e.stock && e.stock.flag ? (e.stock.jdPrice > 0 && e.stock.flag && ($("#stockFlag").val(e.stock.flag), "true" != $("#isYuYue").val() && ($("#bottom_prompt_msg_div").hide(), $(".hold-div-bottom").attr("style", "display:none;"), bottom618())), "none" !== $("#couponDivShow").css("display") || $("#prodPromotion").length > 0 || $("#couponActivity").attr("class", "goods-part bdr-tb mar-t"), $("#whiteBarInfo").attr("data") && "" != $("#whiteBarInfo").attr("data") && "null" != $("#whiteBarInfo").attr("data") && $("#whiteBarInfo").attr("style", "display:")) : ("none" !== $("#couponDivShow").css("display") || $("#prodPromotion").length > 0 || $("#couponActivity").attr("class", "goods-part mar-t"), $("#whiteBarInfo").attr("style", "display:none"), e && e.stock && e.stock.flag ? $("#stockFlag").val(e.stock.flag) : ($("#stockStatus").text() ? $("#prompt_msg").text($("#stockStatus").text()) : $("#prompt_msg").text(reasonTips("抱歉，所选地区暂时无货")), $("#bottom_prompt_msg_div").show(), $(".hold-div-bottom").attr("style", "display:block;"))), "true" == $("#isYuYue").val())
        if (e.stock && e.stock.flag) {
            var a = $("#yuyueType").val();
            switch (a) {
                case "4":
                    $(".buyImmediately").removeClass("disabled"), $(".buyImmediately").bind("click", function () {
                        buyImmediatelyClickFunction()
                    })
            }
        } else {
            var a = $("#yuyueType").val();
            switch ($("#bottom_prompt_msg_div").show(), $(".hold-div-bottom").attr("style", "display:block"), a) {
                case "4":
                    "无货" == e.stock.status ? $("#stockStatus").text(reasonTips("抱歉，所选地区暂时无货")) : "暂不支持配送" == e.stock.status ? $("#stockStatus").text("抱歉，该商品暂不支持购买") : $("#stockStatus").text("抱歉，所选地区暂时无货"), $("#prompt_msg").text($("#stockStatus").text()), $(".buyImmediately").addClass("disabled"), $(".buyImmediately").unbind("click")
            }
        }
}

function stockRender(e) {
    if (e) {
        if (e.feeType) {
            var t = window.location.href;
            t && (t = t.split("#")[0]), window.location.href = t
        }
        if (e.ware && e.ware.soldOversea && ("true" == e.ware.soldOversea.isSoldOversea ? ($("#isSoldOversea").val("true"), isSoldOversea = "true", $("#whiteBarInfo").attr("data", ""), $(".prod-whitebar-txt").html(""), $("#whiteBarInfo").hide(), $("#saveEnergy").hide(), $("#oldChangNew").hide()) : ($("#isSoldOversea").val("false"), isSoldOversea = "false", e.ware.whiteBarInfo && e.ware.whiteBarInfo.marketingText && "null" != e.ware.whiteBarInfo.marketingText && ($("#whiteBarInfo").attr("data", e.ware.whiteBarInfo.marketingText), $(".prod-whitebar-txt").html(e.ware.whiteBarInfo.marketingText), $("#whiteBarInfo").show()), $("#saveEnergy").show(), $("#oldChangNew").show())), e.thirdAddressSamInfo && e.thirdAddressSamInfo && e.thirdAddressSamInfo.samNewSku) {
            var a = e.thirdAddressSamInfo.samNewSku;
            "null" != a && a != $("#currentWareId").val() && ("1" == e.changeSkuFlag && e.areaToast && "null" != e.areaToast && setCookie("item_areaToast", e.areaToast, 0), location.href = "/product/" + a + ".html")
        }
        if ("1" == e.changeSkuFlag) {
            if (e.areaSkuId) {
                var o = e.areaSkuId;
                "null" != o && (setCookie("item_areaToast", e.areaToast, 0), location.href = "/product/" + o + ".html")
            }
        } else "3" == e.changeSkuFlag && ($("#areaSkuId").val(e.areaSkuId), $("#areaReasonTips").val(e.areaReasonTips), $("#changeSkuFlag").val(e.changeSkuFlag), $(".looksimilar").attr("href", "/product/" + e.areaSkuId + ".html"), $.toast({
            message: e.areaReasonTips,
            styleType: 3,
            autoClose: !1,
            isMaskClose: !0,
            btns: {cancelTxt: "取消", okTxt: "查看同款"},
            okCallback: function () {
                sendDataToService("MProductdetail_SameToastCheck", "", currentWareId, "4"), location.href = "/product/" + e.areaSkuId + ".html"
            },
            closeCallback: function () {
                sendDataToService("MProductdetail_SameToastCancel", "", currentWareId, "")
            }
        }));
        if (e.stock)
            if (e.stock.status && "无货" == e.stock.status || "暂不支持配送" == e.stock.status || !e.stock.flag) {
                $("#cartFlag").val("false");
                var i = "抱歉，所选地区暂时无货";
                if (e.ware && e.ware.reasonTips && (i = e.ware.reasonTips), "3" == e.changeSkuFlag ? $("#stockStatus").text(i) : "无货" == e.stock.status ? $("#stockStatus").text(reasonTips("抱歉，所选地区暂时无货")) : "" != i ? $("#stockStatus").text(i) : $("#stockStatus").text("抱歉，该商品暂不支持购买"), "true" == isJdOtc || "true" == isHk || isSamCard || isCustomize || isPrescribedDrug || hasAddCartNode && buttonDisabledWhenNoStock) $(".add_cart").show(), $(".add_cart").addClass("disabled"), $(".add_cart").unbind("click");
                else {
                    $(".add_cart").hide(), $(".directorder").hide(), changeSkuShowOrHide(!0);
                    var r = e.stock.stockNotice;
                    $("#stockNotice").val(r), r ? ($(".arrivalInform").show(), $("#cart1").hasClass("four-column-l3r1") && ($("#cart1").removeClass("four-column-l3r1"), $("#cart1").addClass("five-column")), $("#cart1").hasClass("three-column") && ($("#cart1").removeClass("three-column"), $("#cart1").addClass("four-column")), $("#cart1").hasClass("four-column") && ($("#cart1").removeClass("four-column"), $("#cart1").addClass("four-column")), $(".looksimilar").hasClass("red-color") && ($(".looksimilar").addClass("yellow-color"), $(".looksimilar").removeClass("red-color"))) : ($(".arrivalInform").hide(), $("#cart1").hasClass("five-column") && ($("#cart1").removeClass("five-column"), $("#cart1").addClass("four-column-l3r1")), $("#cart1").hasClass("four-column") && ($("#cart1").removeClass("four-column"), $("#cart1").addClass("three-column")), $(".looksimilar").hasClass("yellow-color") && ($(".looksimilar").addClass("red-color"), $(".looksimilar").removeClass("yellow-color")))
                }
            } else {
                if ($("#cartFlag").val("true"), $("#stockStatus").html(e.stock.status), changeSkuShowOrHide(!1), $(".arrivalInform").hide(), "true" == $("#isBuyCode").val() || "1" == $("#type").val() || "1" == isXnzt || "" != $("#ybId").val() || "true" == isJdOtc || "true" == isHk || isSamSku || isSamCard || isOilCard || isCustomize || "true" == isFreshCard || isGameCharge || isPrescribedDrug || hasAddCartNode || "true" == isSoldOversea) $("#ybId").val() ? "true" == $("#isBuyCode").val() || "1" == $("#type").val() || "1" == isXnzt || "true" == isJdOtc || "true" == isHk || isSamSku || isSamCard || isOilCard || isCustomize || isGameCharge || hasAddCartNode ? ($(".directorder").hide(), $(".add_cart").show(), $("#cart1").hasClass("five-column") && ($("#cart1").removeClass("five-column"), $("#cart1").addClass("four-column-l3r1")), $("#cart1").hasClass("four-column") && ($("#cart1").removeClass("four-column"), $("#cart1").addClass("three-column")), isSamCard && isSamMember && ($(".add_cart").addClass("disabled"), $(".add_cart").unbind("click"))) : ($(".directorder").show(), $(".directorder").addClass("disabled"), $(".directorder").unbind("click"), $(".add_cart").show(), $("#cart1").hasClass("three-column") && ($("#cart1").removeClass("three-column"), $("#cart1").addClass("four-column")), $("#cart1").hasClass("four-column-l3r1") && ($("#cart1").removeClass("four-column-l3r1"), $("#cart1").addClass("five-column"))) : ("true" == e.ware.isFreshCard && $("#freshCardUrl").val(e.freshCardUrl), $(".directorder").hide(), $(".add_cart").show(), isSingleBuyBtn = !0, $(".add_cart").unbind("click"), $(".add_cart").bind("click", addWareToCart), $(".add_cart").hasClass("yellow-color") && ($(".add_cart").removeClass("yellow-color"), $(".add_cart").addClass("red-color")), $(".add_cart").hasClass("disabled") && $(".add_cart").removeClass("disabled"), $("#cart1").hasClass("five-column") && ($("#cart1").removeClass("five-column"), $("#cart1").addClass("four-column-l3r1")), $("#cart1").hasClass("four-column") && ($("#cart1").removeClass("four-column"), $("#cart1").addClass("three-column")), isSamCard && isSamMember && ($(".add_cart").addClass("disabled"), $(".add_cart").unbind("click")));
                else {
                    isSingleBuyBtn = !1;
                    var n = document.getElementById("isPopupsCheck").value;
                    "true" == n && ($("#cart1").find(".add_cart").attr("id", "addCartBtm"), $("#cart1").find(".directorder").attr("id", "directorderBtm")), $(".add_cart").show(), $(".add_cart").unbind("click"), $(".directorder").show(), buyBtnBindHandle(), $(".add_cart").hasClass("red-color") && ($(".add_cart").removeClass("red-color"), $(".add_cart").addClass("yellow-color")), $("#cart1").hasClass("three-column") && ($("#cart1").removeClass("three-column"), $("#cart1").addClass("four-column")), $("#cart1").hasClass("four-column-l3r1") && ($("#cart1").removeClass("four-column-l3r1"), $("#cart1").addClass("five-column"))
                }
                isSamCard && !isSamMemberAddcart && ($(".add_cart").addClass("disabled"), $(".add_cart").unbind("click"))
            }
        if (e.stock && e.stock.jdPrice) {
            $("#jdPrice-copy").empty();
            var s = e.stock.jdPrice.split(".");
            s && s.length > 1 ? $("#jdPrice-copy").append('<span class="big-price">' + s[0] + '</span><span class="small-price">.' + s[1] + "</span>") : $("#jdPrice-copy").text(e.stock.jdPrice)
        }
        e.thirdAddressSamInfo && e.thirdAddressSamInfo.samPrice && "暂无报价" != e.thirdAddressSamInfo.samPrice && ($("#samPrice-copy").empty(), $("#samPrice-copy").append(e.thirdAddressSamInfo.samPrice));
        var l = "",
            c = "";
        if ("false" == $("#serviceFloorConfig").val() && (e.ware && e.ware.iconList && 0 == e.ware.iconList.length || "" == e.ware.iconList || "null" == e.ware.iconList || !e.ware.iconList) ? $(".service-floor").hide() : ($(".service-floor").empty(), e.ware && e.ware.soldOversea && e.ware.soldOversea.soldOverseaService && e.ware.soldOversea.soldOverseaService.soldOverseaText && "null" != e.ware.soldOversea.soldOverseaService.soldOverseaText && (l += '<div class="service-tip-module">', l += '<i class="service-icon support-service-icon"></i>', l += '<span class="service-icon-text">' + e.ware.soldOversea.soldOverseaService.soldOverseaText + "</span>", l += "</div>"), e.ware && e.ware.shortService && "null" != e.ware.shortService && (l += '<div class="service-tip-module">', l += '<i class="service-icon support-service-icon"></i>', l += '<span class="service-icon-text">' + e.ware.shortService + "</span>", l += "</div>"), l += '<span class="service-floor-iconList">', e.ware && e.ware.iconList && e.ware.iconList.length > 0 && $.each(e.ware.iconList, function (e, t) {
                l += '<div class="service-tip-module">', l += '<i class="service-icon support-service-icon"></i>', l += '<span class="service-icon-text">' + t.name + "</span>", l += "</div>"
            }), l += "</span>", e.ware && 1 == e.ware.is7ToReturn && e.ware.is7shortService && "null" != e.ware.is7shortService && (l += '<div class="service-tip-module">', l += '<i class="service-icon support-service-icon"></i>', l += '<span class="service-icon-text">' + e.ware.is7shortService + "</span>", l += "</div>"), e.ware && 0 == e.ware.is7ToReturn && e.ware.is7shortService && "null" != e.ware.is7shortService && (l += '<div class="service-tip-module">', l += '<i class="service-icon nonsupport-service-icon"></i>', l += '<span class="service-icon-text">' + e.ware.is7shortService + "</span>", l += "</div>"), e.ware && e.ware.xnztTips && "null" != e.ware.xnztTips && e.ware.xnztTips.name && "null" != e.ware.xnztTips.name && (l += '<div class="service-tip-module">', l += '<i class="service-icon nonsupport-service-icon"></i>', l += '<span class="service-icon-text">' + e.ware.xnztTips.name + "</span>", l += "</div>"), e.ware && e.ware.otcInfo && "null" != e.ware.otcInfo && e.ware.otcInfo.instructionText && "null" != e.ware.otcInfo.instructionText && (l += '<div class="service-tip-module">', l += '<i class="service-icon nonsupport-service-icon"></i>', l += '<span class="service-icon-text">' + e.ware.otcInfo.instructionText + "</span>", l += "</div>"), e.ware && e.ware.drugInfo && "null" != e.ware.drugInfo && e.ware.drugInfo.drugServiceIcon && "null" != e.ware.drugInfo.drugServiceIcon && e.ware.drugInfo.drugServiceIcon.title && "null" != e.ware.drugInfo.drugServiceIcon.title && (l += '<div class="service-tip-module">', l += '<i class="service-icon nonsupport-service-icon"></i>', l += '<span class="service-icon-text">' + e.ware.drugInfo.drugServiceIcon.title + "</span>", l += "</div>"), e.jdPromptText && (l += '<div class="service-tip-module">', l += '<i class="service-icon nonsupport-service-icon"></i>', l += '<span class="service-icon-text">不支持' + e.jdPromptText + "</span>", l += "</div>"), $(".service-floor").append(l), $(".service-floor").show(), $(".service-menu-wrapper").empty(), e.ware && e.ware.soldOversea && e.ware.soldOversea.soldOverseaService && e.ware.soldOversea.soldOverseaService.soldOverseaIcon && "null" != e.ware.soldOversea.soldOverseaService.soldOverseaIcon && e.ware.soldOversea.soldOverseaService.soldOverseaText && "null" != e.ware.soldOversea.soldOverseaService.soldOverseaText && e.ware.soldOversea.soldOverseaService.soldOverseaDesc && "null" != e.ware.soldOversea.soldOverseaService.soldOverseaDesc && (c += '<div class="service-item-row">', c += '<img src="' + e.ware.soldOversea.soldOverseaService.soldOverseaIcon + '" class="service-item-icon">', c += '<span class="service-item-title">' + e.ware.soldOversea.soldOverseaService.soldOverseaText + "</span>", c += '<span class="service-item-text">' + e.ware.soldOversea.soldOverseaService.soldOverseaDesc + "</span>", c += "</div>"), e.ware && e.ware.serviceIconUrl && "null" != e.ware.serviceIconUrl && e.ware.shortService && "null" != e.ware.shortService && e.ware.service && "null" != e.ware.service && (c += '<div class="service-item-row">', c += '<img src="' + e.ware.serviceIconUrl + '" class="service-item-icon">', c += '<span class="service-item-title">' + e.ware.shortService + "</span>", c += '<span class="service-item-text">' + e.ware.service + "</span>", c += "</div>"), c += '<div class="service-menu-iconList">', e.ware && e.ware.iconList && e.ware.iconList.length > 0 && $.each(e.ware.iconList, function (e, t) {
                t && t.imageUrl && $("#httpsConfig") && "true" == $("#httpsConfig").val() && (t.imageUrl = t.imageUrl.replace("http://", "//")), c += '<div class="service-item-row">', c += '<img src="' + t.imageUrl + '" class="service-item-icon">', c += '<span class="service-item-title">' + t.name + "</span>", c += '<span class="service-item-text">' + t.tip + "</span>", c += "</div>"
            }), c += "</div>", e.ware && e.ware.is7shortService && "null" != e.ware.is7shortService && e.ware.warmTips && "null" != e.ware.warmTips && e.ware.warmTips.length > 0 && $.each(e.ware.warmTips, function (t, a) {
                c += '<div class="service-item-row">', c += '<img src="' + a.imageUrl + '" class="service-item-icon">', c += '<span class="service-item-title">' + e.ware.is7shortService + "</span>", c += '<span class="service-item-text">' + a.text + "</span>", c += "</div>"
            }), e.ware && e.ware.xnztTips && "null" != e.ware.xnztTips && e.ware.xnztTips.icon && "null" != e.ware.xnztTips.icon && e.ware.xnztTips.name && "null" != e.ware.xnztTips.name && e.ware.xnztTips.tip && "null" != e.ware.xnztTips.tip && (c += '<div class="service-item-row">', c += '<img src="' + e.ware.xnztTips.icon + '" class="service-item-icon">', c += '<span class="service-item-title">' + e.ware.xnztTips.name + "</span>", c += '<span class="service-item-text">' + e.ware.xnztTips.tip + "</span>", c += "</div>"), e.ware && e.ware.otcInfo && "null" != e.ware.otcInfo && e.ware.otcInfo.OTCIcon && "null" != e.ware.otcInfo.OTCIcon && e.ware.otcInfo.instructionText && "null" != e.ware.otcInfo.instructionText && e.ware.otcInfo.instruction && "null" != e.ware.otcInfo.instruction && (c += '<div class="service-item-row">', c += '<img src="' + e.ware.otcInfo.OTCIcon + '" class="service-item-icon">', c += '<span class="service-item-title">' + e.ware.otcInfo.instructionText + "</span>", c += '<span class="service-item-text">' + e.ware.otcInfo.instruction + "</span>", c += "</div>"), e.ware && e.ware.drugInfo && "null" != e.ware.drugInfo && e.ware.drugInfo.drugServiceIcon && "null" != e.ware.drugInfo.drugServiceIcon && e.ware.drugInfo.drugServiceIcon.imageUrl && "null" != e.ware.drugInfo.drugServiceIcon.imageUrl && e.ware.drugInfo.drugServiceIcon.title && "null" != e.ware.drugInfo.drugServiceIcon.title && e.ware.drugInfo.drugServiceIcon.desc && "null" != e.ware.drugInfo.drugServiceIcon.desc && (c += '<div class="service-item-row">', c += '<img src="' + e.ware.drugInfo.drugServiceIcon.imageUrl + '" class="service-item-icon">', c += '<span class="service-item-title">' + e.ware.drugInfo.drugServiceIcon.title + "</span>", c += '<span class="service-item-text">' + e.ware.drugInfo.drugServiceIcon.desc + "</span>", c += "</div>"), e.jdPromptText && "" != e.jdPromptText && (c += '<div class="service-item-row">', c += '<img src="../../../images/5.4/service-coupon.png" class="service-item-icon">', c += '<span class="service-item-title">不支持' + e.jdPromptText + "</span>", c += '<span class="service-item-text">本商品不能使用' + e.jdPromptText + "</span>", c += "</div>"), $(".service-menu-wrapper").append(c)), e.ware && e.ware.fare && ($("#fareMoney").empty(), $("#fareMoney").text(e.ware.fare), $("#fare").show()), e.ware && e.ware.saveEnergy && e.ware.saveEnergy.energyText ? ($("#saveEnergyUrl").attr("href", e.ware.saveEnergy.energyUrl), $("#saveEnergyUrlText").html(e.ware.saveEnergy.energyText), $("#saveEnergy").attr("style", "display:")) : $("#saveEnergy").attr("style", "display:none;"), $("#stockStatus").text() ? $("#prompt_msg").text($("#stockStatus").text()) : $("#prompt_msg").text(reasonTips("抱歉，所选地区暂时无货")), e.ware && e.ware.proFlagList && ($("#sale").empty(), $.each(e.ware.proFlagList, function (e, t) {
                $("#sale").append('<i class="icon-bg02">' + t.text + "</i> ")
            })), e.proInformation) {
            var d = {};
            try {
                d.promotionInfo = e.proInformation, M.setRunMod(["promotionInfo"]), M.runner(d)
            } catch (e) {
            }
        }
        var u = "";
        if (e.ware.yanBaoInfo && e.ware.yanBaoInfo.length > 0) {
            for (var p = 0; p < e.ware.yanBaoInfo.length; p++) {
                u += '<div class="warranty-items">', u += '<div class="warranty-items-wrap">', u += '<img class="warranty-items-img" src="' + e.ware.yanBaoInfo[p].products[0].imgurl + '">', u += '<span class="warranty-items-title">' + e.ware.yanBaoInfo[p].sortName + "</span>", e.yanbaoServiceInfoUrl && "null" != e.yanbaoServiceInfoUrl && (u += '<a class="warranty-des-href" href="javascript:void(0);" data-href="' + e.yanbaoServiceInfoUrl + '">', u += '<span class="warranty-des">服务介绍</span>', u += '<span class="warranty-des-icon"></span>', u += "</a>"), u += "</div>", u += '<div class="warranty-btn-wrap" data-selFlag="0" data-type="' + e.ware.yanBaoInfo[p].sortName + '">', u += '<div class="warranty-btn-row">';
                for (var m = 0; m < e.ware.yanBaoInfo[p].products.length; m++)(m + 1) % 2 == 0 ? (u += '<a class="warranty-btn J_ping" data="' + e.ware.yanBaoInfo[p].products[m].platformPid + '" report-eventid="MProductdetail_SpecificationInsurance">', u += '<span class="war-btn-text">' + e.ware.yanBaoInfo[p].products[m].sortName + '</span><span class="war-btn-price">&yen;' + e.ware.yanBaoInfo[p].products[m].price + "</span>", u += '</a></div><div class="warranty-btn-row">') : (u += '<a class="warranty-btn J_ping" data="' + e.ware.yanBaoInfo[p].products[m].platformPid + '" report-eventid="MProductdetail_SpecificationInsurance">', u += '<span class="war-btn-text">' + e.ware.yanBaoInfo[p].products[m].sortName + '</span><span class="war-btn-price">&yen;' + e.ware.yanBaoInfo[p].products[m].price + "</span>", u += "</a>");
                u += "</div></div></div>"
            }
            isHasWarrantyCheck = "true", $("#spec_yanbaoItems").html(u), $("#warranty-seled-list").html('<div class="base-txt warranty-text choose-tip"><i class="warranty-icon"></i>可选延保</div>'), serviceAndExtendWarranty(), warDesClickFn()
        } else isHasWarrantyCheck = "false", $("#spec_yanbaoItems").html(u), $("#warranty-seled-list").html("");
        e.ware.fare && "null" != e.ware.fare ? ($("#fareMoney").html(e.ware.fare), $("#fare").css("display", "block")) : $("#fare").css("display", "none");
        try {
            e.ware && e.ware.weightInfo && e.ware.weightInfo.content ? ($("#weightInfoDiv").show(), $("#weightInfoText").html(e.ware.weightInfo.content), $("#specWeightDiv").show(), $("#spec_weight").html(e.ware.weightInfo.content)) : ($("#weightInfoDiv").hide(), $("#specWeightDiv").hide())
        } catch (e) {
        }
    }
    $(".arrivalInform").length > 0 && $(".arrivalInform").each(function () {
        depreciatePop($(this).attr("id"), "arrvalInformBlock")
    });
    var v = new Date;
    v.setTime(v.getTime() + 2592e6), document.cookie = "commonAddress=;expires=" + v.toGMTString() + ";path=/;domain=.m.jd.com"
}

function minus() {
    var e = parseInt($("#number").val(), 10),
        t = $("#lowestbuy").val();
    t = parseInt(t), 200 != t && $(".quantity-increase").hasClass("limited") && $(".quantity-increase").removeClass("limited"), t && t > 1 ? (e <= 200 && $(".lowestbuy-tip").html("(" + t + "件起购)"), e <= t + 1 ? ($(".quantity-decrease").hasClass("limited") || $(".quantity-decrease").addClass("limited"), $("#number").val(t),
        $(".amount").html(t + "件")) : ($(".quantity-decrease").hasClass("limited") && $(".quantity-decrease").removeClass("limited"), e--, $("#number").val(e), $(".amount").html(e + "件"))) : (e <= 200 && $(".lowestbuy-tip").html(""), e <= 2 ? ($(".quantity-decrease").hasClass("limited") || $(".quantity-decrease").addClass("limited"), $("#number").val(1), $(".amount").html("1件")) : ($(".quantity-decrease").hasClass("limited") && $(".quantity-decrease").removeClass("limited"), e--, $("#number").val(e), $(".amount").html(e + "件")))
}

function plus() {
    var e = parseInt($("#number").val(), 10),
        t = $("#lowestbuy").val();
    t = parseInt(t), e < 200 && $(".quantity-decrease").hasClass("limited") && $(".quantity-decrease").removeClass("limited"), e >= 199 ? (200 != t && $(".lowestbuy-tip").html("(限购200件)"), $(".quantity-increase").hasClass("limited") || $(".quantity-increase").addClass("limited"), $("#number").val(200), $(".amount").html("200件")) : (e++, $("#number").val(e), $(".amount").html(e + "件"))
}

function modify() {
    var e = parseInt($("#number").val(), 10),
        t = $("#lowestbuy").val();
    t = parseInt(t), isNaN(e) ? t && t > 1 ? ($(".lowestbuy-tip").html("(" + t + "件起购)"), $.toast({
        message: t + "件起购",
        delay: 2e3,
        cls: "error-icon"
    }), $(".quantity-decrease").hasClass("limited") || $(".quantity-decrease").addClass("limited"), $("#number").val(t), $(".amount").html(t + "件")) : ($(".quantity-decrease").hasClass("limited") || $(".quantity-decrease").addClass("limited"), $("#number").val(1), $(".amount").html("1件")) : (t && t > 1 ? (e < 200 && t < 200 ? $(".lowestbuy-tip").html("(" + t + "件起购)") : e <= 200 && 200 == t ? $(".lowestbuy-tip").html("(" + t + "件起购)") : $(".lowestbuy-tip").html("(限购200件)"), parseInt(e) < t ? (0 == $(".message-box").length && $.toast({
        message: t + "件起购",
        delay: 2e3,
        isMaskClose: !1,
        cls: "error-icon"
    }), $(".quantity-decrease").hasClass("limited") || $(".quantity-decrease").addClass("limited"), $("#number").val(t), $(".amount").html(t + "件")) : parseInt(e) == t ? ($(".quantity-decrease").hasClass("limited") || $(".quantity-decrease").addClass("limited"), $("#number").val(t), $(".amount").html(t + "件")) : ($(".quantity-decrease").hasClass("limited") && $(".quantity-decrease").removeClass("limited"), $("#number").val(parseInt(e)), $(".amount").html(parseInt(e) + "件"))) : (e <= 1 ? ($(".quantity-decrease").hasClass("limited") || $(".quantity-decrease").addClass("limited"), $("#number").val(1), $(".amount").html("1件")) : ($(".quantity-decrease").hasClass("limited") && $(".quantity-decrease").removeClass("limited"), $("#number").val(parseInt(e)), $(".amount").html(parseInt(e) + "件")), e < 200 ? $(".lowestbuy-tip").html("") : $(".lowestbuy-tip").html("(限购200件)")), 200 == e && ($(".quantity-increase").hasClass("limited") || $(".quantity-increase").addClass("limited")))
}

function MaxCheck() {
    var e = parseInt($("#number").val(), 10),
        t = $("#lowestbuy").val();
    t = parseInt(t), e >= 200 ? (200 != t && $(".lowestbuy-tip").html("(限购200件)"), $(".quantity-increase").hasClass("limited") || $(".quantity-increase").addClass("limited"), $("#number").val(200), $(".amount").html("200件")) : 200 != t && $(".quantity-increase").hasClass("limited") && $(".quantity-increase").removeClass("limited")
}

function pingClick(e, t, a, o) {
    if ($("#pingUse").val()) try {
        var i = new MPing.inputs.Click(e);
        i.event_param = t, i.page_param = o;
        (new MPing).send(i)
    } catch (e) {
    }
}

function pingClickWithLevel(e, t, a, o, i) {
    if ($("#pingUse").val()) try {
        var r = new MPing.inputs.Click(e);
        r.event_param = t, r.page_param = o, r.event_level = i;
        (new MPing).send(r)
    } catch (e) {
    }
}

function pingAddClick(e, t, a, o) {
    try {
        if ($("#pingUse").val()) {
            var i = new MPing.inputs.AddCart(e, o);
            i.event_param = o;
            (new MPing).send(i)
        }
    } catch (e) {
    }
}

function pingAddClickWithLevel(e, t, a, o, i) {
    try {
        if ($("#pingUse").val()) {
            var r = new MPing.inputs.AddCart(e, o);
            r.page_param = o, r.event_param = o, r.event_level = i;
            (new MPing).send(r)
        }
    } catch (e) {
    }
}

function pingAddClickWithEventParam(e, t, a, o, i) {
    try {
        if ($("#pingUse").val()) {
            var r = new MPing.inputs.AddCart(e, o);
            r.page_param = o, r.event_param = t, r.event_level = i;
            (new MPing).send(r)
        }
    } catch (e) {
    }
}

function floorABCTestPing(e) {
    try {
        if ($("#floorABCTest").val() && "true" == $("#floorABCTest").val()) {
            var t = "";
            t = $("#downloadBM").length > 0 ? "B" : $("#downloadBR").length > 0 ? "C" : "A", pingAddClickWithEventParam(e, t, "", "", "")
        }
    } catch (e) {
    }
}

function openAppABCTest(e) {
    try {
        if ($("#openAppABCflag") && "" != $("#openAppABCflag").val()) {
            pingAddClickWithEventParam(e, $("#openAppABCflag").val(), "", "", "")
        }
    } catch (e) {
    }
}

function goToGameCharge(e) {
    if (e) {
        var t = e + "?skuId=" + $("#currentWareId").val() + "&skuName=" + encodeURIComponent($("#goodName").val()) + "&skuPrice=" + $("#jdPrice").val() + "&chargeType=" + $("#thirdCategoryId").val();
        window.location.href = t
    }
}

function reasonTips(e) {
    var t = $("#reasonTips").val();
    return "" == t ? e : t
}

function picShowGoback() {
    var e = window.sessionStorage;
    "true" == e.getItem("picShowGoback") && (e.removeItem("picShowGoback"), $("#orderComment").click())
}

function replyListGoBack() {
    var e = window.sessionStorage;
    "true" == e.getItem("replyListGoBack") && (e.removeItem("replyListGoBack"), $("#pingjia").click())
}

function warePicShowGoback() {
    try {
        window.localStorage;
        "true" == localStorage.getItem("warePicShowGoback") && (localStorage.removeItem("warePicShowGoback"), $("#detailInfo").click())
    } catch (e) {
    }
}

function toWarePicShow() {
    var e = "/ware/newWarePicShow.action?";
    try {
        var t = document.querySelector('#slidePageNub [data-slide-num="slideNub"]').innerHTML;
        e += "sid=" + $("#sid").val() + "&wareId=" + $("#currentWareId").val() + "&picInitNum=" + t + "&imagePlusFlag=" + $("#imagePlusFlag").val(), location.href = e
    } catch (e) {
    }
}

function toGuessYouLike(e, t) {
    try {
        e && jQuery.getJSON(e + "&jsoncallback=?", function (e) {
        }), t && setTimeout(function () {
            location.href = t
        }, 100)
    } catch (e) {
    }
}

function toSuitPage(e) {
    try {
        e && (pingClickWithLevel("MProductdetail_PreferentialPackage", e, "", $("#currentWareId").val(), "5"), location.href = e)
    } catch (e) {
    }
}

function toShop(e, t) {
    try {
        e && t && (0 == t ? pingClickWithLevel("MProductdetail_EnterShop", e + "_0", "", $("#currentWareId").val(), "5") : 1 == t ? pingClickWithLevel("MProductdetail_EnterShop", e + "_2", "", $("#currentWareId").val(), "5") : 2 == t && pingClickWithLevel("MProductdetail_EnterShop", e + "_1", "", $("#currentWareId").val(), "5"), setTimeout(function () {
            location.href = "https://shop.m.jd.com/?shopId=" + e + "&skuId=" + $("#currentWareId").val() + "&categoryId=" + $("#categoryId").val()
        }, 100))
    } catch (e) {
    }
}

function specPresaleButtonToOrder() {
    if (colorSizeSpecValidate()) {
        try {
            if ($("#pingUse").val()) {
                var e = new MPing.inputs.AddCart("MProductdetail_OrderImmediately", $("#currentWareId").val());
                e.event_param = "W", e.event_level = "5";
                (new MPing).send(e)
            }
        } catch (e) {
        }
        setTimeout(function () {
            try {
                var e = ($("#number").val(), "https://v.m.jd.com/presaleOrder/order.action?wids=" + $("#currentWareId").val() + "&nums=" + $("#number").val() + "&sid=" + $("#sid").val());
                location.href = e
            } catch (e) {
            }
        }, 100)
    }
}

function isSpecWindowOpen() {
    try {
        var e = !1;
        return $(".spec-menu-content").length > 0 && "none" != $(".spec-menu-content").css("display") && (e = !0), e
    } catch (e) {
        return !1
    }
}

function beforeAddCart(e) {
    try {
        var t = "tag_" + (new Date).getTime(),
            a = window.screen.width * window.devicePixelRatio + "_" + window.screen.height * window.devicePixelRatio + "_" + window.screen.colorDepth,
            o = getCookie("USER_FLAG_CHECK");
        jQuery.ajax({
            type: "POST",
            url: "/ware/clientInfoStat.json?step=1&rand=" + t,
            data: {
                statWareId: $("#currentWareId").val(),
                statWareNum: $("#number").val(),
                statAddCartType: e,
                statYbIds: $("#ybId").val(),
                statResourceType: $("#resourceType").val(),
                statResourceValue: $("#resourceValue").val(),
                statSid: $("#sid").val(),
                statUserFlagCheck: o,
                postTime: t,
                tag: a
            },
            success: function (e) {
            },
            error: function (e, t, a, o) {
            }
        })
    } catch (e) {
    }
}

function afterAddCart(e, t, a) {
    try {
        var o = "",
            i = "";
        try {
            if (a) {
                o = JSON.parse(a).sid;
                var r = JSON.parse(a);
                r && r.cartJson && r.cartJson.resultCode && (i = r.cartJson.resultCode)
            }
        } catch (e) {
        }
        var n = "tag_" + (new Date).getTime(),
            s = window.screen.width * window.devicePixelRatio + "_" + window.screen.height * window.devicePixelRatio + "_" + window.screen.colorDepth;
        jQuery.ajax({
            type: "POST",
            url: "/ware/clientInfoStat.json?step=2&rand=" + n,
            data: {
                statAddCartType: e,
                statRequestUrl: t,
                statResponseSid: o,
                statResponseResultCode: i,
                postTime: n,
                tag: s
            },
            success: function (e) {
            },
            error: function (e, t, a, o) {
            }
        })
    } catch (e) {
    }
}

function fqyJump(e) {
    try {
        var t = "" + (new Date).getTime();
        jQuery.ajax({
            type: "post",
            url: "/ware/queryCreditInfo.json?rand=" + t,
            dataType: "json",
            data: {},
            success: function (t) {
                $("#addCartLoading").length > 0 && $("#addCartLoading").val() && "true" == $("#addCartLoading").val() && $(".cart-loading-icon").css("display", "none");
                t && t.errorCode && "0" == t.errorCode ? judgeKO($("#currentWareId").val(), $("#sid").val(), e) : $.toast({
                    maxHeight: 100,
                    autoClose: !1,
                    message: "用户您好，分期用服务目前仅对京东白条有良好消费记录用户提供，请您首先开通白条服务。",
                    styleType: 4,
                    btns: {closeTxt: "我知道了"}
                })
            },
            error: function (e, t, a, o) {
                try {
                    $("#addCartLoading").length > 0 && $("#addCartLoading").val() && "true" == $("#addCartLoading").val() && $(".cart-loading-icon").css("display", "none")
                } catch (e) {
                }
                window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html"
            }
        })
    } catch (e) {
    }
}

function addDrugToCart() {
    try {
        var e = "" + (new Date).getTime();
        jQuery.ajax({
            type: "post",
            url: "/ware/addDrugToCart.json?rand=" + e,
            dataType: "json",
            data: {wareId: $("#currentWareId").val(), drugSkuNum: $("#number").val(), sid: $("#sid").val()},
            success: function (e) {
                try {
                    var t = new MPing.inputs.AddCart("MProductdetail_MedicineAdd", $("#currentWareId").val());
                    t.event_param = $("#currentWareId").val(), t.event_level = "5";
                    (new MPing).send(t)
                } catch (e) {
                }
                $("#addCartLoading").length > 0 && $("#addCartLoading").val() && "true" == $("#addCartLoading").val() && $(".cart-loading-icon").css("display", "none");
                var a = "加入药品清单失败，请稍后再试",
                    o = "error-icon",
                    i = 270;
                if (e && e.errorCode && "0" == e.errorCode && (o = "succee-icon", a = "加入药品清单成功", i = 180, e.num)) {
                    var r = e.num;
                    parseInt(r) > 0 && drugCartNumberShow(parseInt(r))
                }
                var n = {cls: o, duration: 2e3, message: a, width: i, height: 88};
                showMessage(n)
            },
            error: function (e, t, a, o) {
                try {
                    $("#addCartLoading").length > 0 && $("#addCartLoading").val() && "true" == $("#addCartLoading").val() && $(".cart-loading-icon").css("display", "none")
                } catch (e) {
                }
                window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html"
            }
        })
    } catch (e) {
        try {
            $("#addCartLoading").length > 0 && $("#addCartLoading").val() && "true" == $("#addCartLoading").val() && $(".cart-loading-icon").css("display", "none"), console.log(e);
            var t = {cls: "error-icon", duration: 2e3, message: "加入药品清单失败，请稍后再试", width: 270, height: 88};
            showMessage(t)
        } catch (e) {
        }
    }
}

function addJdEcardToCart() {
    try {
        var e = "" + (new Date).getTime();
        jQuery.ajax({
            type: "post",
            url: "/ware/addJdEcardToCart.json?rand=" + e,
            dataType: "json",
            data: {wareId: $("#currentWareId").val(), ecardNum: $("#number").val(), sid: $("#sid").val()},
            success: function (e) {
                try {
                    isSpecWindowOpen() ? pingClickWithLevel("MProductdetail_EcardSpecAddCart", "", "", $("#currentWareId").val(), "5") : pingClickWithLevel("MProductdetail_EcardAddCart", "", "", $("#currentWareId").val(), "5")
                } catch (e) {
                }
                $("#addCartLoading").length > 0 && $("#addCartLoading").val() && "true" == $("#addCartLoading").val() && $(".cart-loading-icon").css("display", "none");
                var t = "加入E卡清单失败，请稍后再试",
                    a = "error-icon",
                    o = 270;
                if (e && e.errorCode && "0" == e.errorCode) {
                    if (a = "succee-icon", t = "加入E卡清单成功", o = 180, e.num) {
                        var i = e.num;
                        parseInt(i) > 0 && jdECartNumberShow(parseInt(i))
                    }
                } else e && e.errorCode && "1" == e.errorCode && (t = e.errorMessage, o = 180);
                var r = {cls: a, duration: 2e3, message: t, width: o, height: 88};
                showMessage(r)
            },
            error: function (e, t, a, o) {
                try {
                    $("#addCartLoading").length > 0 && $("#addCartLoading").val() && "true" == $("#addCartLoading").val() && $(".cart-loading-icon").css("display", "none")
                } catch (e) {
                }
                window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html"
            }
        })
    } catch (e) {
        try {
            $("#addCartLoading").length > 0 && $("#addCartLoading").val() && "true" == $("#addCartLoading").val() && $(".cart-loading-icon").css("display", "none"), console.log(e);
            var t = {cls: "error-icon", duration: 2e3, message: "加入E卡清单失败，请稍后再试", width: 270, height: 88};
            showMessage(t)
        } catch (e) {
        }
    }
}

function jdECartNumberShow(e) {
    try {
        parseInt(e) > 99 ? $("#jdEcardCartNum").text("99+") : $("#jdEcardCartNum").text(e)
    } catch (e) {
    }
}

function setjdECartNum() {
    try {
        if ($("#pin").length > 0 && "login" == $("#pin").val()) {
            var e = "" + (new Date).getTime();
            jQuery.ajax({
                type: "post",
                dataType: "json",
                url: "/ware/getJdEcartNum.json?rand=" + e,
                data: {sid: $("#sid").val()},
                success: function (e) {
                    try {
                        e && e.num && parseInt(e.num) > 0 && jdECartNumberShow(e.num)
                    } catch (e) {
                        console.log(e)
                    }
                },
                error: function (e, t, a, o) {
                }
            })
        }
    } catch (e) {
    }
}

function drugCartNumberShow(e) {
    try {
        parseInt(e) > 99 ? $("#drugCartNum").text("99+") : $("#drugCartNum").text(e)
    } catch (e) {
    }
}

function setDrugCartNum() {
    try {
        if ($("#pin").length > 0 && "login" == $("#pin").val()) {
            var e = "" + (new Date).getTime();
            jQuery.ajax({
                type: "post",
                dataType: "json",
                url: "/ware/getDrugCartNum.json?rand=" + e,
                data: {sid: $("#sid").val()},
                success: function (e) {
                    try {
                        e && e.num && parseInt(e.num) > 0 && drugCartNumberShow(e.num)
                    } catch (e) {
                        console.log(e)
                    }
                },
                error: function (e, t, a, o) {
                }
            })
        }
    } catch (e) {
    }
}

function toDrugCart(e) {
    e && "" != e && ($("#pin").length > 0 && "login" == $("#pin").val() ? (pingClickWithLevel("MProductdetail_MedicineList", "", "", "", "3"), location.href = e) : location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html")
}

function toJdECart(e) {
    e && "" != e && ($("#pin").length > 0 && "login" == $("#pin").val() ? (pingClickWithLevel("MProductdetail_EcardCart", "", "", $("#currentWareId").val(), ""), location.href = e) : location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html")
}

function sendAddCartNodeEvent(e) {
    if (e)
        if (e.indexOf(";") >= 0) try {
            var t = e.split(";");
            if (t && t.length > 1) {
                var a = t[0],
                    o = "",
                    i = "",
                    r = "",
                    n = "";
                o = t[1] && "null" != t[1] ? t[1] : "", i = t.length > 2 && t[2] && "null" != t[2] ? t[2] : "", r = t.length > 3 && t[3] && "null" != t[3] ? t[3] : "", n = t.length > 4 && t[4] && "null" != t[4] ? t[4] : "", pingClickWithLevel(a, o, i, r, n)
            }
        } catch (e) {
        } else pingClickWithLevel(e, "", "", "", "5")
}

function isAddCartBizName(e) {
    if (notCallLvBizNames && e && notCallLvBizNames.length > 0)
        for (var t = 0; t < notCallLvBizNames.length; t++)
            if (e == notCallLvBizNames[t]) return !0;
    return !1
}

function tojdEcartPage(e, t) {
    if ($("#pin").length > 0 && "login" == $("#pin").val()) {
        try {
            isSpecWindowOpen() ? pingClickWithLevel("MProductdetail_EcardSpecBuy", "", "", $("#currentWareId").val(), "5") : pingClickWithLevel("MProductdetail_EcardBuy", "", "", $("#currentWareId").val(), "5")
        } catch (e) {
        }
        location.href = "https://giftcard.jd.com/giftcardpurchase/mIndex?skuNumInfo=" + e + "," + t
    } else location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html"
}

function bottom618() {
    "false" !== $("#bigSalePurchaseConfig").val() && ($("#purchaseTextWait").val() || $("#purchaseTextBegin").val()) ? ($("#js-bottom-618-prompt").show(), $(".hold-div-bottom").show()) : "false" !== $("#skinPurchaseConfig").val() && $("#skinPurchaseText").val() && ($("#js-bottom-618-prompt").show(), $(".hold-div-bottom").show())
}

function duliGetTimes(e) {
    var t, a, o, i, r;
    if (e >= 0) {
        var n = parseInt(e / 60);
        i = e % 60, o = n % 60, a = parseInt(n / 60 % 24), t = parseInt(n / 60 / 24), r = parseInt(t) > 0 ? t + "天" + a + "小时" + o + "分钟" : a + "小时" + o + "分钟" + i + "秒", $("#prompt_msg").text($("#koInfoDesc").val() + r), e > 0 ? setTimeout(function () {
            e--, duliGetTimes(e)
        }, 1e3) : window.location.reload()
    }
}

function changeSkuShowOrHideId(e) {
    var t = $("#changeSkuFlag").val(),
        a = $("#areaSkuId").val();
    e ? "3" == t ? ($("#looksimilar_specb").show(), $("#looksimilar_specb").attr("href", "/product/" + a + ".html"), $("#looksimilar_speca").hide()) : ($("#looksimilar_speca").show(), $("#looksimilar_specb").hide()) : $(".looksimilar_spec").hide()
}

function updateColorSizeSpec() {
    try {
        var wareId = document.getElementById("currentWareId").value,
            colorSizeSkuJson = document.getElementById("skuColorSizeSpec").value;
        if (colorSizeSkuJson) {
            var skuColorSize = eval("(" + colorSizeSkuJson + ")"),
                allColorSet = [],
                allSizeSet = [],
                allSpecSet = [];
            allColorSet = eval("(" + $("#allColorSet").val() + ")"), allSizeSet = eval("(" + $("#allSizeSet").val() + ")"), allSpecSet = eval("(" + $("#allSpecSet").val() + ")");
            var colorNode = document.getElementById("color"),
                sizeNode = document.getElementById("size"),
                specNode = document.getElementById("spec"),
                preColor = "";
            colorNode && colorNode.querySelector(".selected") && colorNode.querySelector(".selected").title && (preColor = colorNode.querySelector(".selected").title);
            var preSize = "";
            sizeNode && sizeNode.querySelector(".selected") && sizeNode.querySelector(".selected").title && (preSize = sizeNode.querySelector(".selected").title);
            var preSpec = "";
            specNode && specNode.querySelector(".selected") && specNode.querySelector(".selected").title && (preSpec = specNode.querySelector(".selected").title);
            var currentColor = preColor,
                currentSize = preSize,
                currentSpec = preSpec,
                colorList = [],
                sizeList = [],
                specList = [],
                attributes = [];
            if (colorNode && attributes.push("color"), sizeNode && attributes.push("size"), specNode && attributes.push("spec"), event.target && event.target.parentNode && event.target.parentNode.id) {
                if (event.target.parentNode && event.target.parentNode.id && "color" == event.target.parentNode.id)
                    if (colorNode && colorNode.querySelector(".selected") && (colorNode.querySelector(".selected").className = "a-item J_ping"), event.target.className = "a-item selected J_ping", (currentColor = event.target.title || "") == preColor) {
                        if ("" == preSize && "" == preSpec) colorNode.innerHTML = generateNewColorSizeSpecHtml(allColorSet, allColorSet, ""), sizeNode && (sizeNode.innerHTML = generateNewColorSizeSpecHtml(allSizeSet, allSizeSet, "")), specNode && (specNode.innerHTML = generateNewColorSizeSpecHtml(allSpecSet, allSpecSet, ""));
                        else if ("" != preSize && "" != preSpec) {
                            for (var index = 0; index < skuColorSize.colorSize.length; index++) {
                                var tempColorSize = skuColorSize.colorSize[index];
                                tempColorSize.size == preSize && tempColorSize.spec == preSpec && colorList.indexOf(tempColorSize.color) < 0 && colorList.push(tempColorSize.color)
                            }
                            colorNode.innerHTML = generateNewColorSizeSpecHtml(allColorSet, colorList, ""), sizeNode && (sizeNode.innerHTML = generateNewColorSizeSpecHtml(allSizeSet, allSizeSet, preSize)), specNode && (specNode.innerHTML = generateNewColorSizeSpecHtml(allSpecSet, allSpecSet, preSpec))
                        } else if ("" != preSize) {
                            for (var index = 0; index < skuColorSize.colorSize.length; index++) {
                                var tempColorSize = skuColorSize.colorSize[index];
                                tempColorSize.size == preSize && (colorList.indexOf(tempColorSize.color) < 0 && colorList.push(tempColorSize.color), tempColorSize.spec && specList.indexOf(tempColorSize.spec) < 0 && specList.push(tempColorSize.spec))
                            }
                            colorNode.innerHTML = generateNewColorSizeSpecHtml(allColorSet, colorList, ""), sizeNode && (sizeNode.innerHTML = generateNewColorSizeSpecHtml(allSizeSet, allSizeSet, preSize)), specNode && (specNode.innerHTML = generateNewColorSizeSpecHtml(allSpecSet, specList, ""))
                        } else if ("" != preSpec) {
                            for (var index = 0; index < skuColorSize.colorSize.length; index++) {
                                var tempColorSize = skuColorSize.colorSize[index];
                                tempColorSize.spec == preSpec && (colorList.indexOf(tempColorSize.color) < 0 && colorList.push(tempColorSize.color), tempColorSize.size && sizeList.indexOf(tempColorSize.size) < 0 && sizeList.push(tempColorSize.size))
                            }
                            colorNode.innerHTML = generateNewColorSizeSpecHtml(allColorSet, colorList, ""), sizeNode && (sizeNode.innerHTML = generateNewColorSizeSpecHtml(allSizeSet, sizeList, "")), specNode && (specNode.innerHTML = generateNewColorSizeSpecHtml(allSpecSet, allSpecSet, preSpec))
                        }
                    } else {
                        var skuId = findSkuId(skuColorSize.colorSize, attributes, currentColor, currentSize, currentSpec);
                        if ("" != skuId) refreshSpecInfoBySkuId(skuId);
                        else {
                            for (var sizeFlag = !1, specFlag = !1, i = 0; i < skuColorSize.colorSize.length; i++) colorSize = skuColorSize.colorSize[i], colorList.indexOf(colorSize.color) < 0 && colorList.push(colorSize.color), colorSize.color == currentColor && (currentSize == colorSize.size && (specFlag || (sizeFlag = !0)), currentSpec == colorSize.spec && (sizeFlag || (specFlag = !0)), sizeList.indexOf(colorSize.size) < 0 && sizeList.push(colorSize.size), specList.indexOf(colorSize.spec) < 0 && specList.push(colorSize.spec));
                            if (sizeFlag) {
                                specList = [], currentSpec = "";
                                for (var j = 0; j < skuColorSize.colorSize.length; j++) colorSize = skuColorSize.colorSize[j], colorSize.color == currentColor && colorSize.size == currentSize && specList.indexOf(colorSize.spec) < 0 && specList.push(colorSize.spec)
                            } else if (specFlag) {
                                sizeList = [], currentSize = "";
                                for (var j = 0; j < skuColorSize.colorSize.length; j++) colorSize = skuColorSize.colorSize[j], colorSize.color == currentColor && colorSize.spec == currentSpec && sizeList.indexOf(colorSize.size) < 0 && sizeList.push(colorSize.size)
                            } else currentSize = "", currentSpec = "";
                            specNode && (specNode.innerHTML = generateNewColorSizeSpecHtml(allSpecSet, specList, currentSpec)), colorNode && (colorNode.innerHTML = generateNewColorSizeSpecHtml(allColorSet, colorList, currentColor)), sizeNode && (sizeNode.innerHTML = generateNewColorSizeSpecHtml(allSizeSet, sizeList, currentSize))
                        }
                    }
                if (event.target.parentNode && event.target.parentNode.id && "size" == event.target.parentNode.id)
                    if (sizeNode && sizeNode.querySelector(".selected") && (sizeNode.querySelector(".selected").className = "a-item J_ping"), event.target.className = "a-item selected J_ping", (currentSize = event.target.title || "") == preSize) {
                        if ("" == preColor && "" == preSpec) sizeNode.innerHTML = generateNewColorSizeSpecHtml(allSizeSet, allSizeSet, ""), colorNode && (colorNode.innerHTML = generateNewColorSizeSpecHtml(allColorSet, allColorSet, "")), specNode && (specNode.innerHTML = generateNewColorSizeSpecHtml(allSpecSet, allSpecSet, ""));
                        else if ("" != preColor && "" != preSpec) {
                            for (var index = 0; index < skuColorSize.colorSize.length; index++) {
                                var tempColorSize = skuColorSize.colorSize[index];
                                tempColorSize.color == preColor && tempColorSize.spec == preSpec && sizeList.indexOf(tempColorSize.size) < 0 && sizeList.push(tempColorSize.size)
                            }
                            sizeNode.innerHTML = generateNewColorSizeSpecHtml(allSizeSet, sizeList, ""), colorNode && (colorNode.innerHTML = generateNewColorSizeSpecHtml(allColorSet, allColorSet, preColor)), specNode && (specNode.innerHTML = generateNewColorSizeSpecHtml(allSpecSet, allSpecSet, preSpec))
                        } else if ("" != preColor) {
                            for (var index = 0; index < skuColorSize.colorSize.length; index++) {
                                var tempColorSize = skuColorSize.colorSize[index];
                                tempColorSize.color == preColor && (sizeList.indexOf(tempColorSize.size) < 0 && sizeList.push(tempColorSize.size), tempColorSize.spec && specList.indexOf(tempColorSize.spec) < 0 && specList.push(tempColorSize.spec))
                            }
                            sizeNode.innerHTML = generateNewColorSizeSpecHtml(allSizeSet, sizeList, ""), specNode && (specNode.innerHTML = generateNewColorSizeSpecHtml(allSpecSet, specList, "")), colorNode && (colorNode.innerHTML = generateNewColorSizeSpecHtml(allColorSet, allColorSet, preColor))
                        } else if ("" != preSpec) {
                            for (var index = 0; index < skuColorSize.colorSize.length; index++) {
                                var tempColorSize = skuColorSize.colorSize[index];
                                tempColorSize.spec == preSpec && (sizeList.indexOf(tempColorSize.size) < 0 && sizeList.push(tempColorSize.size), tempColorSize.color && colorList.indexOf(tempColorSize.color) < 0 && colorList.push(tempColorSize.color))
                            }
                            sizeNode.innerHTML = generateNewColorSizeSpecHtml(allSizeSet, sizeList, ""), colorNode && (colorNode.innerHTML = generateNewColorSizeSpecHtml(allColorSet, colorList, "")), specNode && (specNode.innerHTML = generateNewColorSizeSpecHtml(allSpecSet, allSpecSet, preSpec))
                        }
                    } else {
                        var skuId = findSkuId(skuColorSize.colorSize, attributes, currentColor, currentSize, currentSpec);
                        if ("" != skuId) refreshSpecInfoBySkuId(skuId);
                        else {
                            for (var colorFlag = !1, specFlag = !1, i = 0; i < skuColorSize.colorSize.length; i++) colorSize = skuColorSize.colorSize[i], sizeList.indexOf(colorSize.size) < 0 && sizeList.push(colorSize.size), colorSize.size == currentSize && (currentColor == colorSize.color && (specFlag || (colorFlag = !0)), currentSpec == colorSize.spec && (colorFlag || (specFlag = !0)), colorList.indexOf(colorSize.color) < 0 && colorList.push(colorSize.color), specList.indexOf(colorSize.spec) < 0 && specList.push(colorSize.spec));
                            if (colorFlag) {
                                specList = [], currentSpec = "";
                                for (var j = 0; j < skuColorSize.colorSize.length; j++) colorSize = skuColorSize.colorSize[j], colorSize.color == currentColor && colorSize.size == currentSize && specList.indexOf(colorSize.spec) < 0 && specList.push(colorSize.spec)
                            } else if (specFlag) {
                                colorList = [], currentColor = "";
                                for (var j = 0; j < skuColorSize.colorSize.length; j++) colorSize = skuColorSize.colorSize[j], colorSize.size == currentSize && colorSize.spec == currentSpec && colorList.indexOf(colorSize.color) < 0 && colorList.push(colorSize.color)
                            } else currentColor = "", currentSpec = "";
                            specNode && (specNode.innerHTML = generateNewColorSizeSpecHtml(allSpecSet, specList, currentSpec)), colorNode && (colorNode.innerHTML = generateNewColorSizeSpecHtml(allColorSet, colorList, currentColor)), sizeNode && (sizeNode.innerHTML = generateNewColorSizeSpecHtml(allSizeSet, sizeList, currentSize))
                        }
                    }
                if (event.target.parentNode && event.target.parentNode.id && "spec" == event.target.parentNode.id)
                    if (specNode && specNode.querySelector(".selected") && (specNode.querySelector(".selected").className = "a-item J_ping"), event.target.className = "a-item selected J_ping", (currentSpec = event.target.title || "") == preSpec) {
                        if ("" == preColor && "" == preSize) specNode.innerHTML = generateNewColorSizeSpecHtml(allSpecSet, allSpecSet, ""), colorNode && (colorNode.innerHTML = generateNewColorSizeSpecHtml(allColorSet, allColorSet, "")), sizeNode && (sizeNode.innerHTML = generateNewColorSizeSpecHtml(allSizeSet, allSizeSet, ""));
                        else if ("" != preColor && "" != preSize) {
                            for (var index = 0; index < skuColorSize.colorSize.length; index++) {
                                var tempColorSize = skuColorSize.colorSize[index];
                                tempColorSize.color == preColor && tempColorSize.size == preSize && specList.indexOf(tempColorSize.spec) < 0 && specList.push(tempColorSize.spec)
                            }
                            specNode.innerHTML = generateNewColorSizeSpecHtml(allSpecSet, specList, ""), colorNode && (colorNode.innerHTML = generateNewColorSizeSpecHtml(allColorSet, allColorSet, preColor)), sizeNode && (sizeNode.innerHTML = generateNewColorSizeSpecHtml(allSizeSet, allSizeSet, preSize))
                        } else if ("" != preColor) {
                            for (var index = 0; index < skuColorSize.colorSize.length; index++) {
                                var tempColorSize = skuColorSize.colorSize[index];
                                tempColorSize.color == preColor && (sizeList.indexOf(tempColorSize.size) < 0 && sizeList.push(tempColorSize.size), tempColorSize.spec && specList.indexOf(tempColorSize.spec) < 0 && specList.push(tempColorSize.spec))
                            }
                            specNode.innerHTML = generateNewColorSizeSpecHtml(allSpecSet, specList, ""), sizeNode && (sizeNode.innerHTML = generateNewColorSizeSpecHtml(allSizeSet, sizeList, "")), colorNode && (colorNode.innerHTML = generateNewColorSizeSpecHtml(allColorSet, allColorSet, preColor))
                        } else if ("" != preSize) {
                            for (var index = 0; index < skuColorSize.colorSize.length; index++) {
                                var tempColorSize = skuColorSize.colorSize[index];
                                tempColorSize.size == preSize && (specList.indexOf(tempColorSize.spec) < 0 && specList.push(tempColorSize.spec), tempColorSize.color && colorList.indexOf(tempColorSize.color) < 0 && colorList.push(tempColorSize.color))
                            }
                            specNode.innerHTML = generateNewColorSizeSpecHtml(allSpecSet, specList, ""), colorNode && (colorNode.innerHTML = generateNewColorSizeSpecHtml(allColorSet, colorList, "")), sizeNode && (sizeNode.innerHTML = generateNewColorSizeSpecHtml(allSizeSet, allSizeSet, preSize))
                        }
                    } else {
                        var skuId = findSkuId(skuColorSize.colorSize, attributes, currentColor, currentSize, currentSpec);
                        if ("" != skuId) refreshSpecInfoBySkuId(skuId);
                        else {
                            for (var colorFlag = !1, sizeFlag = !1, i = 0; i < skuColorSize.colorSize.length; i++) colorSize = skuColorSize.colorSize[i], specList.indexOf(colorSize.spec) < 0 && specList.push(colorSize.spec), colorSize.spec == currentSpec && (currentColor == colorSize.color && (sizeFlag || (colorFlag = !0)), currentSize == colorSize.size && (colorFlag || (sizeFlag = !0)), colorList.indexOf(colorSize.color) < 0 && colorList.push(colorSize.color), sizeList.indexOf(colorSize.size) < 0 && sizeList.push(colorSize.size));
                            if (colorFlag) {
                                sizeList = [], currentSize = "";
                                for (var j = 0; j < skuColorSize.colorSize.length; j++) colorSize = skuColorSize.colorSize[j], colorSize.color == currentColor && colorSize.spec == currentSpec && sizeList.indexOf(colorSize.size) < 0 && sizeList.push(colorSize.size)
                            } else if (sizeFlag) {
                                colorList = [], currentColor = "";
                                for (var j = 0; j < skuColorSize.colorSize.length; j++) colorSize = skuColorSize.colorSize[j], colorSize.size == currentSize && colorSize.spec == currentSpec && colorList.indexOf(colorSize.color) < 0 && colorList.push(colorSize.color)
                            } else currentColor = "", currentSize = "";
                            specNode && (specNode.innerHTML = generateNewColorSizeSpecHtml(allSpecSet, specList, currentSpec)), colorNode && (colorNode.innerHTML = generateNewColorSizeSpecHtml(allColorSet, colorList, currentColor)), sizeNode && (sizeNode.innerHTML = generateNewColorSizeSpecHtml(allSizeSet, sizeList, currentSize))
                        }
                    }
            }
        }
    } catch (e) {
    }
}

function refreshSpecInfoBySkuId(e) {
    if (e)
        if ($("#currentWareId").val(e), $("#newColorSizeInfo").length > 0 && $("#newColorSizeInfo").val()) currentColorSizeSpec && "" != currentColorSizeSpec && (currentColorSizeSpec += '<span class="amount">' + $("#number").val() + "件</span>", document.getElementById("specDetailInfo_spec") && $("#specDetailInfo_spec").html(currentColorSizeSpec), currentColorSizeSpec = "");
        else {
            var t = document.getElementById("color"),
                a = document.getElementById("size"),
                o = document.getElementById("spec"),
                i = "";
            t && t.querySelector(".selected") && t.querySelector(".selected").title && (i = t.querySelector(".selected").title + " ");
            var r = "";
            a && a.querySelector(".selected") && a.querySelector(".selected").title && (r = a.querySelector(".selected").title + " ");
            var n = "";
            o && o.querySelector(".selected") && o.querySelector(".selected").title && (n = o.querySelector(".selected").title + " ");
            var s = i + r + n;
            s += '<span class="amount">' + $("#number").val() + "件</span>", document.getElementById("specDetailInfo_spec") && $("#specDetailInfo_spec").html(s)
        }
    jQuery.ajax({
        url: "/ware/getSpecInfo.json",
        data: {sid: $("#sid").val(), wareId: e, yanbaoIds: $("#ybId").val()},
        dataType: "json",
        success: function (e) {
            try {
                e && e.commonConfigJson && (commonConfigJson = e.commonConfigJson), initParam(), updateHiddenValues(), updateNewWareSpecInfo(e), updateSpecBottomButton()
            } catch (e) {
                return
            }
        },
        error: function (e) {
        }
    })
}

function updateSpecBottomButton() {
    try {
        isYuyue ? (showGeneralButtons(!1), showYushouButtons(!1), showYuyueButtons(!0)) : isYushou ? (showGeneralButtons(!1), showYuyueButtons(!1), showYushouButtons(!0)) : (showYushouButtons(!1), showYuyueButtons(!1), showGeneralButtons(!0))
    } catch (e) {
    }
}

function updateNewWareSpecInfo(e) {
    e && e.wareWeight ? ($("#specWeightDiv").css("display", "block"), $("#spec_weight").html(e.wareWeight)) : $("#specWeightDiv").css("display", "none"), e && e.warePrice ? $("#spec_price").html(e.warePrice) : $("#spec_price").html("暂无报价"), e && e.plusPrice ? ($("#specPlus").css("display", "block"), $("#specJdPri").css("display", "none"), $("#specPlusPrice").html(e.plusPrice), $("#specJdPrice").html(e.warePrice)) : e && ($("#specPlus").css("display", "none"), $("#specJdPri").css("display", "block"), $("#spec_price").html(e.warePrice)), e && e.wareMainImageUrl && $("#spec_image").attr("src", e.wareMainImageUrl), $("#ybId").val(""), jdM.sessionstorage.set("ybId", ""), jdM.sessionstorage.set("ybSku", $("#currentWareId").val()), $("#warranty-seled-list").html("");
    if (e && e.newYanBaoInfo) {
        $("#warranty-seled-list").append('<div class="base-txt warranty-text choose-tip"><i class="warranty-icon"></i>可选延保</div>');
        var t = '{"yanBaoInfo":' + e.newYanBaoInfo + "}";
        $("#ybId").val(""), "string" == typeof t && (t = JSON.parse(t));
        for (var a = "", o = 0; o < t.yanBaoInfo.length; o++) {
            var i = t.yanBaoInfo[o];
            a += '<div class="warranty-items">', a += '\t<div class="warranty-items-wrap">', a += '\t\t<img class="warranty-items-img" src="' + i.products[0].imgurl + '"><span class="warranty-items-title">' + i.sortName + "</span>", e.yanbaoServiceInfoUrl && "null" != e.yanbaoServiceInfoUrl && (a += '\t\t<a class="warranty-des-href" href="javascript:void(0);" data-href="' + e.yanbaoServiceInfoUrl + '">', a += '\t\t\t<span class="warranty-des">服务介绍</span>', a += '\t\t\t<span class="warranty-des-icon"></span>', a += "\t\t</a>", $("#warrantyDesHref").val(e.yanbaoServiceInfoUrl)), a += "\t</div>", a += '\t<div class="warranty-btn-wrap" data-selFlag="0" data-type="' + i.sortName + '">', a += '\t\t<div class="warranty-btn-row">';
            for (var r = 0; r < i.products.length; r++) {
                var n = i.products[r];
                r % 2 == 1 ? (a += '\t\t\t<a class="warranty-btn J_ping" data="' + n.platformPid + '" report-eventid="MProductdetail_SpecificationInsurance">', a += '\t\t\t\t<span class="war-btn-text">' + n.sortName + '</span><span class="war-btn-price">&yen;' + n.price + "</span>", a += "\t\t\t</a>", a += '\t\t\t</div><div class="warranty-btn-row">') : (a += '\t\t\t<a class="warranty-btn J_ping" data="' + n.platformPid + '" report-eventid="MProductdetail_SpecificationInsurance">', a += '\t\t\t\t<span class="war-btn-text">' + n.sortName + '</span><span class="war-btn-price">&yen;' + n.price + "</span>", a += "\t\t\t</a>")
            }
            a += "\t\t</div>", a += "\t</div>", a += "</div>"
        }
        t.yanBaoInfo.length > 0 ? (isHasWarrantyCheck = "true", $(".warranty-wrap").css("display", "block"), $("#spec_yanbaoItems").html(a), warDesClickFn(),
            serviceAndExtendWarranty(!1)) : isHasWarrantyCheck = "false"
    } else isHasWarrantyCheck = "false", $(".warranty-wrap").css("display", "none"), $("#spec_yanbaoItems").html("");
    $("#number").val("1"), isFqyProduct ? $("#addCartNum").css("display", "none") : $("#addCartNum").css("display", "block"), modify()
}

function updateHiddenValues() {
    commonConfig && (commonConfig.type ? $("#type").val(commonConfig.type) : $("#type").val("-1"), commonConfig.cartFlag ? ($("#stockFlag").length > 0 && $("#stockFlag").val(commonConfig.cartFlag), $("#cartFlag").val(commonConfig.cartFlag)) : $("#cartFlag").val("false"), commonConfig.isYuyue ? ($("#isYuYue").val(commonConfig.isYuyue), commonConfig.yuyueType ? $("#yuyueType").val(commonConfig.yuyueType) : $("#yuyueType").val("-1")) : ($("#isYuYue").val("false"), $("#yuyueType").val("-1")), commonConfig.isBuyCode ? $("#isBuyCode").val(commonConfig.isBuyCode) : $("#isBuyCode").val("false"), commonConfig.stockNotice ? $("#stockNotice").val(commonConfig.stockNotice) : $("#stockNotice").val("false"), commonConfig.addCartText ? $("#addCartText").val(commonConfig.addCartText) : $("#addCartText").val(""), $("#areaSkuId").val(commonConfig.areaSkuId), $("#changeSkuFlag").val(commonConfig.changeSkuFlag), $("#areaReasonTips").val(commonConfig.areaReasonTips), $("#areaToast").val(commonConfig.areaToast))
}

function showGeneralButtons(e) {
    e ? initCurrentGeneralButtons() : ($("#add_cart_spec").hide(), $("#directorder_spec").hide())
}

function initCurrentGeneralButtons() {
    var e = !1,
        t = "加入购物车",
        a = document.getElementById("isPopupsCheck").value,
        o = document.getElementById("isHaveSpec").value,
        i = document.getElementById("directorderBtm");
    if (("1" == $("#type").val() || "true" == $("#isBuyCode").val() || "1" == isXnzt || "true" == isFreshCard || "true" == isJdOtc || "true" == isHk || isSamSku || isOilCard || isCustomize || isGameCharge || isPrescribedDrug || hasAddCartNode || isJdEcard || "true" == isSoldOversea) && (e = !0, "1" == $("#type").val() ? t = "立即抢购" : "true" == $("#isBuyCode").val() ? t = "必购码购买" : isSamCard ? t = "" != $("#addCartText").val() ? $("#addCartText").val() : "立即购买" : isOilCard ? t = "" != $("#addCartText").val() ? $("#addCartText").val() : "立即充值" : isCustomize ? t = "" != $("#addCartText").val() ? $("#addCartText").val() : "去定制" : isPrescribedDrug ? t = "加入药品清单" : isJdEcard ? (e = !1, t = "加E卡清单") : isGameCharge ? t = "立即购买" : "true" == isFreshCard ? t = "立即购买" : hasAddCartNode && (t = "" != $("#addCartText").val() ? $("#addCartText").val() : "立即购买")), "true" == $("#cartFlag").val()) changeSkuShowOrHideId(!1), $("#arrivalInform_spec").hide(), e ? ($("#add_cart_spec").html(t), $("#add_cart_spec").show(), $("#directorder_spec").hide(), $("#add_cart_spec").unbind("click"), $("#add_cart_spec").bind("click", addWareToCart), $("#add_cart_spec").hasClass("disabled") && $("#add_cart_spec").removeClass("disabled"), $("#add_cart_spec").hasClass("yellow-color") && $("#add_cart_spec").removeClass("yellow-color"), $("#add_cart_spec").hasClass("red-color") || $("#add_cart_spec").addClass("red-color"), isSamCard && isSamMember && ($("#add_cart_spec").addClass("disabled"), $("#add_cart_spec").unbind("click"))) : ($("#add_cart_spec").html(t), $("#directorder_spec").html("立即购买"), $("#add_cart_spec").show(), $("#directorder_spec").show(), $("#add_cart_spec").unbind("click"), $("#add_cart_spec").bind("click", addWareToCart), $("#directorder_spec").unbind("click"), $("#directorder_spec").bind("click", addWareToCartAndNoJump), $("#add_cart_spec").hasClass("disabled") && $("#add_cart_spec").removeClass("disabled"), $("#add_cart_spec").hasClass("red-color") && $("#add_cart_spec").removeClass("red-color"), $("#add_cart_spec").hasClass("yellow-color") || $("#add_cart_spec").addClass("yellow-color"), $("#ybId").val() && "" != $("#ybId").val() ? ($("#directorder_spec").removeClass("disabled"), $("#directorder_spec").addClass("disabled"), $("#directorder_spec").unbind("click")) : ($(".directorder").removeClass("disabled"), directorder(a, i, o)));
    else {
        e ? $("#add_cart_spec").html(t) : ($("#add_cart_spec").html(t), $("#directorder_spec").html("立即购买"));
        var r = !1;
        ("true" == isJdOtc || "true" == isHk || isSamCard || isCustomize || isPrescribedDrug || hasAddCartNode && buttonDisabledWhenNoStock) && (r = !0), r ? ($("#add_cart_spec").addClass("disabled"), $("#add_cart_spec").unbind("click"), $("#directorder_spec").hide()) : ($("#add_cart_spec").hide(), $("#directorder_spec").hide(), changeSkuShowOrHideId(!0), "false" == $("#stockNotice").val() ? ($("#arrivalInform_spec").hide(), $(".looksimilar_spec").hasClass("yellow-color") && $(".looksimilar_spec").removeClass("yellow-color"), $(".looksimilar_spec").hasClass("red-color") || $(".looksimilar_spec").addClass("red-color")) : ($("#arrivalInform_spec").show(), $(".looksimilar_spec").hasClass("red-color") && $(".looksimilar_spec").removeClass("red-color"), $(".looksimilar_spec").hasClass("yellow-color") || $(".looksimilar_spec").addClass("yellow-color")))
    }
}

function showYushouButtons(e) {
    e ? "true" == $("#cartFlag").val() ? ($("#yushou_add_cart_spec").show(), $("#yushou_add_cart_spec").hasClass("disabled") && $("#yushou_add_cart_spec").removeClass("disabled"), changeSkuShowOrHideId(!1), $("#arrivalInform_spec").hide()) : ($("#yushou_add_cart_spec").hide(), changeSkuShowOrHideId(!0), "false" == $("#stockNotice").val() ? ($("#arrivalInform_spec").hide(), $(".looksimilar_spec").hasClass("yellow-color") && $(".looksimilar_spec").removeClass("yellow-color"), $(".looksimilar_spec").hasClass("red-color") || $(".looksimilar_spec").addClass("red-color")) : ($("#arrivalInform_spec").show(), $(".looksimilar_spec").hasClass("red-color") && $(".looksimilar_spec").removeClass("red-color"), $(".looksimilar_spec").hasClass("yellow-color") || $(".looksimilar_spec").addClass("yellow-color"))) : $("#yushou_add_cart_spec").hide()
}

function showYuyueButtons(e) {
    if (e) {
        if (changeSkuShowOrHideId(!1), $("#arrivalInform_spec").hide(), "true" == $("#isYuYue").val()) switch ($("#yuyueType").val()) {
            case "1":
                $("#waitingForAppointments_spec").length > 0 && ($("#waitingForAppointments_spec").show(), $("#makeAppointments_spec").length > 0 && $("#makeAppointments_spec").hide(), $("#waitingForBuying_spec").length > 0 && $("#waitingForBuying_spec").hide(), $("#buyImmediately_spec").length > 0 && $("#buyImmediately_spec").hide(), $("#appointmentsEnd_spec").length > 0 && $("#appointmentsEnd_spec").hide());
                break;
            case "2":
                $("#makeAppointments_spec").length > 0 && ($("#makeAppointments_spec").show(), $("#makeAppointments_spec").unbind("click"), $("#makeAppointments_spec").bind("click", function () {
                    pingClickWithLevel("MProductdetail_SubscribeImmediately", "W", "", $("#currentWareId").val(), "5"), makeAppointment()
                }), $("#waitingForAppointments_spec").length > 0 && $("#waitingForAppointments_spec").hide(), $("#waitingForBuying_spec").length > 0 && $("#waitingForBuying_spec").hide(), $("#buyImmediately_spec").length > 0 && $("#buyImmediately_spec").hide(), $("#appointmentsEnd_spec").length > 0 && $("#appointmentsEnd_spec").hide());
                break;
            case "3":
                $("#waitingForBuying_spec").length > 0 && ($("#waitingForBuying_spec").show(), $("#waitingForAppointments_spec").length > 0 && $("#waitingForAppointments_spec").hide(), $("#makeAppointments_spec").length > 0 && $("#makeAppointments_spec").hide(), $("#buyImmediately_spec").length > 0 && $("#buyImmediately_spec").hide(), $("#appointmentsEnd_spec").length > 0 && $("#appointmentsEnd_spec").hide());
                break;
            case "4":
                $("#buyImmediately_spec").length > 0 && ($("#buyImmediately_spec").show(), "true" == $("#cartFlag").val() ? ($("#buyImmediately_spec").unbind("click"), $("#buyImmediately_spec").bind("click", function () {
                    $("#buyImmediately_spec").hasClass("disabled") || buyImmediatelyClickFunction()
                })) : ($("#buyImmediately_spec").addClass("disabled"), $("#buyImmediately_spec").unbind("click")), $("#waitingForAppointments_spec").length > 0 && $("#waitingForAppointments_spec").hide(), $("#makeAppointments_spec").length > 0 && $("#makeAppointments_spec").hide(), $("#waitingForBuying_spec").length > 0 && $("#waitingForBuying_spec").hide(), $("#appointmentsEnd_spec").length > 0 && $("#appointmentsEnd_spec").hide());
                break;
            case "5":
                $("#appointmentsEnd_spec").length > 0 && ($("#appointmentsEnd_spec").show(), $("#waitingForAppointments_spec").length > 0 && $("#waitingForAppointments_spec").hide(), $("#makeAppointments_spec").length > 0 && $("#makeAppointments_spec").hide(), $("#waitingForBuying_spec").length > 0 && $("#waitingForBuying_spec").hide(), $("#buyImmediately_spec").length > 0 && $("#buyImmediately_spec").hide())
        }
    } else $("#waitingForAppointments_spec").length > 0 && $("#waitingForAppointments_spec").hide(), $("#makeAppointments_spec").length > 0 && $("#makeAppointments_spec").hide(), $("#waitingForBuying_spec").length > 0 && $("#waitingForBuying_spec").hide(), $("#buyImmediately_spec").length > 0 && $("#buyImmediately_spec").hide(), $("#appointmentsEnd_spec").length > 0 && $("#appointmentsEnd_spec").hide()
}

function findSkuId(e, t, a, o, i) {
    for (var r = ["color", "size", "spec"], n = getInsertSection(r, t), s = 0; s < e.length; s++) {
        var l = e[s],
            c = 0;
        if (n.indexOf("color") > -1 && l.color == a && c++, n.indexOf("size") > -1 && l.size == o && c++, n.indexOf("spec") > -1 && l.spec == i && c++, c == n.length) return l.skuId
    }
    return ""
}

function getInsertSection(e, t) {
    var a = [];
    if (e && t && e.length > 0 && t.length > 0) {
        if (!(e.length >= t.length)) return getInsertSection(t, e);
        for (var o = [], i = 0; i < e.length; i++) o[e[i]] = 1;
        for (var i = 0; i < t.length; i++) void 0 !== o[t[i]] && a.push(t[i])
    }
    return a
}

function findSkuIdOfColorSizeSpec(e, t, a, o) {
    if ("" != t && "" != a && "" != o)
        for (var i = 0; i < e.length; i++) {
            var r = e[i];
            if (r.color == t && r.size == a && r.spec == o) return r.skuId
        } else if ("" != t && "" != a)
        for (var i = 0; i < e.length; i++) {
            var r = e[i];
            if (r.color == t && r.size == a) return r.skuId
        } else if ("" != t && "" != o)
        for (var i = 0; i < e.length; i++) {
            var r = e[i];
            if (r.color == t && r.spec == o) return r.skuId
        } else if ("" != a && "" != o)
        for (var i = 0; i < e.length; i++) {
            var r = e[i];
            if (r.size == a && r.spec == o) return r.skuId
        } else if ("" != t)
        for (var i = 0; i < e.length; i++) {
            var r = e[i];
            if (r.color == t) return r.skuId
        } else if ("" != a)
        for (var i = 0; i < e.length; i++) {
            var r = e[i];
            if (r.size == a) return r.skuId
        } else if ("" != o)
        for (var i = 0; i < e.length; i++) {
            var r = e[i];
            if (r.spec == o) return r.skuId
        }
    return ""
}

function generateColorSizeSpecHtml(e, t) {
    var a = "";
    try {
        for (var o = (document.getElementById("currentWareId").value, 0); o < e.length; o++) {
            var i = e[o];
            a += '<a title="' + i + '"', a += i == t ? ' class="a-item selected J_ping"' : ' class="a-item J_ping" onclick="updateColorSizeSpec()"', a += ' report-eventid="MProductdetail_SpecificationSpec"  report-eventparam="' + i + '" href="javascript:void(0);">' + i + "</a>"
        }
    } catch (e) {
    }
    return a
}

function generateNewColorSizeSpecHtml(e, t, a) {
    var o = "";
    try {
        document.getElementById("currentWareId").value;
        if (e && t && e.length >= t.length)
            for (var i = 0; i < e.length; i++) {
                var r = e[i];
                o += '<a title="' + r + '"', r == a ? o += ' class="a-item selected J_ping" onclick="updateColorSizeSpec()"' : t.indexOf(r) > -1 ? o += ' class="a-item J_ping" onclick="updateColorSizeSpec()"' : o += ' class="a-item no-goods J_ping" onclick="updateColorSizeSpec()"', o += ' report-eventid="MProductdetail_SpecificationSpec"  report-eventparam="' + r + '" href="javascript:void(0);">' + r + "</a>"
            }
    } catch (e) {
    }
    return o
}

function colorSizeSpecValidate() {
    try {
        var delimiter = "和",
            tipArray = [];
        if ($("#newColorSizeInfo").length > 0 && $("#newColorSizeInfo").val())
            for (var newColorSizeInfo = eval("(" + $("#newColorSizeInfo").val() + ")"), list = newColorSizeInfo.colorSize, j = 0; j < list.length; j++) {
                var pIdIndex = j + 1,
                    tempNewColorSize = list[j],
                    selectedButton = $("#p-new-spec-" + pIdIndex).children(".selected"),
                    selectedButtonIndex = -1;
                0 == selectedButton.length && tipArray.push(tempNewColorSize.title)
            } else {
            var colorSizeSkuJson = document.getElementById("skuColorSizeSpec").value,
                colorTitleName = "",
                sizeTitleName = "",
                specTitleName = "";
            if (!colorSizeSkuJson) return !0;
            var skuColorSize = eval("(" + colorSizeSkuJson + ")");
            skuColorSize && skuColorSize.colorSizeTitle && (skuColorSize.colorSizeTitle.colorName && "*" != skuColorSize.colorSizeTitle.colorName && (colorTitleName = skuColorSize.colorSizeTitle.colorName), skuColorSize.colorSizeTitle.sizeName && "*" != skuColorSize.colorSizeTitle.sizeName && (sizeTitleName = skuColorSize.colorSizeTitle.sizeName), skuColorSize.colorSizeTitle.specName && "*" != skuColorSize.colorSizeTitle.specName && (specTitleName = skuColorSize.colorSizeTitle.specName));
            var colorNode = document.getElementById("color"),
                sizeNode = document.getElementById("size"),
                specNode = document.getElementById("spec");
            colorNode && "" != colorTitleName && (colorNode.querySelector(".selected") || tipArray.push('"' + colorTitleName + '"')), sizeNode && "" != sizeTitleName && (sizeNode.querySelector(".selected") || tipArray.push('"' + sizeTitleName + '"')), specNode && "" != specTitleName && (specNode.querySelector(".selected") || tipArray.push('"' + specTitleName + '"'))
        }
        if (tipArray && tipArray.length > 0) {
            for (var spectext = "请选择", i = 0; i < tipArray.length; i++) spectext += tipArray[i], i != tipArray.length - 1 && (spectext += "和");
            var defaultHeight = 88,
                defalutWidth = 180;
            tipArray.length > 2 && (defaultHeight = 120, defalutWidth = 200);
            var defaults = {
                cls: "error-icon",
                duration: 3e3,
                message: spectext,
                height: defaultHeight,
                width: defalutWidth
            };
            return showMessage(defaults), !1
        }
        return !0
    } catch (e) {
        return !0
    }
    return !0
}

function updateColorSizeInfo() {
    try {
        var newColorSizeInfo = eval("(" + $("#newColorSizeInfo").val() + ")"),
            list = newColorSizeInfo.colorSize,
            isSameButtonClick = !1;
        if (event.target && event.target.parentNode && event.target.parentNode.id)
            if (event.target.parentNode.querySelector(".selected") && (isSameButtonClick = event.target.parentNode.querySelector(".selected").id == event.target.id, event.target.parentNode.querySelector(".selected").className = "a-item J_ping"), isSameButtonClick) {
                event.target.className = "a-item J_ping";
                for (var tempArray = event.target.parentNode.id.split("-"), index = parseInt(tempArray[tempArray.length - 1]) - 1, commonSkuList = [], isCommonListInit = !1, notUpdateIndex = [], i = 0; i < list.length; i++)
                    if (i != index) {
                        var pIdIndex = i + 1,
                            selectedButton = $("#p-new-spec-" + pIdIndex).children(".selected");
                        if (selectedButton && selectedButton.length > 0) {
                            var buttonIdArray = selectedButton[0].id.split("-"),
                                selectedButtonIndex = parseInt(buttonIdArray[buttonIdArray.length - 1]),
                                tempSkuList = list[i].buttons[selectedButtonIndex].skuList;
                            isCommonListInit || (commonSkuList = tempSkuList, isCommonListInit = !0), getInsertSection(commonSkuList, tempSkuList).length > 0 && (notUpdateIndex.push(i), commonSkuList = getInsertSection(commonSkuList, tempSkuList))
                        }
                    }
                for (var j = 0; j < list.length; j++) {
                    var pIdIndex = j + 1;
                    if (notUpdateIndex.indexOf(j) < 0) {
                        var tempNewColorSize = list[j],
                            selectedButton = $("#p-new-spec-" + pIdIndex).children(".selected"),
                            selectedButtonIndex = -1;
                        if (selectedButton.length > 0) {
                            var buttonIdArray = selectedButton[0].id.split("-");
                            selectedButtonIndex = parseInt(buttonIdArray[buttonIdArray.length - 1])
                        }
                        for (var html = "", m = 0; m < tempNewColorSize.buttons.length; m++) {
                            var tempSkuList = tempNewColorSize.buttons[m].skuList,
                                title = tempNewColorSize.buttons[m].text;
                            html += '<a title="' + title + '"', getInsertSection(commonSkuList, tempSkuList).length > 0 ? html += m == selectedButtonIndex ? ' class="a-item selected J_ping" ' : ' class="a-item J_ping" ' : 0 == commonSkuList.length ? html += ' class="a-item J_ping" ' : html += ' class="a-item no-goods J_ping" ', html += 'id="button-new-spec-' + m + '" onclick="updateColorSizeInfo();" report-eventid="MProductdetail_SpecificationSpec" report-eventparam="' + title + '"  href="javascript:void(0)">' + title + "</a>"
                        }
                        $("#p-new-spec-" + pIdIndex).html(html)
                    }
                }
            } else {
                event.target.className = "a-item selected J_ping";
                var tempArray = event.target.parentNode.id.split("-"),
                    index = parseInt(tempArray[tempArray.length - 1]) - 1,
                    newColorSize = list[index],
                    tempArray2 = event.target.id.split("-"),
                    buttonIndex = parseInt(tempArray2[tempArray2.length - 1]),
                    currentSkuList = newColorSize.buttons[buttonIndex].skuList,
                    commonSkuList = currentSkuList,
                    selectedButtonCount = 1;
                currentColorSizeSpec = "";
                for (var i = 0; i < list.length; i++)
                    if (i != index) {
                        var pIdIndex = i + 1,
                            selectedButton = $("#p-new-spec-" + pIdIndex).children(".selected");
                        if (selectedButton && selectedButton.length > 0) {
                            selectedButtonCount++, currentColorSizeSpec += selectedButton[0].title + " ";
                            var buttonIdArray = selectedButton[0].id.split("-"),
                                selectedButtonIndex = parseInt(buttonIdArray[buttonIdArray.length - 1]),
                                tempSkuList = list[i].buttons[selectedButtonIndex].skuList;
                            commonSkuList = getInsertSection(commonSkuList, tempSkuList)
                        }
                    } else currentColorSizeSpec += event.target.title + " ";
                if (1 == commonSkuList.length && selectedButtonCount == list.length) refreshSpecInfoBySkuId(commonSkuList[0]);
                else if (commonSkuList.length > 1 && selectedButtonCount == list.length) refreshSpecInfoBySkuId(commonSkuList[0]);
                else {
                    currentColorSizeSpec = "";
                    for (var j = 0; j < list.length; j++) {
                        var tempNewColorSize = list[j];
                        if (j != index) {
                            var pIdIndex = j + 1,
                                selectedButton = $("#p-new-spec-" + pIdIndex).children(".selected"),
                                selectedButtonIndex = -1;
                            if (selectedButton.length > 0) {
                                var buttonIdArray = selectedButton[0].id.split("-");
                                selectedButtonIndex = parseInt(buttonIdArray[buttonIdArray.length - 1])
                            }
                            for (var html = "", m = 0; m < tempNewColorSize.buttons.length; m++) {
                                var tempSkuList = tempNewColorSize.buttons[m].skuList,
                                    title = tempNewColorSize.buttons[m].text;
                                html += '<a title="' + title + '"', getInsertSection(currentSkuList, tempSkuList).length > 0 ? html += m == selectedButtonIndex ? ' class="a-item selected J_ping" ' : ' class="a-item J_ping" ' : html += ' class="a-item no-goods J_ping" ', html += 'id="button-new-spec-' + m + '" onclick="updateColorSizeInfo();" report-eventid="MProductdetail_SpecificationSpec" report-eventparam="' + title + '"  href="javascript:void(0)">' + title + "</a>"
                            }
                            $("#p-new-spec-" + pIdIndex).html(html)
                        } else
                            for (var m = 0; m < tempNewColorSize.buttons.length; m++) m != buttonIndex && $("#button-new-spec-" + m).attr("class", "a-item J_ping")
                    }
                }
            }
    } catch (e) {
    }
}

function handlePrice(e, t) {
    var a, o;
    return "" == e || "null" == e ? (a = "99", o = "请输入正确的期望价格") : (e *= 1, t *= 1, e < 0 ? (a = "2", o = "期望价格不能小于0") : e > t ? (a = "3", o = "期望价格不能大于当前价格") : (a = "0", o = "正确值")), initDataArray(a, o)
}

function handlePhone(e) {
    var t, a, o = /^(\+86)?1[3-9][0-9]{9}$/;
    return "" == e || "null" == e ? (t = "1", a = "请输入手机号码") : o.test(e) ? (t = "0", a = "正确值") : (t = "2", a = "手机号码错误,请重新输入"), initDataArray(t, a)
}

function initDataArray(e, t) {
    var a = new Array(2);
    return a[0] = e, a[1] = t, a
}

function toastSuccess(e) {
    $.toast({message: e, cls: "succee-icon"})
}

function toastError(e) {
    $.toast({message: e, cls: "error-icon"})
}

function productInfoLoad(e) {
    var t = {
            containerID: "goodDetail", wareId: "", url: "", cbfn: null, switchTabCbFn: function () {
            }, goProdBtnCbFn: function () {
            }
        },
        a = $.extend(t, e),
        o = document.getElementById(a.containerID),
        i = (document.querySelector(".tab-lst"), ""),
        r = {
            addInfo: function (e) {
                if (i += '<div class="detail" id="wareInfo" style="display:block;">', e.OP && e.overseaNotices && e.overseaNotices.length > 0) {
                    i += '    <div id="scale-parent2">', i += '        <div class="scale-box" id="scale-cont2">';
                    for (var t = 0, a = e.overseaNotices.length; t < a; t++) e.OP && e.overseaNotices[t] && $("#httpsConfig") && "true" == $("#httpsConfig").val() && e.overseaNotices[t].indexOf('src="http://') > -1 ? i += e.overseaNotices[t].replace(/src="http:\/\//g, 'src="//') : i += e.overseaNotices[t];
                    i += "</div></div>"
                }
                if (i += '    <div id="scale-parent">', e && e.wdis && "null" != e.wdis && "暂无" != e.wdis ? (i += '        <div class="scale-box" id="scale-cont">', i += "            <p>", i += "                <span>", e.wdis && $("#httpsConfig") && "true" == $("#httpsConfig").val() && e.wdis.indexOf('src="http://') > -1 ? i += e.wdis.replace(/src="http:\/\//g, 'src="//') : i += e.wdis, i += "</span></p>") : (itemScaleFlag = !1, i += '<div class="errPic-wrap">', i += '<div class="errPic"><img src="../../../images/4.4/i/dog.png"/><span class="errPic-content">暂无商品介绍</span><div class="pro-button-box"><span class="pro-button J_ping"  report-eventid="MProductdetail_DetailViewGoods" report-eventlevel="5"', e.wareId && (i += 'report-eventparam="' + e.wareId + '"'), i += ">查看商品信息</span></div></div>"), i += "</div></div>", i += '<div id="recommendWrap" class="recommend-wrap"></div>', i += '<div id="scanWrap" class="recommend-wrap"></div>', i += "</div>", i += '<div class="detail" id="wareStandard" style="display:none;">', e && e.wi && e.wi.code && "null" != e.wi.code && "暂无" != e.wi.code ? 1 == e.wi.type || 4 == e.wi.type ? (i += "<p><span>", i += e.wi.code, i += "</span></p>") : 2 != e.wi.type && 3 != e.wi.type || (i += "<table class='table-border' width='100%'><tbody>", i = this.doJson(JSON.parse(e.wi.code), i, e.wi.type), i += "</tbody></table>") : (i += '<div class="errPic"><img src="../../../images/4.4/i/dog.png"/><span class="errPic-content">暂无规格参数</span><div class="pro-button-box"><span class="pro-button J_ping"  report-eventid="MProductdetail_DetailViewGoods" report-eventlevel="5"', e.wareId && (i += 'report-eventparam="' + e.wareId + '"'), i += ">查看商品信息</span></div></div>"), e && e.wi && "0" == e.wi.serviceType) i += '</div><div class="detail" id="warePack" style="display:none;">', e && e.wi && e.wi.wareQD && "null" != e.wi.wareQD && "暂无" != e.wi.wareQD || e && e.wi && e.wi.ybInfo && "null" != e.wi.ybInfo && "暂无" != e.wi.ybInfo || e && e.wi && e.wi.priceDescription && "null" != e.wi.priceDescription && "暂无" != e.wi.priceDescription ? (i += "<p>", e && e.wi && e.wi.wareQD && "null" != e.wi.wareQD && "暂无" != e.wi.wareQD ? (i += "<p>包装清单：</p>", i += "<p>", i += e.wi.wareQD, i += "</p><br/>") : i += "", e && e.wi && e.wi.ybInfo && "null" != e.wi.ybInfo && "暂无" != e.wi.ybInfo ? (i += "<p>售后服务：</p>", i += "<p>", i += e.wi.ybInfo, i += "</p><br/>") : i += "", e && e.wi && e.wi.priceDescription && "null" != e.wi.priceDescription && "暂无" != e.wi.priceDescription ? (i += "<p>价格说明：</p>", i += "<p>", i += e.wi.priceDescription, i += "</p>") : i += "", i += "</p>") : (i += '<div class="errPic"><img src="../../../images/4.4/i/dog.png"/><span class="errPic-content">暂无包装售后</span><div class="pro-button-box"><span class="pro-button J_ping"  report-eventid="MProductdetail_DetailViewGoods" report-eventlevel="5"', e.wareId && (i += 'report-eventparam="' + e.wareId + '"'), i += ">查看商品信息</span></div></div>");
                else if (e && e.wi && "1" == e.wi.serviceType)
                    if (i += '</div><div class="detail sale-service-wrap" id="warePack" style="display:none;">', e && e.wi && e.wi.wareQD && "null" != e.wi.wareQD && "暂无" != e.wi.wareQD || e && e.wi && e.wi.afterServiceList && "null" != e.wi.afterServiceList && e.wi.afterServiceList.length > 0)
                        if (e && e.wi && e.wi.wareQD && "null" != e.wi.wareQD && "暂无" != e.wi.wareQD ? (i += '<div class="sale-service-grey bdr-t"></div>', i += '<div class="sale-service-floor bdr-t">', i += '<div class="sale-service-title"><span class="title-text">包装清单<span></div>', i += '<div class="sale-service-content">', i += e.wi.wareQD, i += "</div>", i += "</div>") : i += "", e && e.wi && e.wi.afterServiceList && "null" != e.wi.afterServiceList && e.wi.afterServiceList.length > 0)
                            for (var o in e.wi.afterServiceList) i += '<div class="sale-service-grey bdr-t"></div>', i += '<div class="sale-service-floor bdr-t">', i += '<div class="sale-service-title"><span class="title-text">' + e.wi.afterServiceList[o].label + "<span></div>", i += '<div class="sale-service-content">', i += e.wi.afterServiceList[o].value, i += "</div>", i += "</div>";
                        else i += "";
                    else i += '<div class="errPic"><img src="../../../images/4.4/i/dog.png"/><span class="errPic-content">暂无包装售后</span><div class="pro-button-box"><span class="pro-button J_ping"  report-eventid="MProductdetail_DetailViewGoods" report-eventlevel="5"', e.wareId && (i += 'report-eventparam="' + e.wareId + '"'), i += ">查看商品信息</span></div></div>";
                i += '</div><div class="detail" id="wareService" style="display:none;">', i += "    <p>", i += "        <span>", e && e.wi && e.wi.ybInfo && "null" != e.wi.ybInfo ? i += e.wi.ybInfo : i += "", i += "</span></p></div>"
            },
            loopArray: function (e, t) {
                for (var a, o = 0, i = e.length; o !== i; ++o)
                    if (void 0 !== (a = t(e[o], o))) return a
            },
            loopObj: function (e, t) {
                for (var a in e) t(a, e[a])
            },
            doJson: function (e, t, a) {
                var o = this;
                return 2 == a ? this.loopArray(e, function (e, a) {
                    o.loopObj(e, function (e, a) {
                        t += "<tr><td colspan='2'><strong>" + e + "</strong></td></tr>", o.loopArray(a, function (e, a) {
                            o.loopObj(e, function (e, a) {
                                e = e.replace(/[\（|(]/, "<br/> ("), t += "<tr><td>" + e + "</td><td>" + a + "</td></tr>"
                            })
                        })
                    })
                }) : 3 == a && this.loopArray(e, function (e, a) {
                    o.loopObj(e, function (e, a) {
                        e = e.replace(/[\（|(]/, "<br/> ("), t += "<tr><td>" + e + "</td><td>" + a + "</td></tr>"
                    })
                }), t
            },
            addBook: function (e) {
                if (i += '<div class="detail" id="bookContent" style="display:block;">', i += '    <div id="scale-parent">', e && e.ware && e.ware.bookAttrs && "null" != e.ware.bookAttrs) {
                    i += '        <div class="scale-box-ebook" id="scale-cont">', i += "            <p>", i += "                <span></span></p>", i += '            <div class="book-container">';
                    for (var t = 0; t < e.ware.bookAttrs.length; t++) i += '                <div class="book-container-item">', i += '                    <span class="book-item-title">【', e.ware.bookAttrs[t].label && "null" != e.ware.bookAttrs[t].label ? i += e.ware.bookAttrs[t].label : i += "", i += "】</span>", i += '<p class="book-item-content">', e.ware.bookAttrs[t].value && "null" != e.ware.bookAttrs[t].value ? $("#httpsConfig") && "true" == $("#httpsConfig").val() && e.ware.bookAttrs[t].value.indexOf('src="http://') > -1 ? i += e.ware.bookAttrs[t].value.replace(/src="http:\/\//g, 'src="//') : i += e.ware.bookAttrs[t].value : i += "", i += "</p></div>"
                } else itemScaleFlag = !1, i += '<div class="errPic"><img src="../../../images/4.4/i/dog.png"/><span class="errPic-content">暂无商品介绍</span><div class="pro-button-box"><span class="pro-button J_ping"  report-eventid="MProductdetail_DetailViewGoods" report-eventlevel="5"', e.wareId && (i += 'report-eventparam="' + e.wareId + '"'), i += ">查看商品信息</span></div></div></div>";
                if (i += "</div><p></p></div></div>", i += '<div id="recommendWrap" class="recommend-wrap"></div>', i += '<div id="scanWrap" class="recommend-wrap"></div>', i += "</div>", i += '<div class="detail" id="bookInfo" style="display:none;">', i += "<p><span></span></p>", e && e.ware && e.ware.attrs && "null" != e.ware.attrs)
                    for (var a = 0; a < e.ware.attrs.length; a++) i += '<div class="book-container">', i += '    <div class="book-info-line">', i += '         <span class="info-title">', e.ware.attrs[a].label && "null" != e.ware.attrs[a].label ? i += e.ware.attrs[a].label : i += "", i += "</span>", i += '         <span class="info-content">', "undefined" == e.ware.attrs[a].value ? i += "" : i += e.ware.attrs[a].value, i += "</span></div></div>";
                else i += "";
                i += "<p></p></div>", i += '<div class="detail" id="bookCata" style="display:none;">', i += "    <p>", i += '        <span style="margin-left:5px">', e && e.ware && e.ware.catalogue && "null" != e.ware.catalogue ? i += e.ware.catalogue : i += "", i += "</span></p></div>"
            },
            zhuangbaFn: function (e) {
                e && e.popWareDetailWebViewMap && e.popWareDetailWebViewMap.cssContent && $("body").append(e.popWareDetailWebViewMap.cssContent)
            },
            clickDetailTab: function () {
                for (var e = document.querySelectorAll(".detail"), t = document.querySelectorAll(".tab-lst-a"), a = 0; a < t.length; a++) !function (o) {
                    t[a].addEventListener("click", function () {
                        for (var a = 0; a < e.length; a++) e[a].style.display = "none";
                        for (var i = 0; i < t.length; i++) t[i].classList.contains("on") && t[i].classList.remove("on");
                        t[o].classList.add("on");
                        var r = t[o].getAttribute("value");
                        document.getElementById(r).style.display = "block"
                    }, !1)
                }(a)
            }
        },
        n = function (e) {
            var t = "";
            $("#uniformShopId").val() && (t = t + "&shopId=" + $("#uniformShopId").val()), $("#uniformFlt").val() && (t = t + "&flt=" + $("#uniformFlt").val()), r.zhuangbaFn(e), r.addInfo(e), o.innerHTML = i, r.clickDetailTab(), a.switchTabCbFn(), a.goProdBtnCbFn(), itemScaleFlag && a.cbfn(), recommendLoad({
                containerID: "recommendWrap",
                url: "/ware/uniformRecommend.json?wareId=" + $("#currentWareId").val() + t
            })
        },
        s = function (e) {
            var t = "";
            $("#uniformShopId").val() && (t = t + "&shopId=" + $("#uniformShopId").val()), $("#uniformFlt").val() && (t = t + "&flt=" + $("#uniformFlt").val()), r.zhuangbaFn(e), r.addBook(e), o.innerHTML = i, r.clickDetailTab(), a.switchTabCbFn(), a.goProdBtnCbFn(), itemScaleFlag && a.cbfn(), recommendLoad({
                containerID: "recommendWrap",
                url: "/ware/uniformRecommend.json?wareId=" + $("#currentWareId").val() + t
            })
        },
        l = function () {
            var e = document.querySelector(".is-loading");
            $.ajax({
                type: "get", url: a.url, data: a.filters, dataType: "json", beforeSend: function () {
                    e.style.display = "block"
                }, success: function (t) {
                    e.style.display = "none", t && !a.itemInfoFlag && (t.isbook ? s(t) : t.ware && n(t.ware), itemInfoFlag = !0)
                }, error: function (t, a) {
                    e.style.display = "none"
                }
            })
        };
    return function () {
        itemInfoFlag || l()
    }()
}

function assessListInit(e) {
    function t() {
        var e = i();
        try {
            var t = window.sessionStorage;
            t && (t.removeItem("tabIndex"), t.setItem("tabIndex", n.tabIndex))
        } catch (e) {
        }
        (new LoadPage).init({
            containId: "#commentListId",
            pointHeight: e.pointHeight,
            reqType: "post",
            baseUrl: "/newComments/foldComments.json",
            reqPara: e.reqPara,
            reLoad: !1,
            pageNo: "offset",
            beforeFn: function () {
                l.style.display = "block"
            },
            successFn: function (e) {
                if (clearTimeout(null), l.style.display = "none", e && e.wareDetailComment) {
                    var t = e.wareDetailComment;
                    t.commentInfoList && (f(e, this.reLoad), t.commentInfoList.length < n.maxCount && $(".reply-flat-bottom").show(), window.addEventListener(m, function () {
                        v.liAdjustWidth(), v.imgAdjustWidth()
                    }, !1), $("#picLasyLoad") && "true" == $("#picLasyLoad").val() && jQuery.loadImg.lazyLoad({
                        rangeH: 30,
                        scrollObj: "#commentListId",
                        container: "tab-wrapper",
                        isChangeSize: "false",
                        imgcb: v.imgLoadCb
                    })), itemPingjiaFlag = !0, $("#" + n.containerID).css({
                        transform: "translateY(-60px) translateZ(0px)",
                        WebkitTransform: "translateY(-60px) translateZ(0px)",
                        transition: "transform .5s cubic-bezier(0, 0, 0.25, 1) 0ms",
                        WebkitTransition: "transform .5s cubic-bezier(0, 0, 0.25, 1) 0ms"
                    }), setTimeout(function () {
                        $("#commentListId")[0].scrollTop += 60, $("#" + n.containerID).attr("style", "")
                    }, 500), $(s).off("click", ".x-loadBadComment"), n.badCommentFlag = !0
                } else a(actionType, this.reLoad)
            },
            errorFn: function () {
                a(actionType, this.reLoad)
            }
        })
    }

    function a(e, t) {
        data = {
            wareDetailComment: {
                allCnt: "0",
                badCnt: "0",
                canConsultFlag: "true",
                code: "0",
                commentInfoList: [],
                consultationCount: "0",
                goodCnt: "0",
                normalCnt: "0",
                pictureCnt: "0",
                showPicCnt: "0"
            }, commentCount: 0, totalPage: 0
        }, "0" == e && t && null != c && h(data.wareDetailComment), f(data, t)
    }

    function o(e) {
        var t;
        if ("number" == typeof e) switch (e) {
            case 0:
                t = "0";
                break;
            case 1:
                t = "3";
                break;
            case 2:
                t = "2";
                break;
            case 3:
                t = "1";
                break;
            case 4:
                t = "4";
                break;
            default:
                t = "0"
        } else switch (e) {
            case "0":
                t = "allCnt";
                break;
            case "3":
                t = "goodCnt";
                break;
            case "2":
                t = "normalCnt";
                break;
            case "1":
                t = "badCnt";
                break;
            case "4":
                t = "pictureCnt";
                break;
            default:
                t = "allCnt"
        }
        return t
    }

    function i() {
        var e = $("#commontType").val() || "0";
        return e = o(n.tabIndex), $("#commontType").val(e), {
            pointHeight: document.documentElement.clientHeight - $(".jd-header-new-bar").height() - $(".hold-div-bottom").height() - $(".cart-concern-btm-fixed").height(),
            reqPara: {
                wareId: $("#currentWareId").val(),
                offset: "1",
                num: "10",
                type: e,
                checkParam: $("#commendetailModel").attr("commendetail-data"),
                evokeType: "true" === guideTrafficConfig.commentsShowFlag ? "caseA" : "",
                category: $("#categoryId").val(),
                isUseMobile: !0
            }
        }
    }

    var r = {containerID: "tab-wrapper", url: "", tabIndex: 0, maxCount: 10, cbList: null, badCommentFlag: !0},
        n = $.extend(r, e),
        s = document.getElementById(n.containerID),
        l = document.querySelector(".is-loading"),
        c = document.getElementById("tabs"),
        d = "",
        u = "",
        p = "onorientationchange" in window,
        m = p ? "orientationchange" : "resize",
        v = {
            getAdjustW: function () {
                var e = document.documentElement.clientWidth,
                    t = e - 20 - 39,
                    a = t / 4;
                return a > 120 && (a = 120), a
            },
            liAdjustWidth: function () {
                var e = v.getAdjustW();
                $(".product-imgs-li").width(e).height(e)
            },
            imgAdjustWidth: function () {
                var e = v.getAdjustW();
                $(".product-imgs-li").find("img").each(function (t) {
                    var a, o, i, r = $(this),
                        n = new Image;
                    n.src = $(r).attr("src"), n.onload = function () {
                        a = this.width, o = this.height, i = a / o, o > a ? (r.width(e), r.css("marginTop", (e - e / i) / 2 + "px")) : (r.height(e), r.css("marginLeft", (e - e * i) / 2 + "px"))
                    }, n.onerror = function () {
                        r.attr("src", "../../../images/5.4/occupy-img320.gif?v="), r.width(e).height(e)
                    }
                })
            },
            imgLoadCb: function (e, t) {
                var a = v.getAdjustW(),
                    o = e.width,
                    i = e.height,
                    r = o / i;
                i > o ? (t.width(a), t.css("marginTop", (a - a / r) / 2 + "px")) : (t.height(a), t.css("marginLeft", (a - a * r) / 2 + "px"))
            },
            addTop: function (e) {
                var t = $("#currentWareId").val();
                u += '<li class="tab-item J_ping" report-eventid="MProductdetail_CommentAllTab" report-eventlevel="5" report-pageparam="' + t + '">', u += '    <p class="tab-assess-title">全部评价</p>', u += '    <p class="tab-assess-num">', u += e.allCnt || 0, u += "    </p>", u += "</li>", u += '<li class="tab-item J_ping" report-eventid="MProductdetail_CommentFavorableTab" report-eventlevel="5" report-pageparam="' + t + '">', u += '    <p class="tab-assess-title">好评</p>', u += '    <p class="tab-assess-num">', u += e.goodCnt || 0, u += "    </p>", u += "</li>", u += '<li class="tab-item J_ping" report-eventid="MProductdetail_CommentMediumTab" report-eventlevel="5" report-pageparam="' + t + '">', u += '    <p class="tab-assess-title">中评</p>', u += '    <p class="tab-assess-num">', u += e.normalCnt || 0, u += "    </p>", u += "</li>", u += '<li class="tab-item J_ping" report-eventid="MProductdetail_CommentPoorTab" report-eventlevel="5" report-pageparam="' + t + '">', u += '    <p class="tab-assess-title">差评</p>', u += '    <p class="tab-assess-num">', u += e.badCnt || 0, u += "    </p>", u += "</li>", u += '<li class="tab-item J_ping" report-eventid="MProductdetail_CommentPictureTab" report-eventlevel="5" report-pageparam="' + t + '">', u += '    <p class="tab-assess-title">有图</p>', u += '    <p class="tab-assess-num">', u += e.pictureCnt || 0, u += "    </p>", u += "</li>"
            },
            switchTab: function () {
                var e = document.getElementById("tabs"),
                    t = document.querySelectorAll(".tab-item"),
                    a = document.querySelectorAll(".tab-assess-num"),
                    o = document.querySelector(".reply-body");
                if (null != e) {
                    for (var i = 0; i < t.length; i++) t[i].classList.remove("tab-hover"), a[i].classList.remove("tab-assess-rednum");
                    t[n.tabIndex].classList.add("tab-hover"), a[n.tabIndex].classList.add("tab-assess-rednum");
                    for (var r = 0; r < t.length; r++) !function (e) {
                        t[e].onclick = function () {
                            n.tabIndex = e;
                            for (var i = 0; i < r; i++) t[i].classList.remove("tab-hover"), a[i].classList.remove("tab-assess-rednum");
                            t[e].classList.add("tab-hover"), a[e].classList.add("tab-assess-rednum"), o.scrollTop = 0, n.url = "/newComments/newCommentsDetail.json", w(1), g()
                        }
                    }(r)
                }
            },
            tabReturn: function () {
                var e = document.querySelectorAll(".tab-btn")[0],
                    t = document.querySelectorAll(".tab-item"),
                    a = document.querySelectorAll(".tab-assess-num");
                e && (e.onclick = function () {
                    if (pingClickWithLevel("MProductdetail_CommentAll", "", "", $("#currentWareId").val(), "5"), n.tabIndex = 0, t.length > 0) {
                        for (var e = 0; e < t.length; e++) t[e].classList.remove("tab-hover"), a[e].classList.remove("tab-assess-rednum");
                        t[n.tabIndex].classList.add("tab-hover"), a[n.tabIndex].classList.add("tab-assess-rednum")
                    }
                    n.url = "/newComments/newCommentsDetail.json", w(1)
                })
            },
            addHtml: function (e) {
                var t = $("#currentWareId").val(),
                    a = $("#sid").val(),
                    o = "";
                e && e.guid && (o = e.guid);
                var i = "javascript:void(0)";
                if ("true" == $("#isDisplayReplyBtn").val() ? i = "/replyList/" + t + "_" + o + ".html?sid=" + a : e.replyCnt > 0 && (i = "/replyList/" + t + "_" + o + ".html?sid=" + a), d += '<div class="assess-flat">', d += '    <span class="assess-wrapper">', d += '        <div class="assess-top">', d += '            <span class="user-portrait">', d += '                <img src="//', d += e.userImgURL, d += '" onerror="userDefaultImg();" >', d += "</span>", d += '            <span class="user-name">', d += e.userNickName, d += "</span>", e && e.plusAvailable && "101" == e.plusAvailable) d += '<a class="plus-icon-wrap J_ping" report-eventid="MProductdetail_CommentPlus" href="' + e.plusAddress + '">', d += '    <img class="plus-icon plus-icon-left" src="../../../images/5.4/plus-icon.png">', d += '    <span class="plus-icon-text">试用</span>', d += "</a>";
                else if (e && e.plusAvailable && "201" == e.plusAvailable) d += '<a class="plus-icon-wrap J_ping" report-eventid="MProductdetail_CommentPlus" href="' + e.plusAddress + '">', d += '    <img class="plus-icon" src="../../../images/5.4/plus-icon.png">', d += "</a>";
                else {
                    switch (d += '            <span class="vip-icon ', e.userLevel) {
                        case "0":
                            d += "vip-diamond-icon";
                            break;
                        case "1":
                            d += "vip-gold-icon";
                            break;
                        case "2":
                            d += "vip-silver-icon";
                            break;
                        case "3":
                            d += "vip-copper-icon";
                            break;
                        case "4":
                        case "5":
                        case "6":
                        case "-1":
                            d += "vip-register-icon"
                    }
                    d += '"></span>'
                }
                if (d += '            <span class="assess-date">', d += e.commentDate.replace(/ (\d{2}):(\d{2}):(\d{2})$/, ""), d += "</span>", d += "</div>", d += '        <div class="assess-bottom">', d += '            <span class="comment-item-star">', d += '                <span class="real-star comment-stars-width', d += e.commentScore, d += '"></span>', d += "</span>", d += '            <p class="assess-content">', d += e.commentData, d += "</p>", 1 == e.commentType) {
                    d += '<div class="product-img-module">', d += '     <a class="J_ping" report-eventid="MProductdetail_CommentPictureTab" report-pageparam="' + $("#currentWareId").val() + '" href="/ware/newCommentDetailPicShow.action?commentId=' + e.guid + "&wareId=" + $("#currentWareId").val() + '">', d += '         <ul class="jd-slider-container">';
                    for (var r = 0; r < e.pictureInfoList.length && 4 != r; r++) d += '<li class="jd-slider-item product-imgs-li">', $("#picLasyLoad") && "true" == $("#picLasyLoad").val() ? (d += '<img src="../../../images/5.4/occupy-img320.gif" _src="', e.pictureInfoList[r].picURL && $("#httpsConfig") && "true" == $("#httpsConfig").val() ? d += e.pictureInfoList[r].picURL.replace("http://", "//") : d += e.pictureInfoList[r].picURL) : (d += '<img src="', e.pictureInfoList[r].picURL && $("#httpsConfig") && "true" == $("#httpsConfig").val() ? d += e.pictureInfoList[r].picURL.replace("http://", "//") : d += e.pictureInfoList[r].picURL), d += '" onerror="accessImgErr(this)"></li>', r < 3 && (d += '<li class="product-img-space"></li>');
                    d += "</ul>", d += "</a>", d += "</div>"
                }
                d += '            <p class="pay-date">购买日期：', d += e.orderDate, d += "            </p>";
                try {
                    e.wareAttribute.length > 0 && (d += '            <p class="product-type">', e.wareAttribute[0] && (e.wareAttribute[0].颜色 ? (d += "颜色：", d += e.wareAttribute[0].颜色) : e.wareAttribute[0].型号 && (d += "型号：", d += e.wareAttribute[0].型号)), e.wareAttribute[1] && (e.wareAttribute[1].颜色 ? (d += " 颜色：", d += e.wareAttribute[1].颜色) : e.wareAttribute[1].型号 && (d += " 型号：", d += e.wareAttribute[1].型号)), d += "            </p>")
                } catch (e) {
                }
                d += "        </div>", d += "    </span>", d += '    <div class="assess-btns-box"><div class="assess-btns" >', d += '        <a class="assess-like-btn" id="' + o + '" onclick="clickUseful(\'' + o + "')\">", d += '            <i class="assess-btns-icon btn-like-icon like-grey" id="praiseBtn_' + o + '" ></i>', d += '            <span class="assess-btns-num" id="praiseCnt_' + o + '" data="' + e.praiseCnt + '">(', d += e.praiseCnt, d += ")</span>", d += '            <i class="like" id="like_' + o + '">+1</i>', d += "</a>", d += '        <a class="assess-reply-btn" onclick="isEnterReplyPage(' + e.replyCnt + ')" id="' + o + "_" + e.replyCnt + '" href="' + i + '">', e.replyCnt > 0 ? d += '            <i class="assess-btns-icon btn-reply-icon"></i>' : d += '            <i class="assess-btns-icon btn-no-reply-icon"></i>', d += '            <span class="assess-btns-num">(', d += e.replyCnt, d += ")</span>", d += "</a>", d += "</div></div>", d += "</div>"
            }
        },
        g = function () {
            $("#" + n.containerID).attr("style", ""), n.badCommentFlag && ($(s).on("click", ".x-loadBadComment", function () {
                t(), pingClickWithLevel("MProductdetail_CommentFold", "", "", $("#currentWareId").val(), "")
            }), n.badCommentFlag = !1)
        },
        h = function (e) {
            v.addTop(e), c.innerHTML = u, v.switchTab()
        },
        f = function (e, t) {
            var a = e.wareDetailComment;
            try {
                var o = $("#currentWareId").val();
                if (a.commentInfoList.length < n.maxCount ? (l.style.display = "none", $("#loadMoreFlag").val("false")) : ($(".reply-flat-bottom").hide(), $("#loadMoreFlag").val("true")), 0 == a.commentInfoList.length && t) return $("#loadMoreFlag").val("false"), $(".reply-flat-bottom").hide(), i = document.querySelector(".reply-body"), d = "", d += '<div class="tab-no-assess">', 4 == n.tabIndex ? d += '<div class="errPic"><img src="../../../images/4.4/i/dog.png"/><span class="errPic-content">暂无有图评价</span><div class="pro-button-box"><span class="pro-button tab-btn J_ping"  report-eventid="MProductdetail_CommentAll" report-eventlevel="5" report-pageparam="' + o + '">查看全部评价</span></div></div>' : 0 != n.tabIndex ? d += '<div class="errPic"><img src="../../../images/4.4/i/dog.png"/><span class="errPic-content">暂无评价</span><div class="pro-button-box"><span class="pro-button tab-btn J_ping" report-eventid="MProductdetail_CommentAll" report-eventlevel="5" report-pageparam="' + o + '">查看全部评价</span></div></div>' : d += '<div class="errPic"><img src="../../../images/4.4/i/dog.png"/><span class="errPic-content">暂无评价</span><div class="pro-button-box"><span class="pro-button J_ping" report-eventid="MProductdetail_CommentAll" report-eventlevel="5" report-pageparam="' + o + '" onclick="goViewDetail();">返回商品页</span></div></div>', d += "</div>", s.innerHTML = d, l.style.display = "none", i.classList.add("white-color"), i.classList.remove("reply-body-color"), void v.tabReturn();
                var i = document.querySelector(".reply-body"),
                    r = $("#tabs li.tab-hover").find(".tab-assess-rednum").html();
                if (null != r) var c = parseInt($.trim(r));
                i.classList.add("reply-body-color"), i.classList.remove("white-color"), isNaN(c) || 0 != c || ($("#loadMoreFlag").val("false"), i.classList.add("white-color"), i.classList.remove("reply-body-color"));
                var u = n.maxCount <= a.commentInfoList.length ? n.maxCount : a.commentInfoList.length;
                t && ($(".reply-flat-bottom").hide(), s.innerHTML = ""), d = "";
                for (var p = 0; p < u; p++) v.addHtml(a.commentInfoList[p]);
                s.innerHTML += d, v.liAdjustWidth();
                "true" != document.getElementById("picLasyLoad").value && v.imgAdjustWidth(), $(".tab-no-assess") && $(".tab-no-assess").length && ($(".reply-flat-bottom").hide(), $("#replyBody").addClass("white-color"), $("#replyBody").removeClass("reply-body-color")), $(".tab-btn") && $(".tab-btn").length && v.tabReturn()
            } catch (e) {
            }
        },
        y = function () {
            window.addEventListener(m, function () {
                clearTimeout(e);
                var e = setTimeout(function () {
                    var e = document.documentElement.clientHeight - $(".jd-header-new-bar").height() - $(".hold-div-bottom").height() - $(".cart-concern-btm-fixed").height();
                    n.oLoadPage.orientationchangeCb(e), v.liAdjustWidth(), v.imgAdjustWidth()
                }, 300)
            })
        },
        w = function (e) {
            var t = i();
            try {
                var r = window.sessionStorage;
                r && (r.removeItem("tabIndex"), r.setItem("tabIndex", n.tabIndex))
            } catch (e) {
            }
            n.oLoadPage = new LoadPage, n.oLoadPage.init({
                containId: "#commentListId",
                pointHeight: t.pointHeight,
                reqType: "post",
                baseUrl: n.url,
                reqPara: t.reqPara,
                reLoad: !0,
                pageNo: "offset",
                beforeFn: function () {
                    l.style.display = "block"
                },
                successFn: function (t, i) {
                    if (clearTimeout(null), l.style.display = "none", t && t.wareDetailComment) {
                        var r = t.wareDetailComment;
                        if (r.commentInfoList) {
                            "0" == e && this.reLoad && null != c && h(r), f(t, this.reLoad);
                            var d = r[o($("#commontType").val())];
                            if ("true" === guideTrafficConfig.commentsShowFlag && r.allCnt > 3) {
                                $("#tabs").remove(), headerslider.setHoldTopHeight(), $(".open-app-a-bottom").show();
                                var u = "还有" + r.allCnt + "条评价，打开京东APP立即查看";
                                $("#openAppAText").html(u), $(s).addClass("tab-con-oaa")
                            } else if ("true" === t.fotCommentsFlag && "true" != this.reLoad && 0 != parseInt(d) && n.maxCount * (parseInt(i) - 1) + r.commentInfoList.length < parseInt(d)) {
                                var p = '<div class="x-loadBadComment"><div>' + $("#foldReminderText").val() + "</div></div>";
                                $(s).append(p)
                            } else this.reLoad && 0 != parseInt(d) && r.commentInfoList.length < n.maxCount && $(".reply-flat-bottom").show();
                            window.addEventListener(m, function () {
                                v.liAdjustWidth(), v.imgAdjustWidth()
                            }, !1), $("#picLasyLoad") && "true" == $("#picLasyLoad").val() && jQuery.loadImg.lazyLoad({
                                rangeH: 30,
                                scrollObj: "#commentListId",
                                container: "tab-wrapper",
                                isChangeSize: "false",
                                imgcb: v.imgLoadCb
                            })
                        }
                        itemPingjiaFlag = !0
                    } else a(e, this.reLoad)
                },
                errorFn: function () {
                    a(e, this.reLoad)
                }
            })
        };
    return function () {
        itemPingjiaFlag || (w(0), y(), g())
    }()
}

function isEnterReplyPage(e) {
    return pingClickWithLevel("MProductdetail_CommentReply", "", "", $("#currentWareId").val(), "5"), "true" == $("#isDisplayReplyBtn").val() || (e > 0 || ($("#pop_none_reply").css("display", "block"), setTimeout(function () {
        $("#pop_none_reply").css("display", "none")
    }, 1e3), !1))
}

function userDefaultImg() {
    var e = event.srcElement;
    e.src = "/images/2014/ware/newcomments/user-default-avatar.png", e.onerror = null
}

function clickUseful(e) {
    try {
        pingClickWithLevel("MProductdetail_CommentLikebutton", "", "", $("#currentWareId").val(), "5");
        var t = (document.getElementById(e), document.getElementById("praiseBtn_" + e)),
            a = document.getElementById("like_" + e),
            o = document.querySelector(".useful-window"),
            i = $("#currentWareId").val(),
            r = document.getElementById("sid").value,
            n = (new Date).getTime();
        jQuery.ajax({
            url: "/newComments/clickUseful.json?t=" + n,
            type: "post",
            dataType: "json",
            data: {wareId: i, commentId: e, sid: r},
            success: function (n) {
                try {
                    if (n)
                        if ("0" == n.clickUseful) {
                            t.classList.add("like-red"), a.classList.add("like_ani");
                            var s = document.getElementById("praiseCnt_" + e),
                                l = s.getAttribute("data"),
                                c = parseInt(l) + 1;
                            s.setAttribute("data", "" + c), s.innerHTML = "(" + c + ")", o.style.display = "none"
                        } else if ("1" == n.clickUseful) {
                            o.style.display = "block", clearTimeout(d);
                            var d = setTimeout(function () {
                                o.style.display = "none"
                            }, 1e3)
                        } else o.style.display = "none";
                    else window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + r + "&returnurl=https://item.m.jd.com/product/" + i + ".html"
                } catch (e) {
                    window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + r + "&returnurl=https://item.m.jd.com/product/" + i + ".html"
                }
            },
            error: function (e, t) {
                window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + r + "&returnurl=https://item.m.jd.com/product/" + i + ".html"
            }
        })
    } catch (e) {
    }
}

function recommendLoad(e) {
    var t = {containerID: "recommendWrap", url: "", cbfn: null},
        a = $.extend(t, e),
        o = document.getElementById(a.containerID),
        i = "",
        r = {
            addRecommend: function (e) {
                e.length > 0 && (i += '<img class="recommend-title" src="../../../images/5.4/guess-title.png">', i += '<ul class="find-similar-ul" id="recommendList">');
                for (var t = 0; t < e.length; t++) i += '<li class="similar-li">', i += '<a href="javascript:void(0);" onclick="toGuessYouLike(\'' + e[t].clickUrl + "','/product/" + e[t].wareId + '.html\')" class="J_ping" report-eventid="MProductdetail_TestBRecProduct"  report-eventparam="' + e[t].sourceValue + '" report-eventlevel="4">', i += '<div class="similar-product">', i += '<img class="Jschangewidth"  src="../../../images/5.4/occupy-img320.gif?v="  _src="' + e[t].imageurl + '">', i += '<span class="similar-product-text">', e[t].markImageUrl && "" != e[t].markImageUrl && null != e[t].markImageUrl && (i += '<img src="' + e[t].markImageUrl + '" class="product-icon" style="width:' + e[t].markWidth + "px;height:" + e[t].markHeight + 'px;">'), i += e[t].wname, i += "</span>", e[t].jdPrice && "" != e[t].jdPrice && null != e[t].jdPrice && "暂无报价" != e[t].jdPrice && e[t].jdPriceStart && e[t].jdPriceEnd ? i += '<span class="similar-product-price">&yen;  <span class="detail-big-price">' + e[t].jdPriceStart + '</span><span class="detail-small-price">.' + e[t].jdPriceEnd + "</span></span>" : i += '<span class="similar-product-price"><span class="detail-big-price">暂无报价</span></span>', i += '<span class="double-price-wrap">', e[t].wareType && 8 == e[t].wareType ? e[t].tryPlusPrice && "" != e[t].tryPlusPrice && null != e[t].tryPlusPrice && (i += '<span class="double-price double-jx-price"', e[t].priceColor && "" != e[t].priceColor && null != e[t].priceColor && (i += 'style="color:#' + e[t].priceColor + '"'), i += ">&yen; " + e[t].tryPlusPrice, i += "</span>") : e[t].isSamWare && e[t].samPrice && "" != e[t].samPrice && null != e[t].samPrice ? (i += '<span class="double-price double-sam-price"', e[t].priceColor && "" != e[t].priceColor && null != e[t].priceColor && (i += 'style="color:#' + e[t].priceColor + '"'), i += ">&yen; " + e[t].samPrice, i += "</span>") : e[t].tryPlusPrice && "" != e[t].tryPlusPrice && null != e[t].tryPlusPrice && (i += '<span class="double-price double-jx-price"', e[t].priceColor && "" != e[t].priceColor && null != e[t].priceColor && (i += 'style="color:#' + e[t].priceColor + '"'), i += ">&yen; " + e[t].tryPlusPrice, i += "</span>"), e[t].priceIcon && "" != e[t].priceIcon && null != e[t].priceIcon && (i += '<img src="' + e[t].priceIcon + '" class="price-icon">'), i += "<span>", i += '<span class="double-space"></span>', i += "</div>", i += "</a>", i += "</li>";
                e.length > 0 && (i += "</ul>")
            },
            setSamProductHeight: function (e) {
                var t = $(".similar-li"),
                    a = null,
                    o = null,
                    i = null,
                    r = null,
                    n = e;
                e = Math.floor(t.length / 2);
                for (var s = n; s < e; s++) a = $(t[2 * s]).find(".double-price"), o = $(t[2 * s + 1]).find(".double-price"), i = $(t[2 * s]).find(".double-space"), r = $(t[2 * s + 1]).find(".double-space"), a.length > 0 && 0 == o.length && -1 == r[0].className.indexOf("sam-height") ? r.addClass("double-height") : 0 == a.length && o.length > 0 && -1 == i[0].className.indexOf("sam-height") && i.addClass("double-height")
            }
        },
        n = function (e) {
            document.getElementById("pin");
            e && e.length > 0 && r.addRecommend(e), o.innerHTML = i, r.setSamProductHeight(0)
        },
        s = function () {
            $.ajax({
                type: "get", url: a.url, data: a.filters, dataType: "json", beforeSend: function () {
                }, success: function (e) {
                    n(e.uniformRecommendList)
                }, error: function (e, t) {
                }
            })
        };
    return function () {
        s()
    }()
}

function scanLoad(e) {
    var t = {containerID: "scanWrap", url: "", cbfn: null},
        a = $.extend(t, e),
        o = document.getElementById(a.containerID),
        i = "",
        r = {
            addScan: function (e) {
                e.length > 0 && (i += '<img class="recommend-title" src="../../../images/5.4/scan-title.png">', i += '<ul class="find-similar-ul" id="recommendList">');
                for (var t = 0; t < e.length; t++) i += '<li class="similar-li">', i += '<a href="/product/' + e[t].wareId + '.html" class="J_ping" report-eventid="MProductdetail_TestBRecord"  report-eventparam="' + e[t].wareId + "_" + (t + 1) + '" report-eventlevel="4">', i += '<div class="similar-product">', i += '<img class="Jschangewidth"  src="../../../images/5.4/occupy-img320.gif?v="  _src="' + e[t].imageurl + '">', i += '<span class="similar-product-text">', i += e[t].wname, i += "</span>", e[t].jdPrice && "" != e[t].jdPrice && null != e[t].jdPrice && "暂无报价" != e[t].jdPrice && e[t].jdPriceStart && e[t].jdPriceEnd ? i += '<span class="similar-product-price"><span class="detail-big-price">' + e[t].jdPriceStart + '</span><span class="detail-small-price">.' + e[t].jdPriceEnd + "</span></span>" : i += '<span class="similar-product-price"><span class="detail-big-price">暂无报价</span></span>', i += "</div>", i += "</a>", i += "</li>";
                e.length > 0 && (i += "</ul>")
            }
        },
        n = function (e) {
            r.addScan(e), o.innerHTML = i
        },
        s = function () {
            $.ajax({
                type: "get", url: a.url, data: a.filters, dataType: "json", beforeSend: function () {
                }, success: function (e) {
                    e && e.wareHistory && e.wareHistory.code && "0" == e.wareHistory.code && e.wareHistory.wareInfoList && e.wareHistory.wareInfoList.length > 0 && n(e.wareHistory.wareInfoList)
                }, error: function (e, t) {
                }
            })
        };
    return function () {
        s()
    }()
}
var itemPingjiaFlag = !1,
    oClientInfo = document.querySelector("#clientInfo").value;
window._clientVersion_ = oClientInfo;
var guideTrafficConfig = {
        limitedCommentsType: "",
        automaticOpenAppFlag: "true",
        commentsShowFlag: "false",
        bruiedPoits: {
            tableCommentsBottonBruiedPoit: {
                eventId: "",
                eventParam: "",
                closeEventId: "",
                sourceFrom: "",
                channel: ""
            },
            topBottonCloseBruiedPoit: {
                eventId: "",
                eventParam: "",
                pageName: "",
                pageParam: "",
                orderLevel: "",
                description: "",
                sourceFrom: "",
                channel: ""
            },
            mainCommentsBottonBruiedPoit: {
                eventId: "",
                eventParam: "",
                pageName: "",
                pageParam: "",
                orderLevel: "",
                description: "",
                sourceFrom: "",
                channel: ""
            },
            topBottonOpenBruiedPoit: {
                eventId: "",
                eventParam: "",
                pageName: "",
                pageParam: "",
                orderLevel: "",
                description: "",
                sourceFrom: "",
                channel: ""
            },
            bannerBottonBruiedPoit: {eventId: "", eventParam: "", sourceFrom: "", channel: ""},
            limitCommentsPVBruiedPoit: {
                eventId: "",
                eventParam: "",
                pageName: "",
                pageParam: "",
                orderLevel: "",
                description: "",
                sourceFrom: "",
                channel: ""
            },
            autoticBruiedPoit: {
                eventId: "",
                eventParam: "",
                pageName: "",
                pageParam: "",
                orderLevel: "",
                description: "",
                sourceFrom: "",
                channel: ""
            }
        },
        limitNum: 3
    },
    guideTraffic = $("#guideTraffic").val();
guideTraffic && (guideTrafficConfig = $.extend(!0, guideTrafficConfig, JSON.parse(guideTraffic)));
try {
    var headerslider = new HeaderSlider(".header-slider");
    headerslider.init({loadInfoFn: loadInfo, loadAssessFn: loadAssess})
} catch (e) {
    console.log("headerslider 文件未加载")
}
var oUserAgent = window.navigator.userAgent,
    oBtmTip = document.querySelector(".bottom-tip");
oBtmTip.innerHTML = oBtmTip.innerHTML.replace("点击", "上拉");
for (var aGoBack = document.querySelectorAll(".jd-header-icon-back"), i = 0; i < aGoBack.length; i++) aGoBack[i] && aGoBack[i].addEventListener("click", function () {
    headerslider.goBack()
});
$("#m_common_header").length < 1 && $(".hold-div-top").attr("style", "display:none;");
var oBigSmallBuy = document.querySelector("#bigSmallBuy").value,
    oQuantity = document.querySelector(".quantity"),
    oCartBtmFixed = document.querySelector(".cart-concern-btm-fixed"),
    oBtmPrompt = document.querySelector(".bottom-prompt"),
    oComNewTop = document.querySelector(".m_common_new_top"),
    oDivTop = document.querySelector(".hold-div-top"),
    oDivBottom = document.querySelector(".hold-div-bottom"),
    aInputBox = document.querySelectorAll(".input-box");
if (oQuantity && (oQuantity.addEventListener("focus", function () {
        oCartBtmFixed.style.position = "static", oBtmPrompt.style.position = "static", oComNewTop.style.position = "static", oDivTop.style.display = "none"
    }, !1), oQuantity.addEventListener("blur", function () {
        oCartBtmFixed.style.position = "fixed", oBtmPrompt.style.position = "fixed", oComNewTop.style.position = "fixed", oDivTop.style.display = "block"
    }, !1), oBigSmallBuy && "function" == typeof MaxCheck && oQuantity.addEventListener("input", MaxCheck, !1)), aInputBox.length > 0)
    for (var i = 0; i < aInputBox.length; i++) aInputBox[i].addEventListener("focus", function () {
        oCartBtmFixed.style.position = "static", oBtmPrompt.style.position = "static", oComNewTop.style.position = "static", oDivTop.style.display = "none", oDivBottom.style.display = "none"
    }, !1), aInputBox[i].addEventListener("blur", function () {
        oCartBtmFixed.style.position = "fixed", oBtmPrompt.style.position = "fixed", oComNewTop.style.position = "fixed", oDivTop.style.display = "block", oDivBottom.style.display = "block"
    }, !1);
var oCurrentWareId = document.querySelector("#currentWareId").value,
    oSid = document.querySelector("#sid").value,
    oHeaderTitle = document.querySelector("#headerTitle").value;
"true" === guideTrafficConfig.commentsShowFlag && (dowloadAPPFlagA(oCurrentWareId, oSid, oHeaderTitle, ""), dowloadAPPFlagAP(oCurrentWareId, oSid, oHeaderTitle, "")), $("#content").length > 0 && dowloadAPP(oCurrentWareId, oSid, oHeaderTitle, ""), $("#download-floor").length > 0 && dowloadAPPOfFloor(oCurrentWareId, oSid, oHeaderTitle, "");
var logoImgErr = function (e) {
        e.setAttribute("src", "../../../images/5.4/shop-occupy-img.png?v=")
    },
    imgErr = function (e) {
        e.setAttribute("src", "../../../images/5.4/occupy-img320.gif?v=")
    },
    accessImgErr = function (e) {
        e.setAttribute("src", "../../../images/5.4/occupy-img320.gif?v="), e.style.width = "100%", e.style.height = "auto"
    },
    oDaneng = document.querySelector("#daneng").value,
    oDanengSecPin = document.querySelector("#danengSecPin").value;
if (oDaneng) {
    var ranNum = (new Date).getTime(),
        u = oDanengSecPin,
        url = "http://" + u + ".web.meritco.m.jd.com?t=" + ranNum;
    jQuery.ajax({url: url, type: "get"})
}
"true" === $("#itemShareShowFlag").val() && function () {
    creatShareGift()
}(), "true" === $("#trunkFlag").val() && "undefined" != typeof __wisdomBoxComponet && (new __wisdomBoxComponet).init({
    bottom: "120px",
    mask_zindex: 2,
    main_zindex: 3,
    page_name: "item",
    ajaxUrl: "https://mapi.m.jd.com/nav/navigation.action"
});
var VirtualAvailableCouponFlag = !0;
try {
    $(".one-btn-tip-btn").bind("click", function () {
        $(".certification-floor").hide()
    }), $(".cover-floor").bind("click", function () {
        $(".certification-floor").hide()
    })
} catch (e) {
}
$(function () {
    var e = $("#couponShow").val();
    e && "true" == e && "" != $("#currentWareId").val() && couponDetailShow()
}), "true" == $("#bigSale").val() && ("1" == $("#bigSaleStage").val() ? init618PriceCountDown({
    argObj: {
        seckill: {
            seckillTime: "2015-08-03 20:00:02",
            timeRemain: $("#bigSaleToBeginTime").val()
        }
    }, seckillContainer: "js-618price-wait-countdown", seckillCallback: function () {
        $("#js-bigsale-wait").hide(), $("#js-bigsale-begin").show(), init618PriceCountDown({
            argObj: {
                seckill: {
                    seckillTime: "2015-08-03 20:00:02",
                    timeRemain: getBigPriceEndSecKill()
                }
            }, seckillContainer: "js-618price-begin-countdown", seckillCallback: function () {
                hideBigPrice()
            }
        }), $("#js-bottom-618-prompt-text").html($("#purchaseTextBegin").val()), $("#js-bigsale-banner").attr("src", $("#skinBannerUrlBegin").val())
    }
}) : "2" == $("#bigSaleStage").val() && init618PriceCountDown({
    argObj: {
        seckill: {
            seckillTime: "2015-08-03 20:00:02",
            timeRemain: getBigPriceEndSecKill()
        }
    }, seckillContainer: "js-618price-begin-countdown", seckillCallback: function () {
        hideBigPrice()
    }
}));
var promotion = {
    regristerEvent: function () {
        var e = $("#prodPromotion");
        e.length > 0 && e[0].addEventListener("click", promotionSwitch, !0)
    }
};
promotion.regristerEvent();
var serviceOpen = function () {
        $(".flick-menu-mask").show(), $(".service-menu").show(), $(".service-menu").hasClass("service-menu-hide") && $(".service-menu").removeClass("service-menu-hide"), $(".service-menu").addClass("service-menu-show")
    },
    serviceClose = function () {
        $(".flick-menu-mask").hide(), $(".service-menu").hide(), $(".service-menu").hasClass("service-menu-show") && $(".service-menu").removeClass("service-menu-show"), $(".service-menu").addClass("service-menu-hide")
    },
    serviceExpand = function () {
        $(".service-floor").click(function () {
            serviceOpen()
        }), $(".service-ok-btn").click(function () {
            serviceClose()
        }), $(".service-menu-close").click(function () {
            serviceClose()
        })
    },
    serviceAndExtendWarranty = function (e) {
        var t = {
            init: function () {
                t.warrantyStatus(), t.selectWarranty()
            },
            warrantyStatus: function () {
                try {
                    var t, a, o = $("#yanBaoInfo").val();
                    $("#ybId").val(jdM.sessionstorage.get("ybId"));
                    var i = jdM.sessionstorage.get("ybSku");
                    if ($("#warranty-seled-list"))
                        if ("" != $("#ybId").val() && i == $("#currentWareId").val()) {
                            a = $("#ybId").val().split("@@"), "string" == typeof o && (o = JSON.parse(o));
                            for (var r = 0; r < a.length - 1; r++)
                                for (var n in o.yanBaoInfo)
                                    for (var s in o.yanBaoInfo[n].products) o.yanBaoInfo[n].products[s].platformPid == a[r] && ($("#warranty-seled-list").find(".choose-tip").remove(), t = '<div class="base-txt warranty-text selected-warranty ' + o.yanBaoInfo[n].sortName + '"><i class="warranty-icon"></i>' + o.yanBaoInfo[n].products[s].sortName + "&nbsp;&nbsp;&yen;" + o.yanBaoInfo[n].products[s].price + "</div>", $("#warranty-seled-list").append(t), $(".directorder").addClass("disabled"), $(".directorder").unbind("click"));
                            for (var l = 0; l < a.length - 1; l++)
                                for (var c = 0; c < $(".warranty-btn").length; c++) $($(".warranty-btn")[c]).attr("data") == a[l] && ($($(".warranty-btn")[c]).closest(".warranty-btn-wrap").attr("data-selFlag", "1"), $($(".warranty-btn")[c]).addClass("selected"), $($(".warranty-btn")[c]).closest(".warranty-items").find(".warranty-des-href").attr("data-href", $("#warrantyDesHref").val() + "&bindSkuId=" + $($(".warranty-btn")[c]).attr("data")))
                        } else e && (t = '<div class="base-txt warranty-text choose-tip"><i class="warranty-icon"></i>可选延保</div>', $("#warranty-seled-list").append(t)), jdM.sessionstorage.set("ybSku", ""), jdM.sessionstorage.set("ybId", ""), $("#ybId").val("")
                } catch (e) {
                }
            },
            selectWarranty: function () {
                $(".warranty-btn").click(function () {
                    var e, t, a, o, i, r = $(this).closest(".warranty-btn-wrap").attr("data-selFlag"),
                        n = $(this).closest(".warranty-items"),
                        s = n.find(".warranty-des-href"),
                        l = $("#warrantyDesHref").val();
                    if (t = $(this).closest(".warranty-btn-wrap").attr("data-type"), a = $(this).find(".war-btn-text").html(), o = $(this).find(".war-btn-price").html(), "0" == r) {
                        $(this).addClass("selected"), $(".directorder").addClass("disabled"), $(".directorder").unbind("click");
                        var c = $("#ybId").val(c);
                        c += $(this).attr("data") + "@@", $("#ybId").val(c), $(this).closest(".warranty-btn-wrap").attr("data-selFlag", "1"), $("#warranty-seled-list").find(".choose-tip").remove(), i = '<div class="base-txt warranty-text selected-warranty ' + t + '"><i class="warranty-icon"></i>' + a + "&nbsp;&nbsp;" + o + "</div>", $("#warranty-seled-list").append(i), s && "" != l && s.attr("data-href", l + "&bindSkuId=" + $(this).attr("data"))
                    } else if ("1" == r)
                        if (e = $(this).attr("class"), -1 != e.indexOf("selected")) {
                            $(this).toggleClass("selected"), $(this).closest(".warranty-btn-wrap").attr("data-selFlag", "0"), $("#warranty-seled-list").find("div." + t).remove();
                            var d = $(this).attr("data") + "@@",
                                c = $("#ybId").val(c);
                            if (c = c.replace(d, ""), $("#ybId").val(c), s && "" != l && s.attr("data-href", l), 0 == $("#warranty-seled-list div").length) {
                                $(".directorder").removeClass("disabled");
                                var u = document.getElementById("isPopupsCheck").value,
                                    p = document.getElementById("isHaveSpec").value,
                                    m = document.getElementById("directorderBtm");
                                $("#directorder_spec").bind("click", addWareToCartAndNoJump), directorder(u, m, p), $("#ybId").val(""), i = '<div class="base-txt warranty-text choose-tip"><i class="warranty-icon"></i>可选延保</div>', $("#warranty-seled-list").append(i)
                            }
                        } else {
                            $("#warranty-seled-list").find("div." + t).remove(), i = '<div class="base-txt warranty-text selected-warranty ' + t + '"><i class="warranty-icon"></i>' + a + "&nbsp;&nbsp;" + o + "</div>", $("#warranty-seled-list").append(i);
                            var v = $(this).closest(".warranty-btn-wrap").find(".selected").attr("data");
                            $(this).closest(".warranty-btn-wrap").find(".warranty-btn").removeClass("selected"), $(this).addClass("selected");
                            var c = $("#ybId").val(c),
                                d = $(this).attr("data");
                            c = c.replace(v, d), $("#ybId").val(c), s && "" != l && s.attr("data-href", l + "&bindSkuId=" + $(this).attr("data"))
                        }
                })
            }
        };
        return t.init()
    },
    poptip = function (e) {
        var t, a, o, i, r, n = {callback: null},
            s = $.extend(n, e),
            l = {emptyErr: "请输入验证码", ruleErr: "验证码错误，请重新输入", overdueErr: "验证码过期，请重新输入"},
            c = '<div id="pop-floor" class="pop-floor J_ping" report-eventid="MProductdetail_IdentifyingCodeClose" report-eventlevel="5" report-pageparam="' + $("#currentWareId").val() + '"></div><div id="captchas-tip" class="captchas-tip">\t<div class="tip-title">领取优惠券</div>\t<div id="tip-coupon" class="tip-coupon"></div>\t<div class="captchas-info">\t\t<input class="captchas-input J_ping" report-eventid="MProductdetail_IdentifyingCodeInput" report-eventlevel="5" report-pageparam="' + $("#currentWareId").val() + '" id="captchas-input" maxlength="8" type="text" placeholder="请输入验证码">\t\t<img id="code"   class="captchas-img  J_ping" report-eventid="MProductdetail_IdentifyingCodeImage" report-eventlevel="5" report-pageparam="' + $("#currentWareId").val() + '" src="/authCode/authCodePinImg.action?key=' + s.codeKey + '"  onclick="com_jd_passport_m_validateCode(\'code\', \'codeKey\', \'115\')">\t\t<div id="tip-warn" class="tip-warn"></div>\t</div>\t<div class="captchas-btns">\t\t<a href="javascript:;" id="btn-cancel" class="tip-btn btn-cancel J_ping" report-eventid="MProductdetail_IdentifyingCodeCancel" report-eventlevel="5" report-pageparam="' + $("#currentWareId").val() + '">取消</a>\t\t<a href="javascript:;" id="btn-ensure" class="tip-btn btn-ensure J_ping" report-eventid="MProductdetail_IdentifyingCodeConfirm" report-eventlevel="5" report-pageparam="' + $("#currentWareId").val() + '">确定</a>\t</div></div>',
            d = {
                initModel: function () {
                    t = $("#pop-floor"), 0 == t.length && ($("body").append(c), t = $("#pop-floor")), a = $("#btn-cancel"), o = $("#btn-ensure"), i = document.documentElement.scrollTop || document.body.scrollTop, r = $("#captchas-tip").height(), r ? $("#captchas-tip").attr("data-selfHeight", r) : r = $("#captchas-tip").attr("data-selfHeight"), d.setBoxPos(), $("#body").addClass("fix-one-page")
                },
                setBoxPos: function (e) {
                    var t, a = $("#captchas-tip");
                    t = ((document.documentElement.clientHeight || document.documentElement.clientHeight) - r) / 2 + i, a.css("top", t + "px")
                },
                show: function () {
                    t.css("visibility", "visible"), $("#captchas-tip").css("visibility", "visible"), $("#captchas-tip").css("display", "block"), $("#captchas-input").val("")
                },
                hide: function () {
                    t.css("visibility", "hidden"), $("#captchas-tip").css("visibility", "hidden"), $("#captchas-tip").css("display", "none"), $("#body").removeClass("fix-one-page")
                }
            },
            u = function () {
                s.limitPlatform ? ($("#tip-coupon").addClass("tip-coupon-info"), null != s.limitMsg && void 0 != s.limitMsg && "null" != unescape(s.limitMsg) && $("#tip-coupon").html(unescape(s.limitMsg))) : $("#tip-coupon").removeClass("tip-coupon-info")
            },
            p = function () {
                var e = document.querySelector("#captchas-input").value.replace(/\s/g, "");
                e ? /^[a-zA-Z0-9]{3,5}$|^[\u4e00-\u9fa5]{3,5}$|^[\d]{1,3}$/gi.test(e) ? ($("#btn-ensure").unbind("click"), jQuery.ajax({
                    type: "POST",
                    url: "/coupon/getActiveCoupon.json",
                    data: {
                        sku: $("#currentWareId").val(),
                        codeKey: s.codeKey,
                        validateCode: e,
                        discount: s.discount,
                        encryptedKey: s.encryptedKey,
                        roleId: s.roleId,
                        isPop: $("#couponDivShow").attr("pop-data")
                    },
                    dataType: "json",
                    success: function (e) {
                        if (e && e.couponResult) {
                            $("#" + s.couponId).attr("onclick", "");
                            $("#" + s.couponId).append('<i class="x-already"></i>'), $("#tip-warn").css("visibility", "hidden").empty(), d.hide();
                            var t = {
                                cls: "succee-icon",
                                duration: 3e3,
                                message: "领取成功（5~10分钟到账）",
                                height: 88,
                                width: 220
                            };
                            showMessage(t), com_jd_passport_m_validateCode("code", "codeKey", "115")
                        } else if (e && e.error) {
                            $("#tip-warn").css("visibility", "hidden").empty(), d.hide();
                            var t = {cls: "error-icon", duration: 1e3, message: "系统繁忙，请稍后再试", height: 88, width: 180};
                            showMessage(t), $("#" + s.couponId).bind("click", function () {
                                p()
                            })
                        } else {
                            if (e && e.msg)
                                if (e.code && 3 == e.code) {
                                    var a = window.location.href;
                                    a && (a = a.split("#")[0]), $("#tip-warn").css("visibility", "visible").empty().html('<a class="J_ping"   report-eventid="MProductdetail_OpenPayPassword" report-pageparam="' + $("#currentWareId").val() + '"   style="color:red;border-bottom: 1px solid red;" href="https://passport.m.jd.com/payPassword/openPayPassword.action?urlFrom=1&returnurl=' + a + '">' + e.msg + "</a>")
                                } else if (e.code && 34 == e.code) try {
                                    d.hide();
                                    var o = document.querySelector(".certification-floor");
                                    o.style.display = "block", $(".one-btn-tip-box-tip").css({marginTop: -$(".one-btn-tip-box-tip").height() / 2}), $(".one-btn-tip-info").html("<span>" + e.msg + "</span>")
                                } catch (t) {
                                    $("#tip-warn").css("visibility", "visible").empty().html(e.msg)
                                } else $("#tip-warn").css("visibility", "visible").empty().html(e.msg);
                            else $("#tip-warn").css("visibility", "visible").empty().html("貌似有点小问题，您可以30秒后再试一下哟");
                            com_jd_passport_m_validateCode("code", "codeKey", "115"), $("#btn-ensure").bind("click", function () {
                                p()
                            })
                        }
                    },
                    error: function (e, t, a) {
                        if ($("#tip-warn").css("visibility", "hidden").empty(), d.hide(), "hidden" != $("#tip-warn").attr("visibility")) {
                            var o = {cls: "error-icon", duration: 1e3, message: "领券失败，请稍后再试", height: 88, width: 180};
                            showMessage(o)
                        }
                    }
                })) : $("#tip-warn").css("visibility", "visible").empty().html(l.ruleErr) : $("#tip-warn").css("visibility", "visible").empty().html(l.emptyErr)
            },
            m = function () {
                a.unbind("click"), o.unbind("click"), a.bind("click", function () {
                    d.hide(), $("#tip-warn").css("visibility", "hidden"), com_jd_passport_m_validateCode("code", "codeKey", "115")
                }), o.bind("click", function () {
                    p()
                }),
                    t.bind("click", function () {
                        d.hide(), $("#tip-warn").css("visibility", "hidden")
                    })
            };
        return function () {
            d.initModel(), d.show(), u(), m()
        }()
    },
    appointmentTip = function (e) {
        var t, a, o, i, r, n = {callback: null},
            s = $.extend(n, e),
            l = {emptyErr: "请输入验证码", ruleErr: "验证码错误，请重新输入", overdueErr: "验证码过期，请重新输入"},
            c = '<div id="pop-floor-yuyue" class="pop-floor  J_ping" report-eventid="MProductdetail_BookingShade" report-pageparam="' + $("#currentWareId").val() + '"></div><div id="captchas-tip-yuyue" class="captchas-tip">\t<div id="tip-title-yuyue" class="tip-title">立即预约</div>\t<div class="tip-coupon tip-coupon-info">需要验证码以完成预约</div>\t<div class="captchas-info">\t\t<input class="captchas-input J_ping" report-eventid="MProductdetail_BookingIdentifyingInput" report-pageparam="' + $("#currentWareId").val() + '" id="captchas-input-yuyue" maxlength="8" type="text" placeholder="请输入验证码">\t\t<img id="codeYuyue"   class="captchas-img  J_ping" report-eventid="MProductdetail_BookingIdentifyingPic" report-pageparam="' + $("#currentWareId").val() + '" src="/authCode/authCodePinImg.action?key=' + s.codeKey + '"  onclick="com_jd_passport_m_validateCode(\'codeYuyue\', \'codeKey\', \'112\')">\t\t<div id="tip-warn-yuyue" class="tip-warn"></div>\t</div>\t<div class="captchas-btns">\t\t<a href="javascript:;" id="btn-cancel-yuyue" class="tip-btn btn-cancel  J_ping" report-eventid="MProductdetail_BookingCancel" report-pageparam="' + $("#currentWareId").val() + '">取消</a>\t\t<a href="javascript:;" id="btn-ensure-yuyue" class="tip-btn btn-ensure J_ping" report-eventid="MProductdetail_BookingConfirm" report-pageparam="' + $("#currentWareId").val() + '">确定</a>\t</div></div>',
            d = {
                initModel: function () {
                    t = $("#pop-floor-yuyue"), 0 == t.length && ($("body").append(c), t = $("#pop-floor-yuyue")), a = $("#btn-cancel-yuyue"), o = $("#btn-ensure-yuyue"), i = document.documentElement.scrollTop || document.body.scrollTop, r = $("#captchas-tip-yuyue").height(), r ? $("#captchas-tip-yuyue").attr("data-selfHeight", r) : r = $("#captchas-tip-yuyue").attr("data-selfHeight"), d.setBoxPos(), $("#body").addClass("fix-one-page")
                },
                setBoxPos: function (e) {
                    var t, a = $("#captchas-tip-yuyue");
                    t = ((document.documentElement.clientHeight || document.documentElement.clientHeight) - r) / 2 + i, a.css("top", t + "px")
                },
                show: function () {
                    t.css("visibility", "visible"), $("#captchas-tip-yuyue").css("visibility", "visible"), $("#captchas-tip-yuyue").css("display", "block"), $("#captchas-input-yuyue").val("")
                },
                hide: function () {
                    t.css("visibility", "hidden"), $("#captchas-tip-yuyue").css("visibility", "hidden"), $("#captchas-tip-yuyue").css("display", "none"), $("#body").removeClass("fix-one-page")
                }
            },
            u = function () {
                var e = document.querySelector("#captchas-input-yuyue").value.replace(/\s/g, "");
                if (e)
                    if (/^[a-zA-Z0-9]{3,5}$|^[\u4e00-\u9fa5]{3,5}$|^[\d]{1,3}$/gi.test(e)) {
                        $("#btn-ensure-yuyue").unbind("click");
                        try {
                            jQuery.ajax({
                                type: "POST",
                                url: "/ware/appoint.json",
                                data: {
                                    wareId: $("#currentWareId").val(),
                                    codeKey: s.codeKey,
                                    validateCode: e,
                                    sid: $("#sid").val()
                                },
                                dataType: "json",
                                success: function (e) {
                                    if (e && e.isSuccess)
                                        if ("true" == e.isSuccess)
                                            if ($("#tip-warn-yuyue").css("visibility", "hidden").empty(), d.hide(), e.yuyueAppoint && e.yuyueAppoint.title) {
                                                var t = e.yuyueAppoint.title,
                                                    a = {
                                                        cls: "succee-icon",
                                                        duration: 5e3,
                                                        message: t,
                                                        height: 120,
                                                        width: 280
                                                    };
                                                (t.indexOf("重复预约") > -1 || t.indexOf("已经成功") > -1) && (a = {
                                                    cls: "succee-icon",
                                                    duration: 5e3,
                                                    message: t,
                                                    height: 100,
                                                    width: 250
                                                }), showMessage(a)
                                            } else {
                                                var a = {
                                                    cls: "error-icon",
                                                    duration: 1e3,
                                                    message: "系统繁忙，请稍后再试",
                                                    height: 88,
                                                    width: 180
                                                };
                                                showMessage(a)
                                            }
                                        else $("#tip-warn-yuyue").css("visibility", "visible").empty().html(l.ruleErr), $("#btn-ensure-yuyue").bind("click", function () {
                                            u()
                                        });
                                    else $("#tip-warn-yuyue").css("visibility", "visible").empty().html(l.ruleErr), $("#btn-ensure-yuyue").bind("click", function () {
                                        u()
                                    });
                                    com_jd_passport_m_validateCode("codeYuyue", "codeKey", "112")
                                },
                                error: function (e, t, a) {
                                    if ($("#tip-warn-yuyue").css("visibility", "hidden").empty(), d.hide(), "hidden" != $("#tip-warn-yuyue").attr("visibility")) {
                                        var o = {
                                            cls: "error-icon",
                                            duration: 1e3,
                                            message: "预约失败，请稍后再试",
                                            height: 88,
                                            width: 180
                                        };
                                        showMessage(o)
                                    }
                                    com_jd_passport_m_validateCode("codeYuyue", "codeKey", "112")
                                }
                            })
                        } catch (e) {
                            var t = {cls: "error-icon", duration: 1e3, message: "系统繁忙，请稍后再试", height: 88, width: 180};
                            showMessage(t)
                        }
                    } else $("#tip-warn-yuyue").css("visibility", "visible").empty().html(l.ruleErr);
                else $("#tip-warn-yuyue").css("visibility", "visible").empty().html(l.emptyErr)
            },
            p = function () {
                a.unbind("click"), o.unbind("click"), a.bind("click", function () {
                    d.hide(), $("#tip-warn-yuyue").css("visibility", "hidden"), com_jd_passport_m_validateCode("codeYuyue", "codeKey", "112")
                }), o.bind("click", function () {
                    u()
                }), t.bind("click", function () {
                    d.hide(), $("#tip-warn-yuyue").css("visibility", "hidden")
                })
            };
        return function () {
            d.initModel(), d.show(), p()
        }()
    },
    validateCode = {
        refreshLoginCodeAjax: function (e, t, a, o) {
            $.post(e || "/authCode/createCodeWithPinKey.json", {args: o}, function (e) {
                if (e && (e = JSON.parse(e), e.codeKey)) {
                    var o = "/authCode/authCodePinImg.action?key=" + e.codeKey + "&rand=" + validateCode.getRandomNum(1, 1e6);
                    o = encodeURI(encodeURI(o)), $("#" + t).attr("src", o), $("#" + a).val(e.codeKey)
                }
            })
        },
        getValidateCode: function (e, t, a) {
            setTimeout(function () {
                validateCode.refreshLoginCodeAjax("", e, t, a)
            }, 500)
        },
        getRandomNum: function (e, t) {
            var a = t - e,
                o = Math.random();
            return e + Math.round(o * a)
        }
    };
!function () {
    "true" === $("#itemSeoFlag").val() && $.ajax({
        type: "GET",
        url: "/seo/triggerItemSeo.json",
        data: {wareId: $("#currentWareId").val()},
        dataType: "json",
        success: function (e) {
        },
        error: function (e, t, a, o) {
        }
    })
}(), window.UtilsClass = {
    Request: function () {
        for (var e = new Object, t = location.search.substring(1), a = t.split("&"), o = 0; o < a.length; o++) {
            var i = a[o].indexOf("=");
            if (-1 != i) {
                var r = a[o].substring(0, i),
                    n = a[o].substring(i + 1);
                n = decodeURIComponent(n), e[r] = n
            }
        }
        return e
    }
}, window.REQUEST = window.UtilsClass.Request();
var oldToastConfig = {
        _0: {message: "加入购物车成功", cls: "succee-icon", width: 180, height: 88, duration: 2e3},
        _1: {cls: "error-icon", message: "购物车塞满了，先把选好的商品下单吧", width: 270, height: 88, duration: 2e3},
        _2: {cls: "error-icon", message: "请前往购物车查看", width: 220, height: 88, duration: 2e3},
        _6: {cls: "error-icon", message: "购物车商品太多，加入购物车失败", width: 240, height: 88, duration: 2e3},
        _16: {cls: "error-icon", width: 240, height: 88, duration: 2e3},
        _00: {cls: "error-icon", message: "加入购物车失败，请稍后重试", width: 220, height: 88, duration: 2e3}
    },
    isXnzt = "0",
    isSamSku = !1,
    isSamCard = !1,
    isSamMember = !1,
    isSamMemberAddcart = !1,
    isSamMemberBName = "",
    isOilCard = !1,
    addCartBizName = "",
    isCustomize = !1,
    addCartURL = "",
    isGameCharge = !1,
    isPrescribedDrug = !1,
    isJdEcard = !1,
    isFqyProduct = !1,
    hasAddCartNode = !1,
    orderEvent = "",
    buttonDisabledWhenNoStock = !1,
    notCallLvBizNames = [],
    isFreshCard = document.getElementById("isFreshCard") ? document.getElementById("isFreshCard").value : "false",
    commonConfig, commonConfigJsonNode = document.getElementById("commonConfigJson"),
    commonConfigJson, carAndOrderschemel = "https:",
    isHk = "false",
    isJdOtc = "false",
    isOtc = "false",
    wareType = "0",
    eventParam = "",
    easyByEventparam = "";
commonConfigJsonNode && (commonConfigJson = commonConfigJsonNode.value);
var isYuyue = !1,
    isYushou = !1,
    isMiaosha = !1,
    isHasWarrantyCheck = $("#isHasyanBao").val(),
    isSoldOversea = "false",
    isSingleBuyBtn = !1;
initParam();
for (var aAactionListA = document.querySelectorAll(".action-list a"), i = 0; i < aAactionListA.length; i++) aAactionListA[i].innerHTML = aAactionListA[i].innerHTML.replace(/(^\s*)|(\s*$)/g, "");
toastShow(), changeSchemel();
var oOverseaTip = document.querySelector(".oversea-tip"),
    oOverseaMenu = document.querySelector(".oversea-menu"),
    oFlickMenuMask = document.querySelector(".flick-menu-mask"),
    oOverseaMenuCon = document.querySelector(".oversea-menu-content"),
    oOverseaMenuClose = document.querySelector(".oversea-menu-close"),
    oOverseaOk = document.querySelector(".oversea-ok"),
    oSpecBtn = document.getElementById("natureID"),
    oSpecMenuCon = document.querySelector(".spec-menu-content"),
    oSpecMenuClose = document.querySelector(".spec-menu-close"),
    oYbId = document.getElementById("ybId"),
    oSpecMenuMiddle = document.querySelector(".spec-menu-middle"),
    pingIndex = 0,
    oServiceFloor = document.querySelector(".service-floor"),
    oServiceMenu = document.querySelector(".service-menu"),
    oServiceOkBtn = document.querySelector(".service-ok-btn"),
    oServiceMenuClose = document.querySelector(".service-menu-close");
popupsOpenTrigger(oOverseaTip, oFlickMenuMask, oOverseaMenuCon, "oversea-menu-show", "oversea-menu-hide"), popupsCloseTrigger(oOverseaMenuClose, oFlickMenuMask, oOverseaMenuCon, "oversea-menu-show", "oversea-menu-hide"), popupsCloseTrigger(oOverseaOk, oFlickMenuMask, oOverseaMenuCon, "oversea-menu-show", "oversea-menu-hide"), oSpecMenuMiddle.addEventListener("scroll", function (e) {
    e.target.scrollTop > 100 && 0 == pingIndex && (pingClickWithLevel("MProductdetail_SpecificationSlide", "", "", "", ""), pingIndex++)
}, !1), popupsOpenTrigger(oSpecBtn, oFlickMenuMask, oSpecMenuCon, "spec-menu-show", "spec-menu-hide", function () {
    pingClickWithLevel("MProductdetail_SpecificationWindow", "", "", "", "4")
}, function () {
    "true" == isHasWarrantyCheck ? $(".warranty-wrap").css("display", "block") : $(".warranty-wrap").css("display", "none"), $("#directorder_spec").hasClass("ok_spec_btn") && $("#directorder_spec").removeClass("ok_spec_btn"), updateSpecBottomButton()
}), popupsCloseTrigger(oSpecMenuClose, oFlickMenuMask, oSpecMenuCon, "spec-menu-show", "spec-menu-hide", function () {
    pingClickWithLevel("MProductdetail_SpecificationClose", "", "", "", "")
}, function () {
    specPopupsCloseExtendCb()
}), popupsOpenTrigger(oServiceFloor, oFlickMenuMask, oServiceMenu, "service-menu-show", "service-menu-hide"), popupsCloseTrigger(oServiceOkBtn, oFlickMenuMask, oServiceMenu, "service-menu-show", "service-menu-hide"), popupsCloseTrigger(oServiceMenuClose, oFlickMenuMask, oServiceMenu, "service-menu-show", "service-menu-hide"), oFlickMenuMask && oFlickMenuMask.addEventListener("click", function () {
    oOverseaMenuCon && "block" == oOverseaMenuCon.style.display ? popupsClose(oFlickMenuMask, oOverseaMenuCon, "oversea-menu-show", "oversea-menu-hide") : oSpecMenuCon && "block" == oSpecMenuCon.style.display ? popupsClose(oFlickMenuMask, oSpecMenuCon, "spec-menu-show", "spec-menu-hide", function () {
        pingClickWithLevel("MProductdetail_SpecificationMask", "", "", "", "")
    }, function () {
        specPopupsCloseExtendCb()
    }) : oServiceMenu && "block" == oServiceMenu.style.display && popupsClose(oFlickMenuMask, oServiceMenu, "service-menu-show", "service-menu-hide")
}, !1), $(function () {
    function e() {
        var t, a, o, i, r, n = (new Date).getTime() / 1e3,
            s = parseInt(b - n);
        s >= 0 && (t = Math.floor(s / 86400), a = Math.floor((s - 86400 * t) / 3600), o = Math.floor((s - 86400 * t - 3600 * a) / 60), i = Math.floor(s - 86400 * t - 3600 * a - 60 * o), r = parseInt(t) > 0 ? t + "天" + a + "小时" + o + "分钟" : a + "小时" + o + "分钟" + i + "秒", "1" == I ? $("#prompt_msg").text("距预约开始还有" + r) : "2" == I ? $("#prompt_msg").text("距预约结束还有" + r) : "3" == I ? $("#prompt_msg").text("距抢购开始还有" + r) : "4" == I && ("true" == $("#cartFlag").val() && $("#stockStatus").text().indexOf("抱歉") <= 0 ? $("#prompt_msg").text("距抢购结束还有" + r) : $("#stockStatus").text() ? $("#prompt_msg").text($("#stockStatus").text()) : $("#prompt_msg").text("抱歉，所选地区暂时无货")), 0 == parseInt(s) && window.location.reload(), s > 0 && setTimeout(function () {
            e()
        }, 1e3))
    }

    try {
        $("#puller") && $("#puller").generateRegionList({
            actionURL: "/ware/thirdAddress.json?checkParam=" + $("#addressSign").val(),
            wareID: $("#currentWareId").val(),
            initFlag: !0
        })
    } catch (e) {
    }
    try {
        var t = navigator.userAgent,
            a = !!t.match(/MQQBrowser/i),
            o = !!t.match(/MicroMessenger/i);
        if (commonConfig && commonConfig.thirdAppToQQBrowser && "true" == commonConfig.thirdAppToQQBrowser) {
            var i = document.createElement("iframe");
            i.style.cssText = "display:none;width:0px;height:0px;", document.body.appendChild(i);
            var r = (new Date).getTime(),
                n = getCookie("__jdv"),
                s = "";
            if (n && "" != n && n.split("|").length >= 6) {
                var l = n.split("|");
                s = "&utm_source=" + l[1] + "&utm_campaign=" + l[2] + "&utm_media=" + l[3] + "&utm_term=" + l[4]
            }
            var c = "mttbrowser://url=http://item.m.jd.com/product/" + $("#currentWareId").val() + ".html?thirdAppParam=thirdApp" + s + ",ChannelID=com.jd.m,encoded=0,PosID=102,openqbtime=" + r + ",windowType=1";
            i.src = c, a && !o || (i.src = c)
        }
    } catch (e) {
    }
    try {
        var d = $("#wxIPhoneControul").val(),
            u = $("#couponDetailShow").val();
        if ("" != d && "true" == d && ("" == u || null == u || void 0 == u)) {
            var i = (new Date, document.createElement("iframe"));
            i.style.cssText = "display:none;width:0px;height:0px;", document.body.appendChild(i);
            var p = $("#resourceType").val(),
                m = $("#resourceValue").val();
            "" != p && null != p && void 0 != p && "M_APP_SAOMA" == p || (p = "MWEIXIN_PRODUCT_TYPE", m = "MWEIXIN_PRODUCT_VALUE");
            var v = 'openApp.jdMobile://virtual?params={"category":"jump","des":"productDetail","skuId":"' + $("#currentWareId").val() + '","sourceType":"' + p + '","sourceValue":"' + m + '"}';
            try {
                var g = [];
                try {
                    g.push('"m_param":' + MPing.EventSeries.getSeries())
                } catch (e) {
                    g.push('"m_param":null')
                }
                var h = g.join(",");
                h && (v = v.split("}")[0] + "," + h + "}")
            } catch (e) {
            }
            i.src = v
        }
    } catch (e) {
    }
    var f = window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft,
        y = document.documentElement.clientWidth || document.body.clientWidth,
        w = f - 114 + y / 2,
        C = f - 135 + y / 2;
    document.getElementById("cart").style.left = w + "px", document.getElementById("tip").style.left = C + "px", newDetailInit(), $("#cartyuyue").bind("click", function () {
        jQuery.ajax({
            url: urlEncode("/ware/isAppoint.json", $("#sid").val()),
            data: {wareId: $("#currentWareId").val()},
            dataType: "json",
            success: function (e) {
                try {
                    if (e && 1 == e.isAppoint) addWareToCart();
                    else {
                        $("#tip").css("display", "block"), e && null != e.text && "" != e.text ? $(".pop-txt").text(e.text) : $(".pop-txt").text("系统繁忙,请稍后再试!");
                        var t = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop,
                            a = document.documentElement.clientHeight || document.body.clientHeight;
                        document.getElementById("tip").style.bottom = (a - 100) / 2 - t + "px", $("#myyuyue").css("display", "none")
                    }
                } catch (e) {
                    window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html"
                }
            },
            error: function (e) {
                window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html"
            }
        })
    }), $("#focusOn").bind("click", function () {
        var e = document.getElementById("focusOn"),
            t = e.querySelector(".btm-act-icn"),
            a = t.className;
        -1 == a.indexOf("focus-out") ? jQuery.ajax({
            url: urlEncode("/user/cancelFavorite.json", $("#sid").val()),
            data: {wareId: $("#currentWareId").val()},
            dataType: "json",
            success: function (o) {
                try {
                    if ($("#ref_host").val(o.ref_host), $("#start").val(o.start), null != o && "true" == o.rstFlag) {
                        t.className = a.replace("focus-on", "focus-out"), $(e).find(".btm-act-icn").removeClass("click-focus-show"), $(e).find(".focus-scale").css("display", "none"), $(e).find(".focus-info").text("关注");
                        var i = {cls: "succee-icon", duration: 1e3, message: "取消关注", height: 88, width: 180};
                        showMessage(i)
                    }
                } catch (e) {
                    window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html"
                }
            },
            error: function (e) {
                window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html"
            }
        }) : jQuery.ajax({
            url: urlEncode("/user/addFavorite.json", $("#sid").val()),
            data: {wareId: $("#currentWareId").val()},
            dataType: "json",
            success: function (o) {
                try {
                    if (null != o && "true" == o.rstFlag) {
                        t.className = a.replace("focus-out", "focus-on"), $(e).find(".focus-scale").css("display", "inline-block"), $(e).find(".btm-act-icn").attr("class", "btm-act-icn focus-on click-focus-show"), $(e).find(".focus-scale").attr("class", "focus-scale focus-scale-show"), $(e).find(".focus-info").text("已关注");
                        var i = {cls: "succee-icon", duration: 1e3, message: "关注成功", height: 88, width: 180};
                        showMessage(i)
                    }
                } catch (e) {
                    window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html"
                }
            },
            error: function (e) {
                window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html"
            }
        })
    });
    var S = function () {
        var e = $("#sid").val(),
            t = carAndOrderschemel + "//p.m.jd.com/cart/cart.action";
        pingClickWithLevel("MProductdetail_GotoCart", $("#currentWareId").val(), "", $("#currentWareId").val(), "5"), null != e && "" != e && (t += "?sid=" + e), window.location.href = t
    };
    buyBtnBindHandle(), $("#toCart").length > 0 && $("#toCart").click(S);
    var b, I;
    I = $("#yuyueType").val();
    $("#changeSkuFlag").val();
    if ("true" == $("#isYuYue").val()) switch (I) {
        case "1":
            $("#bottom_prompt_msg_div").show(), $(".hold-div-bottom").attr("style", "display:block"), b = (new Date).getTime() / 1e3 + parseInt($("#yuYueStartTime").val().length > 0 ? $("#yuYueStartTime").val() : 0), e();
            break;
        case "2":
            $("#bottom_prompt_msg_div").show(), $(".hold-div-bottom").attr("style", "display:block"), b = (new Date).getTime() / 1e3 + parseInt($("#yuYueEndTime").val().length > 0 ? $("#yuYueEndTime").val() : 0), e();
            break;
        case "3":
            $("#bottom_prompt_msg_div").show(), $(".hold-div-bottom").attr("style", "display:block"), "" != $("#buyStartTime").val() && null != $("#buyStartTime").val() && $("#buyStartTime").val().length > 0 ? (b = (new Date).getTime() / 1e3 + parseInt($("#buyStartTime").val().length > 0 ? $("#buyStartTime").val() : 0), e()) : $("#prompt_msg").text("抢购未开始，敬请关注");
            break;
        case "4":
            $("#bottom_prompt_msg_div").show(), $(".hold-div-bottom").attr("style", "display:block"), "false" == $("#cartFlag").val() && ($(".buyImmediately").addClass("disabled"), $(".buyImmediately").unbind("click")), b = (new Date).getTime() / 1e3 + parseInt($("#buyEndTime").val().length > 0 ? $("#buyEndTime").val() : 0), e();
            break;
        case "5":
            "true" == $("#isYuYue").val() && ($("#bottom_prompt_msg_div").hide(), $(".hold-div-bottom").attr("style", "display:none")), bottom618()
    } else {
        var k = $("#koInfoLeft").val(),
            _ = $("#koInfoState").val(),
            x = $(".add_cart");
        "true" == $("#cartFlag").val() ? ("1" == $("#type").val() && "" != $("#koInfo").val() ? "12" == _ ? ($("#bottom_prompt_msg_div").hide(), $(".hold-div-bottom").attr("style", "display:none")) : "13" == _ && (x.addClass("disabled").html("抢购结束").unbind("click"), $("#bottom_prompt_msg_div").hide(), $(".hold-div-bottom").attr("style", "display:none;")) : ($("#bottom_prompt_msg_div").hide(), $(".hold-div-bottom").attr("style", "display:none"), bottom618()), isSamCard && isSamMember && ($(".add_cart").addClass("disabled"), $(".add_cart").unbind("click"))) : "1" == $("#type").val() && "" != $("#koInfo").val() ? "11" == _ && (duliGetTimes(k), $("#bottom_prompt_msg_div").show(), $(".hold-div-bottom").attr("style", "display:block;"), x.addClass("disabled").html("等待抢购").unbind("click")) : ($("#bottom_prompt_msg_div").show(), $(".hold-div-bottom").attr("style", "display:block"), $("#stockStatus").text() ? $("#prompt_msg").text($("#stockStatus").text()) : "" != $("#reasonTips").val() ? $("#prompt_msg").text($("#reasonTips").val()) : ($("#bottom_prompt_msg_div").hide(), $(".hold-div-bottom").attr("style", "display:none"), bottom618()), "true" == isJdOtc || "true" == isHk || isSamCard || isCustomize || isPrescribedDrug || hasAddCartNode && buttonDisabledWhenNoStock ? ($(".add_cart").addClass("disabled"), $(".add_cart").unbind("click")) : ($(".add_cart").hide(), $(".directorder").hide(), changeSkuShowOrHide(!0), "true" == $("#stockNotice").val() ? ($(".arrivalInform").show(), $("#cart1").hasClass("four-column-l3r1") && ($("#cart1").removeClass("four-column-l3r1"), $("#cart1").addClass("five-column")), $("#cart1").hasClass("three-column") && ($("#cart1").removeClass("three-column"), $("#cart1").addClass("four-column")), $("#cart1").hasClass("four-column") && ($("#cart1").removeClass("four-column"), $("#cart1").addClass("four-column")), $(".looksimilar").hasClass("red-color") && ($(".looksimilar").addClass("yellow-color"), $(".looksimilar").removeClass("red-color"))) : ($(".arrivalInform").hide(), $("#cart1").hasClass("five-column") && ($("#cart1").removeClass("five-column"), $("#cart1").addClass("four-column-l3r1")), $("#cart1").hasClass("four-column") && ($("#cart1").removeClass("four-column"), $("#cart1").addClass("three-column")), $(".looksimilar").hasClass("yellow-color") && ($(".looksimilar").addClass("red-color"), $(".looksimilar").removeClass("yellow-color")))))
    }
    isSamCard && !isSamMemberAddcart && ($(".add_cart").addClass("disabled"), $(".add_cart").unbind("click"));
    var T = $("#arrvalinTel"),
        P = $("#arrvalinMsg");
    T.onblur = function () {
        var e = handlePhone(T.value);
        "0" != e[0] && (T.value = "", P.text(e[1]), P.show())
    }, T.onfocus = function () {
        P.hide()
    }, $("#depreciatebt").bind("click", function () {
        if ("0" == handlePhone($.trim($("#arrvalinTel").val()))[0]) {
            var e = $("#btn-select-region").attr("region-data"),
                t = e.split(","),
                a = t.length;
            a <= 2 ? t.push([0, 0]) : 3 == a && t.push(0), e = t.join(","), jQuery.ajax({
                url: "/ware/skuNotice.json",
                data: {
                    sid: $("#sid").val(),
                    skuId: $("#currentWareId").val(),
                    phoneNo: $("#arrvalinTel").val(),
                    address: e
                },
                dataType: "json",
                success: function (e) {
                    try {
                        if (e && e.skuNotice) {
                            var t = document.getElementById("productInformFloor"),
                                a = document.getElementById("arrvalInformBlock"),
                                o = document.getElementsByTagName("body")[0];
                            if (o.removeChild(t), a.style.display = "none", 0 == e.skuNotice.code) {
                                var i = {cls: "succee-icon", duration: 1e3, message: "操作成功", height: 88, width: 180};
                                showMessage(i)
                            } else {
                                var i = {
                                    cls: "error-icon",
                                    duration: 1e3,
                                    message: "系统繁忙，请稍后再试",
                                    height: 88,
                                    width: 180
                                };
                                showMessage(i)
                            }
                            return
                        }
                        var t = document.getElementById("productInformFloor"),
                            a = document.getElementById("arrvalInformBlock"),
                            o = document.getElementsByTagName("body")[0];
                        o.removeChild(t), a.style.display = "none";
                        var i = {cls: "error-icon", duration: 1e3, message: "系统繁忙，请稍后再试", height: 88, width: 180};
                        return void showMessage(i)
                    } catch (e) {
                        var t = document.getElementById("productInformFloor"),
                            a = document.getElementById("arrvalInformBlock"),
                            o = document.getElementsByTagName("body")[0];
                        o.removeChild(t), a.style.display = "none";
                        var i = {cls: "error-icon", duration: 1e3, message: "系统繁忙，请稍后再试", height: 88, width: 180};
                        return void showMessage(i)
                    }
                },
                error: function (e) {
                    window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + $("#sid").val() + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html"
                }
            })
        }
    }), $(".buyImmediately").bind("click", function () {
        $(".buyImmediately").hasClass("disabled") || buyImmediatelyClickFunction()
    }), $(".makeAppointments").bind("click", function () {
        isSpecWindowOpen() ? pingClickWithLevel("MProductdetail_SubscribeImmediately", "W", "", $("#currentWareId").val(), "5") : pingClickWithLevel("MProductdetail_SubscribeImmediately", "N", "", $("#currentWareId").val(), "5"), makeAppointment()
    });
    if ($("#imBottom").length > 0) {
        var z = "";
        z = commonConfig && commonConfig.shopUrlConf ? "https://chat.jd.com/merchant/index?v=6&sku=" + $("#currentWareId").val() + "&imgUrl=" + $("#imgUrl").val() + "&goodName=" + encodeURIComponent(encodeURIComponent($("#goodName").val())) + "&jdPrice=" + $("#jdPrice").val() + "&sid=" + $("#sid").val() + "&entry=m_item" : "https://im.m.jd.com/merchant/index?v=6&sku=" + $("#currentWareId").val() + "&imgUrl=" + $("#imgUrl").val() + "&goodName=" + encodeURIComponent(encodeURIComponent($("#goodName").val())) + "&jdPrice=" + $("#jdPrice").val() + "&sid=" + $("#sid").val(), $("#imBottom").attr("href", z)
    }
    var L = $("#cartJson").val();
    L && "true" == L && $.post("/cart/cartNum.json", {sid: $("#sid").val()}, function (e) {
        if (e && e.cartJson && e.cartJson.Num) {
            var t = e.cartJson.Num;
            null != t && void 0 != t && 0 != t.length && parseInt(t) > 0 && (parseInt(t) > 99 ? $("#carNum").text("99+") : $("#carNum").text(t))
        }
    }, "json"), "" == d || "true" != d || "" != u && null != u && void 0 != u ? $("#weixinAbtest").val() && "true" == $("#weixinAbtest").val() && $("#computControul").val() && "true" == $("#computControul").val() && setTimeout(function () {
        try {
            pingClick("ProductDetail_ToAPP_Virtual", "Test B", "", $("#currentWareId").val())
        } catch (e) {
        }
    }, 100) : setTimeout(function () {
        try {
            pingClick("ProductDetail_ToAPP_Virtual", "Test A", "", $("#currentWareId").val())
        } catch (e) {
        }
    }, 100);
    try {
        var j = jdM.sessionstorage.get("skuIdNum");
        j && 2 == j.split("-").length && $("#currentWareId").val() == j.split("-")[0] ? ($("#number").val(j.split("-")[1]), modify()) : jdM.sessionstorage.remove("skuIdNum")
    } catch (e) {
    }
    picShowGoback(), replyListGoBack(), warePicShowGoback(), isPrescribedDrug && setDrugCartNum(), isJdEcard && setjdECartNum()
});
var eTime, newAddWare = function (e, t, a, o, i, r, n) {
        var s = "";
        try {
            var l = $("#dist").val();
            l && "jd" == l && (s = "&dist=jd")
        } catch (e) {
        }
        eTime = (new Date).getTime() / 1e3 + 4;
        var c = getCookie("USER_FLAG_CHECK");
        if (isNotBlank(a) && a) {
            var d = $("#newOrderServer").val();
            if (o) var u = "//p.m.jd.com/cart/addDirOrder.json?wareId=" + e + "&num=" + t + "&suitSkuId=" + e + "&suitSkuNum=" + t + (isNotBlank(a) && a ? "&isAjax=" + a : "") + "&sType=8&ybId=" + o + "&resourceType=" + i + "&resourceValue=" + r + (isNotBlank(n) && "" != n ? "&sid=" + n : "") + "&USER_FLAG_CHECK=" + c;
            else var u = "//p.m.jd.com/cart/addDirOrder.json?wareId=" + e + "&num=" + t + (isNotBlank(a) && a ? "&isAjax=" + a : "") + "&resourceType=" + i + "&resourceValue=" + r + (isNotBlank(n) && "" != n ? "&sid=" + n : "") + "&USER_FLAG_CHECK=" + c;
            jQuery.get(u, function () {
                afterAddCart("2", u, ""), window.location.href = "true" == d ? carAndOrderschemel + "//p.m.jd.com/norder/order.action?wareId=" + e + "&wareNum=" + t + "&enterOrder=true" + (isNotBlank(n) && "" != n ? "&sid=" + $("#sid").val() : "") : carAndOrderschemel + "//p.m.jd.com/order/order.action?wareId=" + e + "&wareNum=" + t + "&enterOrder=true&yys=false&from=0" + (isNotBlank(n) && "" != n ? "&sid=" + $("#sid").val() : "")
            })
        } else {
            if (o) var p = "//p.m.jd.com/cart/add.json?wareId=" + e + "&num=" + t + "&suitSkuId=" + e + "&suitSkuNum=" + t + (isNotBlank(a) && a ? "&isAjax=" + a : "") + "&sType=8&ybId=" + o + "&resourceType=" + i + "&resourceValue=" + r + (isNotBlank(n) && "" != n ? "&sid=" + n : "") + "&USER_FLAG_CHECK=" + c + s;
            else var p = "//p.m.jd.com/cart/add.json?wareId=" + e + "&num=" + t + (isNotBlank(a) && a ? "&isAjax=" + a : "") + "&resourceType=" + i + "&resourceValue=" + r + (isNotBlank(n) && "" != n ? "&sid=" + n : "") + "&USER_FLAG_CHECK=" + c + s;
            ajax(p, function (e) {
                afterAddCart("1", p, e), $("#addCartLoading").length > 0 && $("#addCartLoading").val() && "true" == $("#addCartLoading").val() && $(".cart-loading-icon").css("display", "none");
                var t = JSON.parse(e).sid;
                $("#sid").val(t);
                var a = JSON.parse(e);
                if (a && a.cartJson && a.cartJson.Num) {
                    var o = a.cartJson.Num;
                    parseInt(o) > 0 && addNumberShow(parseInt(o))
                }
                var i = {code: a.cartJson.resultCode, msg: a.cartJson.resultMsg};
                if (isSpecWindowOpen()) popupsClose(oFlickMenuMask, oSpecMenuCon, "spec-menu-show", "spec-menu-hide", "", function () {
                    specPopupsCloseExtendCb(i)
                });
                else {
                    var r = {};
                    r = "16" == i.code ? $.extend(r, oldToastConfig._16, {message: i.msg}) : $.extend(r, oldToastConfig["_" + i.code]), showMessage(r)
                }
            }, function () {
                $("#addCartLoading").length > 0 && $("#addCartLoading").val() && "true" == $("#addCartLoading").val() && ($(".cart-loading-icon").css("display", "none"), isSpecWindowOpen() ? popupsClose(oFlickMenuMask, oSpecMenuCon, "spec-menu-show", "spec-menu-hide", "", function () {
                    specPopupsCloseExtendCb({code: 2})
                }) : showMessage(oldToastConfig._2))
            })
        }
    },
    judgeKO = function (e, t, a) {
        var o = "/ware/judgeOrder.json?wareId=" + e + (isNotBlank(t) && "" != t ? "&sid=" + t : "") + "&businessName=" + a;
        ("customize" == a || "gameCharge" == a || isAddCartBizName(a)) && (o += "&addCartLink=" + encodeURIComponent(addCartURL));
        ajax(o, function (e) {
            try {
                var o = JSON.parse(e);
                if (o && o.url) {
                    $("#addCartLoading").length > 0 && $("#addCartLoading").val() && "true" == $("#addCartLoading").val() && $(".cart-loading-icon").css("display", "none");
                    var i = $("#freshCardUrl").val();
                    if (isFreshCard && "true" == isFreshCard && i) return void(window.location.href = i);
                    if (isFreshCard && "true" == isFreshCard && !i) return void $(".add_cart").addClass("disabled");
                    if (a && "oilCardService" == a) window.location.href = o.url;
                    else if (a && "customize" == a) {
                        var r = o.url + "#index/sku:" + $("#currentWareId").val() + "/num:" + $("#number").val();
                        $("#size").length > 0 && $("#size").find("a.selected").text() && (r += "/size:" + encodeURIComponent($("#size").find("a.selected").text())), $("#color").length > 0 && $("#color").find("a.selected").text() && (r += "/color:" + encodeURIComponent($("#color").find("a.selected").text())), $("#spec").length > 0 && $("#spec").find("a.selected").text() && (r += "/spec:" + encodeURIComponent($("#spec").find("a.selected").text())), window.location.href = r
                    } else if (a && "gameCharge" == a) goToGameCharge(o.url);
                    else if (isAddCartBizName(a)) window.location.href = o.url;
                    else {
                        if ("" != $("#isAuth").val()) return void $.toast({
                            message: $("#goAuthToast").val(),
                            styleType: 3,
                            autoClose: !1,
                            isMaskClose: !0,
                            btns: {cancelTxt: "取消", okTxt: "去实名认证"},
                            okCallback: function () {
                                var e = encodeURIComponent(o.url + "&sid=" + t);
                                window.location.href = "https://msc.jd.com/auth/loginpage/wcoo/toAuthPage?source=4&businessType=394&directReturnUrl=" + e
                            },
                            closeCallback: function () {
                            }
                        });
                        window.location.href = o.url + "&sid=" + t
                    }
                } else o && o.text && alert(o.text)
            } catch (e) {
                $("#addCartLoading").length > 0 && $("#addCartLoading").val() && "true" == $("#addCartLoading").val() && $(".cart-loading-icon").css("display", "none"), window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + t + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html"
            }
        }, function () {
            if ($("#addCartLoading").length > 0 && $("#addCartLoading").val() && "true" == $("#addCartLoading").val()) {
                $(".cart-loading-icon").css("display", "none");
                var e = {cls: "error-icon", duration: 2e3, message: "请前往购物车查看", width: 220, height: 88};
                showMessage(e)
            }
        })
    },
    xmlHttp, ajax = function (e, t, a, o) {
        function i() {
            if (4 == xmlHttp.readyState || "complete" == xmlHttp.readyState) try {
                t.call(this, xmlHttp.responseText, o)
            } catch (e) {
            }
        }

        function r() {
            a.call(this, xmlHttp.responseText, o)
        }

        return 0 == e.length ? "" : null != (xmlHttp = function () {
            var e = null;
            try {
                e = new XMLHttpRequest
            } catch (t) {
                try {
                    e = new ActiveXObject("Msxml2.XMLHTTP")
                } catch (t) {
                    e = new ActiveXObject("Microsoft.XMLHTTP")
                }
            }
            return e
        }()) && (e = e + "&ran=" + Math.random(), xmlHttp.onreadystatechange = i, xmlHttp.open("GET", e, !0), xmlHttp.timeout = 5e3, xmlHttp.ontimeout = r, xmlHttp.send(null), !0)
    };
if (function () {
        var e = $("[data-bling]"),
            t = "2000",
            a = "s",
            o = $("<div>").addClass("x-bottom-glass-wrap").append('<span class="x-bottom-glass"></span>');
        e.each(function (e) {
            var i = $(this).data("bling"),
                r = document.documentElement.clientWidth,
                n = $(this).width();
            t = i || t, a = n <= r / 3 ? "s" : n <= r / 3 * 2 ? "m" : "l", o.css("animation", "blingbling-" + a + " 10s " + t + "ms infinite"), $(this).append(o.clone(!0)).css("position", "relative").css("overflow", "hidden")
        })
    }(), "true" == window.REQUEST.isAuth) {
    var idAuthToast = $("#idAuthToast").val();
    idAuthToast && "null" != idAuthToast && $.toast({
        cls: "succee-icon",
        message: idAuthToast,
        autoCloseCb: function () {
            window.history.replaceState(null, window.title, window.location.href.replace(/\?isAuth=true/g, ""))
        }
    })
}
if (window.REQUEST.addCartToast) {
    var _config = {};
    if ("16" == window.REQUEST.addCartToast) {
        var msg = getCookie("addCartToastMsg");
        _config = $.extend(_config, oldToastConfig._16, {message: msg})
    } else _config = $.extend(_config, oldToastConfig["_" + window.REQUEST.addCartToast]);
    showMessage(_config), setTimeout(function () {
        window.history.replaceState(null, window.title, window.location.href.replace(/\?addCartToast=(\d*)/g, ""))
    }, 2e3)
}
var currentColorSizeSpec = "";
!function () {
    function depreciatePop(btnID, boxId) {
        function appearFrame(myid) {
            floor = document.createElement("div"), floor.className = "product-inform-floor J_ping", floor.id = "productInformFloor", floor.style.height = document.documentElement.offsetHeight + "px", floor.style.display = "block", floor.setAttribute("report-eventid", "MProductdetail_ArrivalMask"), floor.setAttribute("report-eventlevel", "5"), floor.setAttribute("report-pageparam", $("#currentWareId").val()), oBody.appendChild(floor), ProScrollH = document.documentElement.scrollTop || document.body.scrollTop, ProClientH = document.documentElement.clientHeight, myid.style.display = "block", myid.style.visibility = "visible", myid.style.top = ProScrollH + .5 * ProClientH - myid.offsetHeight / 2 + "px", phoneNum.value = "", phoneNumPrompt.innerHTML = "", phoneNumPrompt.style.visibility = "hidden", floor.onclick = function () {
                oBody.removeChild(floor), oBox.style.display = "none", oBox.style.visibility = "hidden"
            }, cancelButt.onclick = function () {
                oBody.removeChild(floor), oBox.style.display = "none", oBox.style.visibility = "hidden"
            }, phoneNum.onblur = function () {
                var e = handlePhone(phoneNum.value);
                "0" != e[0] && (phoneNumPrompt.innerHTML = e[1], phoneNumPrompt.style.visibility = "visible")
            }, phoneNum.onfocus = function () {
                phoneNumPrompt.style.visibility = "hidden"
            }, expectP && (expectP.value = "", discountBlock.style.display = "none", expectPrompt.innerHTML = "", expectP.onfocus = function () {
                expectPrompt.style.visibility = "hidden", discountBlock.style.display = "none"
            }, expectP.onblur = function () {
                var e = "暂无报价";
                document.getElementById("jdPrice") && (e = $.trim(document.getElementById("jdPrice").value));
                var t = $.trim(expectP.value),
                    a = handlePrice(t, e);
                if ("0" == a[0]) {
                    t = (1 * t).toFixed(2);
                    var o = (t / e * 10).toFixed(1);
                    $(".discount-block").html(o + "折"), expectP.value = t, discountBlock.style.display = "block"
                } else expectPrompt.innerHTML = a[1], expectPrompt.style.visibility = "visible", discountBlock.style.display = "none"
            }), depreciateYesB.onclick = function () {
                var jdPrice = "暂无报价";
                document.getElementById("jdPrice") && (jdPrice = $.trim(document.getElementById("jdPrice").value));
                var price = $.trim(expectP.value),
                    phone = phoneNum.value,
                    priceData = handlePrice(price, jdPrice),
                    phoneData = handlePhone(phone);
                "0" == priceData[0] && "0" == phoneData[0] ? jQuery.ajax({
                    url: "/ware/priceSubscriber.json",
                    data: {wareId: $("#currentWareId").val(), sid: $("#sid").val(), hopePrice: price, phoneNo: phone},
                    dataType: "json",
                    success: function (d) {
                        try {
                            if (d && d.priceSubscriberResonse) {
                                var obj = eval("(" + d.priceSubscriberResonse + ")"),
                                    code = obj.resultCode;
                                "1" == code ? (oBody.removeChild(floor), oBox.style.display = "none", toastSuccess("订阅成功!")) : (oBody.removeChild(floor), oBox.style.display = "none", toastError(obj.msg))
                            } else oBody.removeChild(floor), oBox.style.display = "none", toastError("订阅失败")
                        } catch (e) {
                            oBody.removeChild(floor), oBox.style.display = "none", toastError("订阅失败")
                        }
                    },
                    error: function (e) {
                        window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + sid + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html"
                    }
                }) : (expectPrompt.innerHTML = "0" == priceData[0] ? "" : priceData[1], phoneNumPrompt.innerHTML = "0" == phoneData[0] ? "" : phoneData[1], expectPrompt.style.visibility = "visible", phoneNumPrompt.style.visibility = "visible")
            }
        }

        var oBtn = document.getElementById(btnID),
            oBox = document.getElementById(boxId),
            depreciateYesB = document.getElementById("depreciateYesB"),
            floor, oBody = document.getElementsByTagName("body")[0],
            cancelButt = oBox.querySelector(".cancel-but"),
            expectPrompt = oBox.querySelector(".input-prompt"),
            discountBlock = oBox.querySelector(".discount-block"),
            expectP = oBox.querySelector(".input-box[type=number]"),
            phoneNum = oBox.querySelector(".input-box[type=tel]"),
            phoneNumPrompt = oBox.querySelector(".phone-num-prompt"),
            sid = $("#sid").val();
        oBtn && (oBtn.onclick = function () {
            var e = $("#pin").val();
            if ("" == e || void 0 === e) return void(window.location.href = "https://passport.m.jd.com/user/login.action?sid=" + sid + "&returnurl=https://item.m.jd.com/product/" + $("#currentWareId").val() + ".html");
            appearFrame(oBox)
        })
    }

    window.depreciatePop = depreciatePop
}(), "false" != $("#depreciateInformIsShow").val() && depreciatePop("depreciateInformPr", "depreciateInformBlock"), $(".arrivalInform").length > 0 && $(".arrivalInform").each(function () {
    depreciatePop($(this).attr("id"), "arrvalInformBlock")
});
var itemInfoFlag = !1,
    itemScaleFlag = !0,
    pingClick = function (e, t, a, o) {
        try {
            var i = new MPing.inputs.Click(e);
            i.event_param = t, i.page_param = o;
            (new MPing).send(i)
        } catch (e) {
        }
    },
    pingClickWithLevel = function (e, t, a, o, i) {
        try {
            var r = new MPing.inputs.Click(e);
            r.event_param = t, r.page_param = o, r.event_level = i;
            (new MPing).send(r)
        } catch (e) {
        }
    };
$(function () {
    var e = 0,
        t = $("#type").val();
    if (t) "4" == t ? e = 4 : "0" == t && (e = 0);
    else {
        var a = window.sessionStorage;
        if (a) try {
            e = parseInt(a.getItem("tabIndex")), e || (e = 0)
        } catch (t) {
            e = 0
        }
    }
});